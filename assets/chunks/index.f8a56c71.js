import{_ as U,a as j,b as F,u as p,c as N,V as Xr,d as b,S as $r,e as qr,E as zt,f as un,U as Ri,W as Wt,g as W,h as G,i as Gt,j as Oi,X as ie,k as Ye,B as Xe,t as Zr,l as Jr,m as Pe,n as T,M as Si,o as Qr,C as Ke,p as Ai,q as es,F as We,r as ts,s as is,v as sr,R as ar,w as Kt,L as $e,P as Ce,x as ns,y as Li,A as ht,z as or,D as Re,G as Oe,H as ur,I as se,J as ln,K as Fi,N as lr,O as rs,Q as xi,T as Ni,Y as cr,Z as Fe,$ as ss,a0 as Le,a1 as as,a2 as cn,a3 as hn,a4 as fn,a5 as dn,a6 as gn,a7 as Di,a8 as Ii,a9 as vt,aa as mt,ab as _e,ac as os,ad as yt,ae as us,af as hr,ag as Yt,ah as fr,ai as ls,aj as cs,ak as hs,al as fs,am as ds,an as pn,ao as Vt,ap as gs,aq as ps,ar as vs,as as vn,at as ms,au as ys}from"./basePlugin.abae66f6.js";var mn={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},Es=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],X={get device(){var l=X.os;return l.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var l=navigator.userAgent.toLowerCase(),u={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(u).filter(function(s){return u[s].test(l)}))[0]},get os(){if(typeof navigator>"u")return{};var l=navigator.userAgent,u=/(?:Windows Phone)/.test(l),s=/(?:SymbianOS)/.test(l)||u,i=/(?:Tizen)/ig.test(l),e=/(?:Web0S)/ig.test(l),t=/(?:Android)/.test(l),n=/(?:Firefox)/.test(l),r=/(?:iPad|PlayBook)/.test(l)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,a=r||t&&!/(?:Mobile)/.test(l)||n&&/(?:Tablet)/.test(l),o=/(?:iPhone)/.test(l)&&!a,c=!o&&!t&&!s&&!a;return{isTablet:a,isPhone:o,isIpad:r,isIos:o||r,isAndroid:t,isPc:c,isSymbian:s,isWindowsPhone:u,isFireFox:n,isTizen:i,isWebOS:e}},get osVersion(){if(typeof navigator>"u")return 0;var l=navigator.userAgent,u="";/(?:iPhone)|(?:iPad|PlayBook)/.test(l)?u=mn.ios:u=mn.android;var s=u?u.exec(l):[];if(s&&s.length>=3){var i=s[2].split(".");return i.length>0?parseInt(i[0]):0}return 0},get isWeixin(){if(typeof navigator>"u")return!1;var l=/(micromessenger)\/([\d.]+)/,u=l.exec(navigator.userAgent.toLocaleLowerCase());return!!u},isSupportMP4:function(){var u={isSupport:!1,mime:""};if(typeof document>"u")return u;if(this.supportResult)return this.supportResult;var s=document.createElement("video");return typeof s.canPlayType=="function"&&Es.map(function(i){s.canPlayType('video/mp4; codecs="'.concat(i,'"'))==="probably"&&(u.isSupport=!0,u.mime+="||".concat(i))}),this.supportResult=u,s=null,u},isMSESupport:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(u)}catch(s){return this._logger.error(u,s),!1}},isHevcSupported:function(){return typeof MediaSource>"u"||!MediaSource.isTypeSupported?!1:MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"')},probeConfigSupported:function(u){var s={supported:!1,smooth:!1,powerEfficient:!1};if(!u||typeof navigator>"u")return Promise.resolve(s);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(u);var i=u.video||{},e=u.audio||{};try{var t=MediaSource.isTypeSupported(i.contentType),n=MediaSource.isTypeSupported(e.contentType);return Promise.resolve({supported:t&&n,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(s)}}};function ci(l,u){!this||!this.emit||(l==="error"?this.errorHandler(l,u.error):this.emit(l,u))}function _s(l,u){return function(s,i){var e={player:u,eventName:l,originalEvent:s,detail:s.detail||{},timeStamp:s.timeStamp,currentTime:u.currentTime,duration:u.duration,paused:u.paused,ended:u.ended,isInternalOp:!!u._internalOp[s.type],muted:u.muted,volume:u.volume,host:p.getHostFromUrl(u.currentSrc),vtype:u.vtype};if(u.removeInnerOP(s.type),l==="timeupdate"&&(u._currentTime=u.media&&u.media.currentTime),l==="ratechange"){var t=u.media?u.media.playbackRate:0;if(t&&u._rate===t)return;u._rate=u.media&&u.media.playbackRate}if(l==="durationchange"&&(u._duration=u.media.duration),l==="volumechange"&&(e.isMutedChange=u._lastMuted!==u.muted,u._lastMuted=u.muted),l==="error"&&(e.error=i||u.video.error),u.mediaEventMiddleware[l]){var n=ci.bind(u,l,e);try{u.mediaEventMiddleware[l].call(u,e,n)}catch(r){throw ci.call(u,l,e),r}}else ci.call(u,l,e)}}var Cs=function(l){U(s,l);var u=j(s);function s(i){var e;F(this,s),e=u.call(this,i),e._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype="MP4",e._rate=-1,e.mediaConfig=Object.assign({},{controls:!1,autoplay:i.autoplay,playsinline:i.playsinline,"x5-playsinline":i.playsinline,"webkit-playsinline":i.playsinline,"x5-video-player-fullscreen":i["x5-video-player-fullscreen"]||i.x5VideoPlayerFullscreen,"x5-video-orientation":i["x5-video-orientation"]||i.x5VideoOrientation,airplay:i.airplay,"webkit-airplay":i.airplay,tabindex:i.tabindex|0,mediaType:i.mediaType||"video","data-index":-1},i.videoConfig,i.videoAttributes);var t=i["x5-video-player-type"]||i.x5VideoPlayerType;return X.isWeixin&&X.os.isAndroid&&t&&(e.mediaConfig["x5-video-player-type"]=t,delete e.mediaConfig.playsinline,delete e.mediaConfig["webkit-playsinline"],delete e.mediaConfig["x5-playsinline"]),i.loop&&(e.mediaConfig.loop="loop"),i.autoplayMuted&&!Object.prototype.hasOwnProperty.call(e.mediaConfig,"muted")&&(e.mediaConfig.muted=!0),e.media=i.mediaEl instanceof HTMLMediaElement?i.mediaEl:typeof i.mediaEl=="function"?i.mediaEl(e.mediaConfig):p.createDom(e.mediaConfig.mediaType,"",e.mediaConfig,""),i.defaultPlaybackRate&&(e.media.defaultPlaybackRate=e.media.playbackRate=i.defaultPlaybackRate),p.typeOf(i.volume)==="Number"&&(e.volume=i.volume),i.autoplayMuted&&(e.media.muted=!0,e._lastMuted=!0),i.autoplay&&(e.media.autoplay=!0),i.playsinline&&(e.media.playsinline=!0),e._interval={},e.mediaEventMiddleware={},e.attachVideoEvents(),e}return N(s,[{key:"setEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(n){t.mediaEventMiddleware[n]=e[n]})}},{key:"removeEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(n){delete t.mediaEventMiddleware[n]})}},{key:"attachVideoEvents",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=Xr.map(function(n){var r="on".concat(n.charAt(0).toUpperCase()).concat(n.slice(1));return typeof e[r]=="function"&&e.on(n,e[r]),b({},n,_s(n,e))})),this._evHandlers.forEach(function(n){var r=Object.keys(n)[0];t.addEventListener(r,n[r],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(n){var r=Object.keys(n)[0];t.removeEventListener(r,n[r],!1)}),this._evHandlers.forEach(function(n){var r=Object.keys(n)[0],a="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));typeof e[a]=="function"&&e.off(r,e[a])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,t){var n=this;e.removeAttribute("src"),e.load(),t.forEach(function(h,g){n.media.appendChild(p.createDom("source","",{src:"".concat(h.src),type:"".concat(h.type||""),"data-index":g+1}))});var r=e.children;if(r){this._videoSourceCount=r.length,this._videoSourceIndex=r.length,this._vLoadeddata=function(h){n.emit($r,{src:h.target.currentSrc,host:p.getHostFromUrl(h.target.currentSrc)})};for(var a=null,o=0;o<this._evHandlers.length;o++)if(Object.keys(this._evHandlers[o])[0]==="error"){a=this._evHandlers[o];break}!this._sourceError&&(this._sourceError=function(h){var g=parseInt(h.target.getAttribute("data-index"),10);if(n._videoSourceIndex--,n._videoSourceIndex===0||g>=n._videoSourceCount){var y={code:4,message:"sources_load_error"};a?a.error(h,y):n.errorHandler("error",y)}var m=un[4];n.emit(qr,new zt(n,{errorType:m,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:h.target.src}))});for(var c=0;c<r.length;c++)r[c].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var t=e.children;if(!(!t||t.length===0||!this._sourceError)){for(var n=0;n<t.length;n++)t[n].removeEventListener("error",this._sourceError);for(;t.length>0;)e.removeChild(t[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||t)){var n=this.media.error||t,r=n.code?un[n.code]:"other",a=n.message;this.media.currentSrc||this.media.srcObject||(a="empty_src",n={code:6,message:a}),this.emit(e,new zt(this,{errorType:r,errorCode:n.code,errorMessage:n.message||"",mediaError:n}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var e in this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){var e=this.media?this.media.play():null;return e}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return this.media?this.media.canPlayType(e):!1}},{key:"getBufferedRange",value:function(e){var t=[0,0];if(!this.media)return t;e||(e=this.media.buffered);var n=this.media.currentTime;if(e)for(var r=0,a=e.length;r<a&&(t[0]=e.start(r),t[1]=e.end(r),!(t[0]<=n&&n<=t[1]));r++);return t[0]-n<=0&&n-t[1]<=0?t:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?p.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var t=this.media.buffered;if(!t||t.length===0)return e;for(var n=0;n<t.length;n++)if((t.start(n)<=this.currentTime||t.start(n)<.1)&&t.end(n)>=this.currentTime)return{start:t.start(n),end:t.end(n)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var e=this.media.error;if(!e)return"";var t=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return t[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(e){!this.media||this.media.muted===e||(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){!this.media||e===1/0||(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){if(this.media){if(this.emit(Ri,e),this.emit(Wt),this._currentTime=0,this._duration=0,p.isMSE(this.media)){this.onWaiting();return}this._detachSourceEvents(this.media),p.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e===1/0||!this.media||(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=W(G(s.prototype),"emit",this)).call.apply(n,[this,e,t].concat(a))}},{key:"on",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=W(G(s.prototype),"on",this)).call.apply(n,[this,e,t].concat(a))}},{key:"once",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=W(G(s.prototype),"once",this)).call.apply(n,[this,e,t].concat(a))}},{key:"off",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=W(G(s.prototype),"off",this)).call.apply(n,[this,e,t].concat(a))}},{key:"offAll",value:function(){W(G(s.prototype),"removeAllListeners",this).call(this)}}]),s}(Gt),Ts=function(){function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};F(this,l),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=u}return N(l,[{key:"openDB",value:function(s){var i=this,e=this,t=this.myDB.version||1,n=e.indexedDB.open(e.myDB.name,t);n.onerror=function(r){},n.onsuccess=function(r){i.myDB.db=r.target.result,s.call(e)},n.onupgradeneeded=function(r){var a=r.target.result;r.target.transaction,a.objectStoreNames.contains(e.myDB.ojstore.name)||a.createObjectStore(e.myDB.ojstore.name,{keyPath:e.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var s=this;s.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(s,i){for(var e=this.myDB.db.transaction(s,"readwrite").objectStore(s),t,n=0;n<i.length;n++)t=e.add(i[n]),t.onerror=function(){},t.onsuccess=function(){}}},{key:"putData",value:function(s,i){for(var e=this.myDB.db.transaction(s,"readwrite").objectStore(s),t,n=0;n<i.length;n++)t=e.put(i[n]),t.onerror=function(){},t.onsuccess=function(){}}},{key:"getDataByKey",value:function(s,i,e){var t=this,n=this.myDB.db.transaction(s,"readwrite").objectStore(s),r=n.get(i);r.onerror=function(){e.call(t,null)},r.onsuccess=function(a){var o=a.target.result;e.call(t,o)}}},{key:"deleteData",value:function(s,i){var e=this.myDB.db.transaction(s,"readwrite").objectStore(s);e.delete(i)}},{key:"clearData",value:function(s){var i=this.myDB.db.transaction(s,"readwrite").objectStore(s);i.clear()}}]),l}(),yn=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],En=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],_n=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],Ve="data-xgplayerid",ks=9;if(typeof Element<"u"&&!Element.prototype.matches){var nt=Element.prototype;nt.matches=nt.matchesSelector||nt.mozMatchesSelector||nt.msMatchesSelector||nt.oMatchesSelector||nt.webkitMatchesSelector}function bs(l,u){for(;l&&l.nodeType!==ks;){if(typeof l.matches=="function"&&l.matches(u))return l;l=l.parentNode}}var Ss=bs,As=Ss;function hi(l,u,s,i,e){var t=Ds.apply(this,arguments);return l.addEventListener(s,t,e),{destroy:function(){l.removeEventListener(s,t,e)}}}function xs(l,u,s,i,e){return typeof l.addEventListener=="function"?hi.apply(null,arguments):typeof s=="function"?hi.bind(null,document).apply(null,arguments):(typeof l=="string"&&(l=document.querySelectorAll(l)),Array.prototype.map.call(l,function(t){return hi(t,u,s,i,e)}))}function Ds(l,u,s,i){return function(e){e.delegateTarget=As(e.target,u),e.delegateTarget&&i.call(l,e)}}var Is=xs;const Cn=Oi(Is);var Ps={CONTROLS:"controls",ROOT:"root"},te={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},Tn={ICON_DISABLE:"xg-icon-disable",ICON_HIDE:"xg-icon-hide"};function fi(l){return l?l.indexOf&&/^(?:http|data:|\/)/.test(l):!1}function ws(l,u){return Ye(l)==="object"&&l.class&&typeof l.class=="string"?"".concat(u," ").concat(l.class):u}function Rs(l,u){return Ye(l)==="object"&&l.attr&&Ye(l.attr)==="object"&&Object.keys(l.attr).map(function(s){u[s]=l.attr[s]}),u}function kn(l,u){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",t=null;if(l instanceof window.Element)return p.addClass(l,s),Object.keys(i).map(function(n){l.setAttribute(n,i[n])}),l;if(fi(l)||fi(l.url))return i.src=fi(l)?l:l.url||"",t=p.createDom(l.tag||"img","",i,"xg-img ".concat(s)),t;if(typeof l=="function")try{return t=l(),t instanceof window.Element?(p.addClass(t,s),Object.keys(i).map(function(n){t.setAttribute(n,i[n])}),t):(ie.logWarn("warn>>icons.".concat(u," in config of plugin named [").concat(e,"] is a function mast return an Element Object")),null)}catch(n){return ie.logError("Plugin named [".concat(e,"]:createIcon"),n),null}return typeof l=="string"?p.createDomFromHtml(l,i,s):(ie.logWarn("warn>>icons.".concat(u," in config of plugin named [").concat(e,"] is invalid")),null)}function Os(l,u){var s=u.config.icons||u.playerConfig.icons;Object.keys(l).map(function(i){var e=l[i],t=e&&e.class?e.class:"",n=e&&e.attr?e.attr:{},r=null;s&&s[i]&&(t=ws(s[i],t),n=Rs(s[i],n),r=kn(s[i],i,t,n,u.pluginName)),!r&&e&&(r=kn(e.icon?e.icon:e,n,t,{},u.pluginName)),u.icons[i]=r})}function Ls(l,u){Object.keys(l).map(function(s){Object.defineProperty(u.langText,s,{get:function(){var e=u.lang,t=u.i18n;return t[s]?t[s]:l[s]&&l[s][e]||""}})})}var q=function(l){U(s,l);var u=j(s);function s(){var i,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return F(this,s),i=u.call(this,e),i.__delegates=[],i}return N(s,[{key:"__init",value:function(e){if(W(G(s.prototype),"__init",this).call(this,e),!!e.root){var t=e.root,n=null;this.icons={},this.root=null,this.parent=null,this.extraEls=[];var r=this.registerIcons()||{};Os(r,this),this.langText={};var a=this.registerLanguageTexts()||{};Ls(a,this);var o="";try{o=this.render()}catch(g){throw ie.logError("Plugin:".concat(this.pluginName,":render"),g),new Error("Plugin:".concat(this.pluginName,":render:").concat(g.message))}if(o)n=s.insert(o,t,e.index),n.setAttribute("data-index",e.index);else if(e.tag)n=p.createDom(e.tag,"",e.attr,e.name),n.setAttribute("data-index",e.index),t.appendChild(n);else return;this.root=n,this.parent=t;var c=this.config.attr||{},h=this.config.style||{};this.setAttr(c),this.setStyle(h),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var t=this.children();t&&Ye(t)==="object"&&Object.keys(t).length>0&&Object.keys(t).map(function(n){var r=n,a=t[r],o={root:e.root},c,h;typeof a=="function"?(c=e.config[r]||{},h=a):Ye(a)==="object"&&typeof a.plugin=="function"&&(c=a.options?p.deepCopy(e.config[r]||{},a.options):e.config[r]||{},h=a.plugin),o.config=c,c.index!==void 0&&(o.index=c.index),c.root&&(o.root=c.root),e.registerPlugin(h,o,r)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);function t(o,c){for(var h=0;h<o.children.length;h++)o.children[h].children.length>0?t(o.children[h],c):c(o.children[h])}var n=this.root,r=this.i18n,a=this.langText;n&&t(n,function(o){var c=o.getAttribute&&o.getAttribute("lang-key");if(c){var h=r[c.toUpperCase()]||a[c];h&&(o.innerHTML=typeof h=="function"?h(e):h)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=this.i18n||{},r=this.langText;e.setAttribute&&e.setAttribute("lang-key",t);var a=n[t]||r[t]||"";a&&(e.innerHTML=a)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,p.addClass(this.find(".xgplayer-icon"),Tn.ICON_DISABLE)}},{key:"enable",value:function(){this.config.disable=!1,p.removeClass(this.find(".xgplayer-icon"),Tn.ICON_DISABLE)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";t.root=t.root||this.root;var r=W(G(s.prototype),"registerPlugin",this).call(this,e,t,n);return this._children.push(r),r}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,t,n){var r=this;if(arguments.length<3&&typeof t=="function")Array.isArray(e)?e.forEach(function(o){r.bindEL(o,t)}):this.bindEL(e,t);else{var a=s.delegate.call(this,this.root,e,t,n);this.__delegates=this.__delegates.concat(a)}}},{key:"unbind",value:function(e,t){var n=this;if(arguments.length<3&&typeof t=="function")Array.isArray(e)?e.forEach(function(o){n.unbindEL(o,t)}):this.unbindEL(e,t);else for(var r="".concat(e,"_").concat(t),a=0;a<this.__delegates.length;a++)if(this.__delegates[a].key===r){this.__delegates[a].destroy(),this.__delegates.splice(a,1);break}}},{key:"setStyle",value:function(e,t){var n=this;if(this.root){if(p.typeOf(e)==="String")return this.root.style[e]=t;p.typeOf(e)==="Object"&&Object.keys(e).map(function(r){n.root.style[r]=e[r]})}}},{key:"setAttr",value:function(e,t){var n=this;if(this.root){if(p.typeOf(e)==="String")return this.root.setAttribute(e,t);p.typeOf(e)==="Object"&&Object.keys(e).map(function(r){n.root.setAttribute(r,e[r])})}}},{key:"setHtml",value:function(e,t){this.root&&(this.root.innerHTML=e,typeof t=="function"&&t())}},{key:"bindEL",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof t=="function"&&this.root.addEventListener(e,t,n)}},{key:"unbindEL",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof t=="function"&&this.root.removeEventListener(e,t,n)}},{key:"show",value:function(e){if(this.root){this.root.style.display=e!==void 0?e:"block";var t=window.getComputedStyle(this.root,null),n=t.getPropertyValue("display");if(n==="none")return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,t){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!t||!(t instanceof window.Element))return null;try{return typeof e=="string"?this.find(e).appendChild(t):e.appendChild(t)}catch(n){return ie.logError("Plugin:appendChild",n),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,t=this.player;this.__delegates.map(function(n){n.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(n){t.unRegisterPlugin(n.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),W(G(s.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(n){e[n]=null}),this.extraEls=[]}}],[{key:"insert",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=t.children.length,a=Number(n),o=e instanceof window.Node;if(r){for(var c=0,h=null,g="";c<r;c++){h=t.children[c];var y=Number(h.getAttribute("data-index"));if(y>=a){g="beforebegin";break}else y<a&&(g="afterend")}return o?g==="afterend"?t.appendChild(e):t.insertBefore(e,h):h.insertAdjacentHTML(g,e),g==="afterend"?t.children[t.children.length-1]:t.children[c]}else return o?t.appendChild(e):t.insertAdjacentHTML("beforeend",e),t.children[t.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,t,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,o=[];if(e instanceof window.Node&&typeof r=="function")if(Array.isArray(n))n.forEach(function(h){var g=Cn(e,t,h,r,a);g.key="".concat(t,"_").concat(h),o.push(g)});else{var c=Cn(e,t,n,r,a);c.key="".concat(t,"_").concat(n),o.push(c)}return o}},{key:"ROOT_TYPES",get:function(){return Ps}},{key:"POSITIONS",get:function(){return te}}]),s}(Xe),Fs=function(){function l(){var u=this;if(F(this,l),b(this,"__trigger",function(s){var i=new Date().getTime();u.timeStamp=i;for(var e=0;e<s.length;e++)u.__runHandler(s[e].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(Zr(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(s){console.error(s)}}return N(l,[{key:"addObserver",value:function(s,i){if(this.observer){this.observer.observe(s);for(var e=s.getAttribute(Ve),t=this.__handlers,n=-1,r=0;r<t.length;r++)t[r]&&s===t[r].target&&(n=r);n>-1?this.__handlers[n].handler=i:this.__handlers.push({target:s,handler:i,playerId:e})}}},{key:"unObserver",value:function(s){var i=-1;this.__handlers.map(function(t,n){s===t.target&&(i=n)});try{var e;(e=this.observer)===null||e===void 0||e.unobserve(s)}catch{}i>-1&&this.__handlers.splice(i,1)}},{key:"destroyObserver",value:function(){var s;(s=this.observer)===null||s===void 0||s.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(s){for(var i=this.__handlers,e=0;e<i.length;e++)if(i[e]&&s===i[e].target){try{i[e].handler(s)}catch(t){console.error(t)}return!0}return!1}}]),l}(),Tt=null;function Ns(l,u){return Tt||(Tt=new Fs),Tt.addObserver(l,u),Tt}function Bs(l,u){var s;(s=Tt)===null||s===void 0||s.unObserver(l,u)}var fe={pluginGroup:{},init:function(u){var s=u._pluginInfoId;s||(s=new Date().getTime(),u._pluginInfoId=s),!u.config.closeResizeObserver&&Ns(u.root,function(){u.resize()}),this.pluginGroup[s]={_originalOptions:u.config||{},_plugins:{}}},formatPluginInfo:function(u,s){var i=null,e=null;return u.plugin&&typeof u.plugin=="function"?(i=u.plugin,e=u.options):(i=u,e={}),s&&(e.config=s||{}),{PLUFGIN:i,options:e}},checkPluginIfExits:function(u,s){for(var i=0;i<s.length;i++)if(u.toLowerCase()===s[i].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(u,s){for(var i=Object.keys(s),e=null,t=0;t<i.length;t++)if(u.toLowerCase()===i[t].toLowerCase()){e=s[i[t]];break}return p.typeOf(e)==="Object"?{root:e.root,position:e.position}:{}},lazyRegister:function(u,s){var i=this,e=s.timeout||1500;return Promise.race([s.loader().then(function(t){var n;t&&t.__esModule?n=t.default:n=t,i.register(u,n,t.options)}),new Promise(function(t,n){setTimeout(function(){n(new Error("timeout"))},e)})])},register:function(u,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!u||!s||typeof s!="function"||s.prototype===void 0)){var e=u._pluginInfoId;if(!(!e||!this.pluginGroup[e])){this.pluginGroup[e]._plugins||(this.pluginGroup[e]._plugins={});var t=this.pluginGroup[e]._plugins,n=this.pluginGroup[e]._originalOptions;i.player=u;var r=i.pluginName||s.pluginName;if(!r)throw new Error("The property pluginName is necessary");if(s.isSupported&&!s.isSupported(u.config.mediaType,u.config.codecType)){console.warn("not supported plugin [".concat(r,"]"));return}i.config||(i.config={});for(var a=Object.keys(n),o=0;o<a.length;o++)if(r.toLowerCase()===a[o].toLowerCase()){var c=n[a[o]];p.typeOf(c)==="Object"?i.config=Object.assign({},i.config,n[a[o]]):p.typeOf(c)==="Boolean"&&(i.config.disable=!c);break}s.defaultConfig&&Object.keys(s.defaultConfig).forEach(function(g){typeof i.config[g]>"u"&&(i.config[g]=s.defaultConfig[g])}),i.root?typeof i.root=="string"&&(i.root=u[i.root]):i.root=u.root,i.index=i.config.index||0;try{t[r.toLowerCase()]&&(this.unRegister(e,r.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(r,"] exist, destroy the old instance")));var h=new s(i);return t[r.toLowerCase()]=h,t[r.toLowerCase()].func=s,h&&typeof h.afterCreate=="function"&&h.afterCreate(),h}catch(g){throw console.error(g),g}}}},unRegister:function(u,s){u._pluginInfoId&&(u=u._pluginInfoId),s=s.toLowerCase();try{var i=this.pluginGroup[u]._plugins[s];i&&(i.pluginName&&i.__destroy(),delete this.pluginGroup[u]._plugins[s])}catch(e){console.error("[unRegister:".concat(s,"] cgid:[").concat(u,"] error"),e)}},deletePlugin:function(u,s){var i=u._pluginInfoId;i&&this.pluginGroup[i]&&this.pluginGroup[i]._plugins&&delete this.pluginGroup[i]._plugins[s]},getPlugins:function(u){var s=u._pluginInfoId;return s&&this.pluginGroup[s]?this.pluginGroup[s]._plugins:{}},findPlugin:function(u,s){var i=u._pluginInfoId;if(!i||!this.pluginGroup[i])return null;var e=s.toLowerCase();return this.pluginGroup[i]._plugins[e]},beforeInit:function(u){var s=this;function i(e){return!e||!e.then?new Promise(function(t){t()}):e}return new Promise(function(e){if(s.pluginGroup){var t;return u._loadingPlugins&&u._loadingPlugins.length?t=Promise.all(u._loadingPlugins):t=Promise.resolve(),t.then(function(){var n=u._pluginInfoId;if(!s.pluginGroup[n]){e();return}var r=s.pluginGroup[n]._plugins,a=[];Object.keys(r).forEach(function(o){if(r[o]&&r[o].beforePlayerInit)try{var c=r[o].beforePlayerInit();a.push(i(c))}catch(h){throw a.push(i(null)),h}}),Promise.all([].concat(a)).then(function(){e()}).catch(function(o){console.error(o),e()})})}})},afterInit:function(u){var s=u._pluginInfoId;if(!(!s||!this.pluginGroup[s])){var i=this.pluginGroup[s]._plugins;Object.keys(i).forEach(function(e){i[e]&&i[e].afterPlayerInit&&i[e].afterPlayerInit()})}},setLang:function(u,s){var i=s._pluginInfoId;if(!(!i||!this.pluginGroup[i])){var e=this.pluginGroup[i]._plugins;Object.keys(e).forEach(function(t){if(e[t].updateLang)e[t].updateLang(u);else try{e[t].lang=u}catch{console.warn("".concat(t," setLang"))}})}},reRender:function(u){var s=this,i=u._pluginInfoId;if(!(!i||!this.pluginGroup[i])){var e=[],t=this.pluginGroup[i]._plugins;Object.keys(t).forEach(function(n){n!=="controls"&&t[n]&&(e.push({plugin:t[n].func,options:t[n].__args}),s.unRegister(i,n))}),e.forEach(function(n){s.register(u,n.plugin,n.options)})}},onPluginsReady:function(u){var s=u._pluginInfoId;if(!(!s||!this.pluginGroup[s])){var i=this.pluginGroup[s]._plugins||{};Object.keys(i).forEach(function(e){i[e].onPluginsReady&&typeof i[e].onPluginsReady=="function"&&i[e].onPluginsReady()})}},destroy:function(u){var s=u._pluginInfoId;if(this.pluginGroup[s]){Bs(u.root);for(var i=this.pluginGroup[s]._plugins,e=0,t=Object.keys(i);e<t.length;e++){var n=t[e];this.unRegister(s,n)}delete this.pluginGroup[s],delete u._pluginInfoId}}},w={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function bn(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:Jr(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var Ms=function(u,s){var i,e,t;s.preset&&s.options?t=new s.preset(s.options,u.config):t=new s({},u.config);var n=t,r=n.plugins,a=r===void 0?[]:r,o=n.ignores,c=o===void 0?[]:o,h=n.icons,g=h===void 0?{}:h,y=n.i18n,m=y===void 0?[]:y;u.config.plugins||(u.config.plugins=[]),u.config.ignores||(u.config.ignores=[]),(i=u.config.plugins).push.apply(i,Pe(a)),(e=u.config.ignores).push.apply(e,Pe(c)),Object.keys(g).map(function(C){u.config.icons[C]||(u.config.icons[C]=g[C])});var _=u.config.i18n||[];m.push.apply(m,Pe(_)),u.config.i18n=m},Hs=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onMouseEnter",function(r){var a=T(i),o=a.player,c=a.playerConfig;c.closeControlsBlur&&o.focus({autoHide:!1})}),b(T(i),"onMouseLeave",function(r){var a=T(i),o=a.player;o.focus()}),i}return N(s,[{key:"beforeCreate",value:function(e){!e.config.mode&&X.device==="mobile"&&(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,t=this.config,n=t.disable,r=t.height,a=t.mode;if(!n){a==="flex"&&this.player.addClass(w.FLEX_CONTROLS);var o={height:"".concat(r,"px")};Object.keys(o).map(function(h){e.root.style[h]=o[h]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(Si,function(h){h?p.addClass(e.root,"mini-controls"):p.removeClass(e.root,"mini-controls")});var c=this.playerConfig.isMobileSimulateMode;X.device!=="mobile"&&c!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&p.addClass(this.root,w.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){p.removeClass(this.root,w.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.root){var r=e.defaultConfig||{};if(!t.root){var a=t.position?t.position:t.config&&t.config.position?t.config.position:r.position;switch(a){case te.CONTROLS_LEFT:t.root=this.left;break;case te.CONTROLS_RIGHT:t.root=this.right;break;case te.CONTROLS_CENTER:t.root=this.center;break;case te.CONTROLS:t.root=this.root;break;default:t.root=this.left}return W(G(s.prototype),"registerPlugin",this).call(this,e,t,n)}}}},{key:"destroy",value:function(){X.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave)),this.left=null,this.center=null,this.right=null,this.innerRoot=null}},{key:"render",value:function(){var e=this.config,t=e.mode,n=e.autoHide,r=e.initShow,a=e.disable;if(!a){var o=p.classNames({"xgplayer-controls":!0},{"flex-controls":t==="flex"},{"bottom-controls":t==="bottom"},b({},w.CONTROLS_AUTOHIDE,n),{"xgplayer-controls-initshow":r||!n});return'<xg-controls class="'.concat(o,`" unselectable="on">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),s}(q),Us={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},Ee={lang:{},langKeys:[],textKeys:[]};function bt(l,u){return Object.keys(u).forEach(function(s){var i=p.typeOf(u[s]),e=p.typeOf(l[s]);if(i==="Array"){var t;e!=="Array"&&(l[s]=[]),(t=l[s]).push.apply(t,Pe(u[s]))}else i==="Object"?(e!=="Object"&&(l[s]={}),bt(l[s],u[s])):l[s]=u[s]}),l}function dr(){Object.keys(Ee.lang.en).map(function(l){Ee.textKeys[l]=l})}function js(l,u){var s=[];if(u||(u=Ee),!!u.lang){p.typeOf(l)!=="Array"?s=Object.keys(l).map(function(t){var n=t==="zh"?"zh-cn":t;return{LANG:n,TEXT:l[t]}}):s=l;var i=u,e=i.lang;s.map(function(t){t.LANG==="zh"&&(t.LANG="zh-cn"),e[t.LANG]?bt(e[t.LANG]||{},t.TEXT||{}):Bi(t,u)}),dr()}}function Bi(l,u){var s=l.LANG;if(u||(u=Ee),!!u.lang){var i=l.TEXT||{};s==="zh"&&(s="zh-cn"),u.lang[s]?bt(u.lang[s],i):(u.langKeys.push(s),u.lang[s]=i),dr()}}function Vs(l){var u,s={lang:{},langKeys:[],textKeys:{},pId:l};return bt(s.lang,Ee.lang),(u=s.langKeys).push.apply(u,Pe(Ee.langKeys)),bt(s.textKeys,Ee.textKeys),s}Bi(Us);var ct={get textKeys(){return Ee.textKeys},get langKeys(){return Ee.langKeys},get lang(){var l={};return Ee.langKeys.map(function(u){l[u]=Ee.lang[u]}),Ee.lang["zh-cn"]&&(l.zh=Ee.lang["zh-cn"]||{}),l},extend:js,use:Bi,init:Vs},Z={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},Sn=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],ve={},di=null,gr=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"add",value:function(e){e&&(ve[e.playerId]=e,Object.keys(ve).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete ve[e.playerId])}},{key:"_iterate",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(var n in ve)if(Object.prototype.hasOwnProperty.call(ve,n)){var r=ve[n];if(t){if(e(r))break}else e(r)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var t=null;return this._iterate(function(n){var r=e(n);return r&&(t=n),r},!0),t}},{key:"findAll",value:function(e){var t=[];return this._iterate(function(n){e(n)&&t.push(n)}),t}},{key:"setActive",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ve[e])return t?this.forEach(function(n){e===n.playerId?(n.isUserActive=!0,n.isInstNext=!1):n.isUserActive=!1}):ve[e].isUserActive=t,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(ve),t=0;t<e.length;t++){var n=ve[e[t]];if(n&&n.isUserActive)return e[t]}return null}},{key:"setNext",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ve[e])return t?this.forEach(function(n){e===n.playerId?(n.isUserActive=!1,n.isInstNext=!0):n.isInstNext=!1}):ve[e].isInstNext=t,e}}],[{key:"getInstance",value:function(){return di||(di=new s),di}}]),s}(Qr.EventEmitter);function zs(l){for(var u=Object.keys(ve),s=0;s<u.length;s++){var i=ve[u[s]];if(i.root===l)return i}return null}var Ws=["play","pause","replay","retry"],An=0,xn=0,He=null,Xt=function(l){U(s,l);var u=j(s);function s(i){var e;F(this,s);var t=p.deepMerge(bn(),i);e=u.call(this,t),b(T(e),"canPlayFunc",function(){if(e.config){var m=e.config,_=m.autoplay,C=m.defaultPlaybackRate;ie.logInfo("player","canPlayFunc, startTime",e.__startTime),e._seekToStartTime(),e.playbackRate=C,(_||e._useAutoplay)&&e.mediaPlay(),e.off(Ke,e.canPlayFunc),e.removeClass(w.ENTER)}}),b(T(e),"onFullscreenChange",function(m,_){var C=function(){p.setTimeout(T(e),function(){e.resize()},100)},D=p.getFullScreenEl();e._fullActionFrom?e._fullActionFrom="":e.emit(Ai,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var A=es(D,e.playerId,Ve);if(_||D&&(D===e._fullscreenEl||A))C(),!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,D,w.FULLSCREEN),e.emit(We,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){C();var O=T(e),H=O._fullScreenOffset,K=O.config;if(K.needFullscreenScroll?(window.scrollTo(H.left,H.top),p.setTimeout(T(e),function(){e.fullscreen=!1,e._fullScreenOffset=null},100)):(!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen)e.removeClass(w.FULLSCREEN);else{var Y=e._fullscreenEl;!Y&&(e.root.contains(m.target)||m.target===e.root)&&(Y=m.target),e.recoverFullStyle(e.root,Y,w.FULLSCREEN)}e._fullscreenEl=null,e.emit(We,!1)}}),b(T(e),"_onWebkitbeginfullscreen",function(m){e._fullscreenEl=e.media,e.onFullscreenChange(m,!0)}),b(T(e),"_onWebkitendfullscreen",function(m){e.onFullscreenChange(m,!1)}),ts(T(e),Ws),e.config=t,e._pluginInfoId=p.generateSessionId(),is(T(e));var n=e.constructor.defaultPreset;if(e.config.presets.length){var r=e.config.presets.indexOf("default");r>=0&&n&&(e.config.presets[r]=n)}else n&&e.config.presets.push(n);e.userTimer=null,e.waitTimer=null,e.handleSource=!0,e._state=Z.INITIAL,e.isAd=!1,e.isError=!1,e._hasStart=!1,e.isSeeking=!1,e.isCanplay=!1,e._useAutoplay=!1,e.__startTime=-1,e.rotateDeg=0,e.isActive=!1,e.fullscreen=!1,e.cssfullscreen=!1,e.isRotateFullscreen=!1,e._fullscreenEl=null,e.timeSegments=[],e._cssfullscreenEl=null,e.curDefinition=null,e._orgCss="",e._fullScreenOffset=null,e._videoHeight=0,e._videoWidth=0,e.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},e.sizeInfo={width:0,height:0,left:0,top:0},e._accPlayed={t:0,acc:0,loopAcc:0},e._offsetInfo={currentTime:-1,duration:0},e.innerContainer=null,e.controls=null,e.topBar=null,e.root=null,e.__i18n=ct.init(e._pluginInfoId),X.os.isAndroid&&X.osVersion>0&&X.osVersion<6&&(e.config.autoplay=!1),e.database=new Ts,e.isUserActive=!1,e._onceSeekCanplay=null,e._isPauseBeforeSeek=0,e.innerStates={isActiveLocked:!1},e.instManager=He;var a=e._initDOM();if(!a)return console.error(new Error("can't find the dom which id is ".concat(e.config.id," or this.config.el does not exist"))),sr(e);var o=e.config,c=o.definition,h=c===void 0?{}:c,g=o.url;if(!g&&h.list&&h.list.length>0){var y=h.list.find(function(m){return m.definition&&m.definition===h.defaultDefinition});y||(h.defaultDefinition=h.list[0].definition,y=h.list[0]),e.config.url=y.url,e.curDefinition=y}return e._bindEvents(),e._registerPresets(),e._registerPlugins(),fe.onPluginsReady(T(e)),e.getInitDefinition(),e.setState(Z.READY),p.setTimeout(T(e),function(){e.emit(ar)},0),e.onReady&&e.onReady(),(e.config.videoInit||e.config.autoplay)&&(!e.hasStart||e.state<Z.ATTACHED)&&e.start(),e}return N(s,[{key:"_initDOM",value:function(){var e,t=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var n=this.config.el;if(n&&n.nodeType===1)this.root=n;else return this.emit(Kt,new zt("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var r=zs(this.root);if(r&&(ie.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),r.destroy()),this.root.setAttribute(Ve,this.playerId),this.media.setAttribute(Ve,this.playerId),(e=He)===null||e===void 0||e.add(this),fe.init(this),this._initBaseDoms(),this.config.controls){var a=this.config.controls.root||null,o=fe.register(this,Hs,{root:a});this.controls=o}var c=this.config.isMobileSimulateMode==="mobile"?"mobile":X.device;if(this.addClass("".concat(w.DEFAULT," ").concat(w.INACTIVE," xgplayer-").concat(c," ").concat(this.config.controls?"":w.NO_CONTROLS)),this.config.autoplay?this.addClass(w.ENTER):this.addClass(w.NO_START),this.config.fluid){var h=this.config,g=h.width,y=h.height;(typeof g!="number"||typeof y!="number")&&(g=600,y=337.5);var m={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(y*100/g,"%")};Object.keys(m).forEach(function(H){t.root.style[H]=m[H]})}else["width","height"].forEach(function(H){t.config[H]&&(typeof t.config[H]!="number"?t.root.style[H]=t.config[H]:t.root.style[H]="".concat(t.config[H],"px"))});var _=this.root.getBoundingClientRect(),C=_.width,D=_.height,A=_.left,O=_.top;return this.sizeInfo.width=C,this.sizeInfo.height=D,this.sizeInfo.left=A,this.sizeInfo.top=O,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=p.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(t){e.on(t,e["on"+t.charAt(0).toUpperCase()+t.slice(1)])}),yn.forEach(function(t){document&&document.addEventListener(t,e.onFullscreenChange)}),X.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once($e,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(Ce,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),yn.forEach(function(t){document.removeEventListener(t,e.onFullscreenChange)}),this.playFunc&&this.off(Ce,this.playFunc),this.off(Ke,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(p.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.media&&!((!e||e===""||p.typeOf(e)==="Array"&&e.length===0)&&(e="",this.emit(ns),ie.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){p.isNotNull(n.playSessionId)&&(this._playSessionId=n.playSessionId),this.handleSource&&(this._detachSourceEvents(this.media),p.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):!this.media.src||this.media.src!==e?this.media.src=e:e||this.media.removeAttribute("src")),p.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var r=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!r.contains(this.media)&&r.insertBefore(this.media,r.firstChild);var a=this.media.readyState;ie.logInfo("_startInit readyState",a),this.config.autoplay&&(!p.isMSE(this.media)&&this.load(),(X.os.isIpad||X.os.isPhone)&&this.mediaPlay());var o=this.config.startTime;this.__startTime=o>0?o:-1,this.config.startTime=0,a>=2&&this.duration>0?this.canPlayFunc():this.on(Ke,this.canPlayFunc),(!this.hasStart||this.state<Z.ATTACHED)&&fe.afterInit(this),this.hasStart=!0,this.setState(Z.ATTACHED),p.setTimeout(this,function(){t.emit(Li)},0)}}},{key:"_registerPlugins",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var n=this.config.ignores||[],r=this.config.plugins||[],a=this.config.i18n||[];t&&ct.extend(a,this.__i18n);var o=n.join("||").toLowerCase().split("||"),c=this.plugins;r.forEach(function(h){try{var g=h.plugin?h.plugin.pluginName:h.pluginName;if(g&&o.indexOf(g.toLowerCase())>-1)return null;if(!t&&c[g.toLowerCase()])return;if(h.lazy&&h.loader){var y=fe.lazyRegister(e,h);h.forceBeforeInit&&(y.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(y),1)}).catch(function(m){ie.logError("_registerPlugins:loadingPlugin",m),e._loadingPlugins.splice(e._loadingPlugins.indexOf(y),1)}),e._loadingPlugins.push(y));return}return e.registerPlugin(h)}catch(m){ie.logError("_registerPlugins:",m)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(t){Ms(e,t)})}},{key:"_getRootByPosition",value:function(e){var t=null;switch(e){case te.ROOT_RIGHT:this.rightBar||(this.rightBar=p.createPositionBar("xg-right-bar",this.root)),t=this.rightBar;break;case te.ROOT_LEFT:this.leftBar||(this.leftBar=p.createPositionBar("xg-left-bar",this.root)),t=this.leftBar;break;case te.ROOT_TOP:this.topBar||(this.topBar=p.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&p.addClass(this.topBar,w.TOP_BAR_AUTOHIDE)),t=this.topBar;break;default:t=this.innerContainer||this.root;break}return t}},{key:"registerPlugin",value:function(e,t){var n=fe.formatPluginInfo(e,t),r=n.PLUFGIN,a=n.options,o=this.config.plugins,c=fe.checkPluginIfExits(r.pluginName,o);!c&&o.push(r);var h=fe.getRootByConfig(r.pluginName,this.config);h.root&&(a.root=h.root),h.position&&(a.position=h.position);var g=a.position?a.position:a.config&&a.config.position||r.defaultConfig&&r.defaultConfig.position;if(!a.root&&typeof g=="string"&&g.indexOf("controls")>-1){var y;return(y=this.controls)===null||y===void 0?void 0:y.registerPlugin(r,a,r.pluginName)}return a.root||(a.root=this._getRootByPosition(g)),fe.register(this,r,a)}},{key:"deregister",value:function(e){typeof e=="string"?fe.unRegister(this,e):e instanceof Xe&&fe.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(e),t&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var t;if(typeof e=="string"?t=e:e instanceof Xe&&(t=e.pluginName),!!t)for(var n=this.config.plugins.length-1;n>-1;n--){var r=this.config.plugins[n];if(r.pluginName.toLowerCase()===t.toLowerCase()){this.config.plugins.splice(n,1);break}}}},{key:"plugins",get:function(){return fe.getPlugins(this)}},{key:"getPlugin",value:function(e){var t=fe.findPlugin(this,e);return t&&t.pluginName?t:null}},{key:"addClass",value:function(e){this.root&&(p.hasClass(this.root,e)||p.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&p.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return p.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,t){this.root&&this.root.setAttribute(e,t)}},{key:"removeAttribute",value:function(e,t){this.root&&this.root.removeAttribute(e,t)}},{key:"start",value:function(e){var t=this;if(!(this.state>Z.ATTACHING)){var n=this._playSessionId;return p.isNotNull(n)&&(this._playSessionId=void 0),!e&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(Z.ATTACHING),this._registerPlugins(!1),fe.beforeInit(this).then(function(){if(t.config){e||(e=t.url||t.config.url);var r=t.preProcessUrl(e),a=t._startInit(r.url,{playSessionId:n});return a}}).catch(function(r){throw r.fileName="player",r.lineNumber="236",ie.logError("start:beforeInit:",r),r})}}},{key:"switchURL",value:function(e,t){var n=this,r=e;p.typeOf(e)==="Object"&&(r=e.url),r=this.preProcessUrl(r).url;var a=this.currentTime;this.__startTime=a;var o=this.paused&&!this.isError;return this.src=r,new Promise(function(c,h){var g=function(_){n.off("timeupdate",y),n.off("canplay",y),h(_)},y=function(){n._seekToStartTime(),o&&n.pause(),n.off("error",g),c(!0)};if(n.once("error",g),!r){n.errorHandler("error",{code:6,message:"empty_src"});return}X.os.isAndroid?n.once("timeupdate",y):n.once("canplay",y),n.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<Z.ATTACHED){this.removeClass(w.NO_START),this.addClass(w.ENTER),this.start(),this._useAutoplay=!0;return}this.state<Z.RUNNING&&(this.removeClass(w.NO_START),!this.isCanplay&&this.addClass(w.ENTER));var t=W(G(s.prototype),"play",this).call(this);return t!==void 0&&t&&t.then?t.then(function(){e.removeClass(w.NOT_ALLOW_AUTOPLAY),e.addClass(w.PLAYING),e.state<Z.RUNNING&&(ie.logInfo(">>>>playPromise.then"),e.setState(Z.RUNNING),e.emit(ht))}).catch(function(n){if(ie.logWarn(">>>>playPromise.catch",n.name),e.media&&e.media.error){e.onError(),e.removeClass(w.ENTER);return}n.name==="NotAllowedError"&&(e._errorTimer=p.setTimeout(e,function(){e._errorTimer=null,e.emit(or),e.addClass(w.NOT_ALLOW_AUTOPLAY),e.removeClass(w.ENTER),e.pause(),e.setState(Z.NOTALLOW)},0))}):(ie.logWarn("video.play not return promise"),this.state<Z.RUNNING&&(this.setState(Z.RUNNING),this.removeClass(w.NOT_ALLOW_AUTOPLAY),this.removeClass(w.NO_START),this.removeClass(w.ENTER),this.addClass(w.PLAYING),this.emit(ht))),t}},{key:"mediaPause",value:function(){W(G(s.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){W(G(s.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass(w.PAUSED),Re(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;Re(this,"pause",function(){W(G(s.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,t){var n=this;if(!(!this.media||Number.isNaN(Number(e))||!this.hasStart)){var r=this.config,a=r.isSeekedPlay,o=r.seekedStatus,c=t||(a?"play":o);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(Oe,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(n.removeClass(w.ENTER),n.isSeeking=!1,c){case"play":n.play();break;case"pause":n.pause();break;default:n._isPauseBeforeSeek>1||n.paused?n.pause():n.play()}n._isPauseBeforeSeek=0,n._onceSeekCanplay=null},this.once(Oe,this._onceSeekCanplay),this.state<Z.RUNNING?(this.removeClass(w.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,t=this.config,n=t.definition,r=t.url;!r&&n&&n.list&&n.list.length>0&&n.defaultDefinition&&n.list.map(function(a){a.definition===n.defaultDefinition&&(e.config.url=a.url,e.curDefinition=a)})}},{key:"changeDefinition",value:function(e,t){var n=this,r=this.config.definition;if(Array.isArray(r==null?void 0:r.list)&&r.list.forEach(function(o){(e==null?void 0:e.definition)===o.definition&&(n.curDefinition=o)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(ur,{from:t,to:e}),!this.hasStart){this.config.url=e.url;return}var a=this.switchURL(e.url,se({seamless:r.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},e));a&&a.then?a.then(function(){n.emit(ln,{from:t,to:e})}):this.emit(ln,{from:t,to:e})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once($e,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,t=w.NOT_ALLOW_AUTOPLAY,n=w.PLAYING,r=w.NO_START,a=w.PAUSED,o=w.REPLAY,c=w.ENTER,h=w.ENDED,g=w.ERROR,y=w.LOADING,m=[t,n,r,a,o,c,h,g,y];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,m.forEach(function(_){e.removeClass(_)}),this.addClass(w.NO_START),this.emit(Fi)}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;this.resetState();var r=this.plugins;if(r&&(t.map(function(o){e.deregister(o)}),n)){var a=bn();Object.keys(this.config).forEach(function(o){e.config[o]!=="undefined"&&(o==="plugins"||o==="presets"||o==="el"||o==="id")&&(e.config[o]=a[o])})}}},{key:"destroy",value:function(){var e,t=this,n=this.innerContainer,r=this.root,a=this.media;if(!(!r||!a)){if(this.hasStart=!1,this._useAutoplay=!1,r.removeAttribute(Ve),a.removeAttribute(Ve),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),p.clearAllTimers(this),this.emit(lr),(e=He)===null||e===void 0||e.remove(this),fe.destroy(this),rs(this),W(G(s.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),n)for(var o=n.children,c=0;c<o.length;c++)n.removeChild(o[c]);!n&&a instanceof window.Node&&r.contains(a)&&!this.config.remainMediaAfterDestroy&&r.removeChild(a),["topBar","leftBar","rightBar","innerContainer"].map(function(g){t[g]&&r.removeChild(t[g]),t[g]=null});var h=r.className.split(" ");h.length>0?r.className=h.filter(function(g){return g.indexOf("xgplayer")<0}).join(" "):r.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(g){t[g]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass(w.ENDED),this.currentTime=0,this.isSeeking=!1,Re(this,"replay",function(){e.once(Oe,function(){var t=e.mediaPlay();t&&t.catch&&t.catch(function(n){console.log(n)})}),e.emit(Di),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(w.ERROR),this.addClass(w.LOADING),Re(this,"retry",function(){var t=e.currentTime,n=e.config.url,r=p.isMSE(e.media)?{url:n}:e.preProcessUrl(n);e.src=r.url,!e.config.isLive&&(e.currentTime=t),e.once(Ke,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,t,n,r){e&&(r||(r=w.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=p.filterStyleFromText(e)),p.addClass(e,n),t&&t!==e&&!this._orgPCss&&(this._orgPCss=p.filterStyleFromText(t),p.addClass(t,r),t.setAttribute(Ve,this.playerId)))}},{key:"recoverFullStyle",value:function(e,t,n,r){r||(r=w.PARENT_FULLSCREEN),this._orgCss&&(p.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),p.removeClass(e,n),t&&t!==e&&this._orgPCss&&(p.setStyleFromCsstext(t,this._orgPCss),this._orgPCss="",p.removeClass(t,r),t.removeAttribute(Ve))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,t=this.root,n=this.media;(e==="video"||e==="media")&&(e=this[e]),e||(e=t),this._fullScreenOffset={top:p.scrollTop(),left:p.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var r=p.getFullScreenEl();if(r===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var a=0;a<En.length;a++){var o=En[a];if(e[o]){var c=o==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[o]();return c&&c.then?c:Promise.resolve()}}return n.fullscreenEnabled||n.webkitSupportsFullscreen?(n.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch{return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!p.getFullScreenEl())){this.root;var t=this.media;this._fullActionFrom="exit";try{for(var n=0;n<_n.length;n++){var r=_n[n];if(document[r]){var a=document[r]();return a&&a.then?a:Promise.resolve()}}return t&&t.webkitSupportsFullscreen?(t.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch{return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var t=e?"".concat(w.INNER_FULLSCREEN," ").concat(w.CSS_FULLSCREEN):w.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,t);var n=this.config.fullscreen,r=n===void 0?{}:n,a=r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen();a&&(this.fullscreen=!0,this.emit(We,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(xi,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(w.INNER_FULLSCREEN," ").concat(w.CSS_FULLSCREEN):w.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,e);else{var t=this.config.fullscreen,n=t===void 0?{}:t,r=n.useCssFullscreen===!0||typeof n.useCssFullscreen=="function"&&n.useCssFullscreen();r?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(We,!1)):this.removeClass(e)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(xi,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var t=e?"".concat(w.INNER_FULLSCREEN," ").concat(w.ROTATE_FULLSCREEN):w.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,t,w.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style");var n=Math.abs(window.orientation)===90||Math.abs(screen.orientation.angle)===90;this.root.style.width=n?"".concat(window.innerWidth,"px"):"".concat(window.innerHeight,"px"),this.emit(We,!0)}},{key:"exitRotateFullscreen",value:function(e){var t=this._fullscreenEl!==this.root?"".concat(w.INNER_FULLSCREEN," ").concat(w.ROTATE_FULLSCREEN):w.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,t,w.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(We,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(e);return}this.emit(Ni,se({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(e);return}this._clearUserTimer(),this.emit(cr,se({paused:this.paused,ended:this.ended},e))}},{key:"onFocus",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},n=this.innerStates;if(this.isActive=!0,this.removeClass(w.INACTIVE),this._clearUserTimer(),t.isLock!==void 0&&(n.isActiveLocked=t.isLock),t.autoHide===!1||t.isLock===!0||n.isActiveLocked){this._clearUserTimer();return}var r=t&&t.delay?t.delay:this.config.inactive;this.userTimer=p.setTimeout(this,function(){e.userTimer=null,e.blur()},r)}},{key:"onBlur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.ignorePaused,n=t===void 0?!1:t;if(!this.innerStates.isActiveLocked){var r=this.config.closePauseVideoFocus;this.isActive=!1,(n||r||!this.paused&&!this.ended)&&this.addClass(w.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(w.ENTER),this.removeClass(w.ERROR),this.removeClass(w.LOADING),this.isCanplay=!0,this.waitTimer&&p.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){var e=this;this.isError=!1,this.isSeeking=!1,this.__startTime>0&&(this.duration>0?this._seekToStartTime():this.once(Fe,function(){e._seekToStartTime()}))}},{key:"onLoadstart",value:function(){this.removeClass(w.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===Z.ENDED&&this.setState(Z.RUNNING),this.removeClass(w.PAUSED),this.ended&&this.removeClass(w.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(w.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(w.ENDED),this.setState(Z.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(w.NOT_ALLOW_AUTOPLAY),this.removeClass(w.NO_START),this.removeClass(w.ENTER),this.removeClass(w.LOADING),this.addClass(w.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(w.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&p.clearTimeout(this,this.waitTimer),this.removeClass(w.LOADING),this.removeClass(w.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&p.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=p.setTimeout(this,function(){e.addClass(w.LOADING),e.emit(ss),p.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1;var t=w.NO_START,n=w.PAUSED,r=w.ENDED,a=w.ERROR,o=w.REPLAY,c=w.LOADING,h=[t,n,r,a,o,c];h.forEach(function(g){e.removeClass(g)}),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(w.LOADING))&&this.media.readyState>2&&(this.removeClass(w.LOADING),p.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state===Z.NOTALLOW&&this.duration&&(this.setState(Z.RUNNING),this.emit(ht)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){p.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,t,n){if(!(!this.media||!t||!e)){var r=p.typeOf(e)==="String"?e:e.type||"";n.props&&p.typeOf(n.props)!=="Array"&&(n.props=[n.props]),this.emit(Ai,se({eventType:r,action:t,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},n))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var t=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=t,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{startDiff:0,endDiff:0},n=t||{},r=n.startDiff,a=r===void 0?0:r,o=n.endDiff,c=o===void 0?0:o,h=this.media.buffered;if(!h||h.length===0||!this.duration)return!0;for(var g=e||this.media.currentTime||.2,y=h.length,m=0;m<y;m++)if(h.start(m)+a<=g&&h.end(m)-c>g)return!0;return!1}},{key:"resizePosition",value:function(){var e=this,t=this.videoPos,n=t.vy,r=t.vx,a=t.h,o=t.w,c=this.videoPos.rotate;if(!(c<0&&a<0&&o<0)){var h=this.videoPos._pi;if(!h&&this.media.videoHeight&&(h=this.media.videoWidth/this.media.videoHeight*100),!!h){this.videoPos.pi=h,c=c<0?0:c;var g={rotate:c},y=0,m=0,_=1,C=Math.abs(c/90),D=this.root,A=this.innerContainer,O=D.offsetWidth,H=A?A.offsetHeight:D.offsetHeight,K={},Y=H,V=O;if(C%2===0)_=a>0?100/a:o>0?100/o:1,g.scale=_,y=n>0?(100-a)/2-n:0,g.y=C===2?0-y:y,m=r>0?(100-o)/2-r:0,g.x=C===2?0-m:m,K.width="".concat(V,"px"),K.height="".concat(Y,"px"),K.maxWidth="",K.maxHeight="";else if(C%2===1){V=H,Y=O;var Q=H-O;m=-Q/2/V*100,g.x=C===3?m+n/2:m-n/2,y=Q/2/Y*100,g.y=C===3?y+r/2:y-r/2,g.scale=_,K.width="".concat(V,"px"),K.maxWidth="".concat(V,"px"),K.height="".concat(Y,"px"),K.maxHeight="".concat(Y,"px")}var z=p.getTransformStyle(g,this.media.style.transform||this.media.style.webkitTransform);K.transform=z,K.webkitTransform=z,Object.keys(K).map(function($){e.media.style[$]=K[$]})}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!e||!e.h)){var t=this.videoPos;t.h=e.h*100||0,t.w=e.w*100||0,t.vx=e.x*100||0,t.vy=e.y*100||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map(function(n){if(n!=="plugins"){t.config[n]=e[n];var r=t.plugins[n.toLowerCase()];r&&p.typeOf(r.setConfig)==="Function"&&r.setConfig(e[n])}})}},{key:"playNext",value:function(e){var t=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,Re(this,"playnext",function(){t.start(),t.emit(Ii,e)})}},{key:"resize",value:function(){var e=this;if(!(!this.media||!this.root)){var t=this.root.getBoundingClientRect();this.sizeInfo.width=t.width,this.sizeInfo.height=t.height,this.sizeInfo.left=t.left,this.sizeInfo.top=t.top;var n=this.media,r=n.videoWidth,a=n.videoHeight,o=this.config,c=o.fitVideoSize,h=o.videoFillMode;if((h==="fill"||h==="cover"||h==="contain")&&this.setAttribute("data-xgfill",h),!(!a||!r)){this._videoHeight=a,this._videoWidth=r;var g=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,y=t.width,m=t.height-g,_=parseInt(r/a*1e3,10),C=parseInt(y/m*1e3,10),D=y,A=m,O={};c==="auto"&&C>_||c==="fixWidth"?(A=y/_*1e3,this.config.fluid?O.paddingTop="".concat(A*100/D,"%"):O.height="".concat(A+g,"px")):(c==="auto"&&C<_||c==="fixHeight")&&(D=_*m/1e3,O.width="".concat(D,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(O).forEach(function(K){e.root.style[K]=O[K]}),(h==="fillHeight"&&C<_||h==="fillWidth"&&C>_)&&this.setAttribute("data-xgfill","cover");var H={videoScale:_,vWidth:D,vHeight:A,cWidth:D,cHeight:A+g};this.resizePosition(),this.emit(Le,H)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(e,t);return}this.media.style.objectPosition="".concat(e*100,"% ").concat(t*100,"%")}},{key:"setState",value:function(e){ie.logInfo("setState","state from:".concat(Sn[this.state]," to:").concat(Sn[e])),this._state=e}},{key:"preProcessUrl",value:function(e,t){var n=this.config,r=n.preProcessUrl,a=n.preProcessUrlOptions,o=Object.assign({},a,t);return!p.isBlob(e)&&typeof r=="function"?r(e,o):{url:e}}},{key:"_seekToStartTime",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime>this.duration?this.duration:this.__startTime,this.__startTime=-1)}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(Z.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===Z.RUNNING||this._state===Z.ENDED},set:function(e){e?this.setState(Z.RUNNING):this._state>=Z.RUNNING&&this.setState(Z.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(e){var t=this,n=this.config.definition,r=null,a=null;n.list=e,this.emit("resourceReady",e),e.forEach(function(o){var c;((c=t.curDefinition)===null||c===void 0?void 0:c.definition)===o.definition&&(r=o),n.defaultDefinition===o.definition&&(a=o)}),!a&&e.length>0&&(a=e[0]),r?this.changeDefinition(r):a&&this.changeDefinition(a)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var t=this.media.getVideoPlaybackQuality();return e.dropped=t.droppedVideoFrames||0,e.total=t.totalVideoFrames||0,e.corrupted=t.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){var t=ct.langKeys.filter(function(n){return n===e});if(t.length===0&&e!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(ct.langKeys.join(),"] "));return}this.config.lang=e,fe.setLang(e,this)}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return as}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return W(G(s.prototype),"readyState",this)}},{key:"error",get:function(){var e=W(G(s.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return W(G(s.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,t=e.acc,n=e.t;return n?new Date().getTime()-n+t:t}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){e=p.convertDeg(e),!(e%90!==0||e===this.videoPos.rotate)&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return xn},set:function(e){xn=e}},{key:"realTimeSpeed",get:function(){return An},set:function(e){An=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,t){return cn.call.apply(cn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){return hn.call.apply(hn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,t){return fn.call.apply(fn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];return dn.call.apply(dn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];return gn.call.apply(gn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,t){var n;typeof t=="boolean"&&t!==this.muted&&(this.addInnerOP("volumechange"),p.typeOf(t)===Boolean&&(this.muted=t)),(n=He)===null||n===void 0||n.setActive(this.playerId,e)}}],[{key:"debugger",get:function(){return ie.config.debug},set:function(e){ie.config.debug=e}},{key:"instManager",get:function(){return He},set:function(e){He=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=He)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,t){var n;(n=He)===null||n===void 0||n.setActive(e,t)}},{key:"isHevcSupported",value:function(){return X.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return X.probeConfigSupported(e)}},{key:"install",value:function(e,t){s.plugins||(s.plugins={}),s.plugins[e]||(s.plugins[e]=t)}},{key:"use",value:function(e,t){s.plugins||(s.plugins={}),s.plugins[e]=t}}]),s}(Cs);b(Xt,"defaultPreset",null);b(Xt,"XgVideoProxy",null);Xt.instManager=gr.getInstance();function Ne(l,u,s){try{return' <div class="xg-tips '.concat(s?"hide":" ",'" lang-key="').concat(l.i18nKeys[u],`">
    `).concat(l.i18n[u],`
    </div>`)}catch{return'<div class="xg-tips hide"></div>'}}var tt=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_onMouseenter",function(r){i.emit("icon_mouseenter",{pluginName:i.pluginName})}),b(T(i),"_onMouseLeave",function(r){i.emit("icon_mouseleave",{pluginName:i.pluginName})}),i}return N(s,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),s}(q);function Gs(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" class='path_full' d="M9,10v1a.9.9,0,0,1-1,1,.9.9,0,0,1-1-1V9A.9.9,0,0,1,8,8h2a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1Zm6,4V13a1,1,0,0,1,2,0v2a.9.9,0,0,1-1,1H14a1,1,0,0,1,0-2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}function Ks(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" d="M9,10V9a.9.9,0,0,1,1-1,.9.9,0,0,1,1,1v2a.9.9,0,0,1-1,1H8a.9.9,0,0,1-1-1,.9.9,0,0,1,1-1Zm6,4v1a1,1,0,0,1-2,0V13a.9.9,0,0,1,1-1h2a1,1,0,0,1,0,2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}var dt=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.cssFullscreen=="boolean"&&(e.config.disable=!e.player.config.cssFullscreen)}},{key:"afterCreate",value:function(){var e=this;W(G(s.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(xi,function(t){e.animate(t)}),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen))}},{key:"initIcons",value:function(){var e=this.icons,t=this.find(".xgplayer-icon");t.appendChild(e.cssFullscreen),t.appendChild(e.exitCssFullscreen)}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.player.isCssfullScreen;this.emitUserAction(e,"switch_cssfullscreen",{cssfullscreen:t}),t?this.player.exitCssFullscreen():this.player.getCssFullscreen()}},{key:"animate",value:function(e){this.root&&(e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(e))}},{key:"switchTips",value:function(e){var t=this.i18nKeys,n=this.find(".xg-tips");n&&this.changeLangTextKey(n,e?t.EXITCSSFULLSCREEN_TIPS:t.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:Gs,class:"xg-get-cssfull"},exitCssFullscreen:{icon:Ks,class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class='xgplayer-cssfullscreen'>
    <div class="xgplayer-icon">
    </div>
    `.concat(Ne(this,"CSSFULLSCREEN_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}]),s}(tt);function Ys(){return new DOMParser().parseFromString(`<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>
    </g>
</svg>`,"image/svg+xml").firstChild}var Xs=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(t){t.preventDefault(),t.stopPropagation(),e.config.onClick(t)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:Ys,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){p.addClass(this.root,"show")}},{key:"hide",value:function(){p.removeClass(this.root,"show")}},{key:"render",value:function(){return`<xg-icon class="xgplayer-back">
    </xg-icon>`}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:te.ROOT_TOP,index:0}}}]),s}(q);function $s(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`,"image/svg+xml").firstChild}function qs(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`,"image/svg+xml").firstChild}var At=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_onOrientationChange",function(r){i.player.fullscreen&&i.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?i.player.setRotateDeg(0):i.player.setRotateDeg(90))}),i}return N(s,[{key:"afterCreate",value:function(){var e=this;W(G(s.prototype),"afterCreate",this).call(this);var t=this.config,n=this.playerConfig;if(!t.disable){t.target&&(this.playerConfig.fullscreenTarget=this.config.target);var r=p.getFullScreenEl();n.fullscreenTarget===r&&this.player.getFullscreen().catch(function(a){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(o){var c=e.player.fullscreen;e.emitUserAction(o,"switch_fullscreen",{prop:"fullscreen",from:c,to:!c})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(We,function(a){var o=e.find(".xg-tips");o&&e.changeLangTextKey(o,a?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(a)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:Xs,options:{config:{onClick:function(o){e.handleFullscreen(o)}}}})),X.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:$s,class:"xg-get-fullscreen"},exitFullscreen:{icon:qs,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",X.device==="mobile"?"touchend":"click",this.handleFullscreen),X.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e instanceof Event&&(e.preventDefault(),e.stopPropagation());var t=this.player,n=this.config,r=n.useCssFullscreen===!0||typeof n.useCssFullscreen=="function"&&n.useCssFullscreen();r?(t.fullscreen?t.exitCssFullscreen():t.getCssFullscreen(),this.animate(t.fullscreen)):n.rotateFullscreen?(t.fullscreen?t.exitRotateFullscreen():t.getRotateFullscreen(),this.animate(t.fullscreen)):n.switchCallback&&typeof n.switchCallback=="function"?n.switchCallback(t.fullscreen):t.fullscreen?(t.exitFullscreen(),n.useScreenOrientation&&this.unlockScreen()):(t.getFullscreen().catch(function(a){}),n.useScreenOrientation&&t.aspectRatio>1&&this.lockScreen(n.lockOrientationType))}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"render",value:function(){if(!this.config.disable){var e="FULLSCREEN_TIPS";return`<xg-icon class="xgplayer-fullscreen">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ne(this,e,this.playerConfig.isHideTips),`
    </xg-icon>`)}}},{key:"lockScreen",value:function(e){try{screen.orientation.lock(e).catch(function(t){})}catch{}}},{key:"unlockScreen",value:function(){try{screen.orientation.unlock().catch(function(e){})}catch{}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,useScreenOrientation:!1,lockOrientationType:"landscape",switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),s}(tt);function Mi(){return new DOMParser().parseFromString(`<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`,"image/svg+xml").firstChild}function Hi(){return new DOMParser().parseFromString(`<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`,"image/svg+xml").firstChild}var xt=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"btnClick",function(r){r.preventDefault(),r.stopPropagation();var a=T(i),o=a.player;return i.emitUserAction(r,"switch_play_pause",{prop:"paused",from:o.paused,to:!o.paused}),o.ended?o.replay():o.paused?(o.play(),i.animate(!1)):(o.pause(),i.animate(!0)),!1}),i}return N(s,[{key:"afterCreate",value:function(){W(G(s.prototype),"afterCreate",this).call(this);var e=this.config;e.disable||(this.initIcons(),this.bind(["touchend","click"],this.btnClick),this.listenEvents(),this.animate(!0))}},{key:"listenEvents",value:function(){var e=this,t=this.player;this.on([Ce,vt,Kt,mt],function(){e.animate(t.paused)})}},{key:"registerIcons",value:function(){return{play:{icon:Mi,class:"xg-icon-play"},pause:{icon:Hi,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){if(this.player){var t=this.i18nKeys,n=this.find(".xg-tips");e?(this.setAttr("data-state","pause"),n&&this.changeLangTextKey(n,t.PLAY_TIPS)):(this.setAttr("data-state","play"),n&&this.changeLangTextKey(n,t.PAUSE_TIPS))}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-play">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ne(this,"PLAY_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_LEFT,index:0,disable:!1}}}]),s}(tt),Zs=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],Js=function(){function l(u){F(this,l),this.fragments=u.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=u.actionCallback,this.fragConfig={fragFocusClass:u.fragFocusClass||"inner-focus-point",fragAutoFocus:!!u.fragAutoFocus,fragClass:u.fragClass||""},this.style=u.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return N(l,[{key:"updateDuration",value:function(s){var i=this;this.duration=s;var e=0,t=this.fragments;this.fragments=t.map(function(n){return n.start=parseInt(e,10),n.end=parseInt(e+n.percent*i.duration,10),n.duration=parseInt(n.percent*i.duration,10),e+=n.percent*i.duration,n})}},{key:"updateProgress",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},e=this.progressList,t=this.fragments;if(!(e.length<1)){var n=i.newIndex,r=i.curIndex,a=i.millisecond;n!==r&&e.map(function(h,g){g<n?h[s].style.width="100%":g>n&&(h[s].style.width=0)});var o=t[n],c=a===0?0:(a-o.start)/o.duration;e[n][s].style.width=c<0?0:"".concat(c*100,"%")}}},{key:"updateFocus",value:function(s){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!s){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var i={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(i),this.focusIndex=-1}return}var e=this.findIndex(s.currentTime*1e3,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var t={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(t)}}}},{key:"update",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},i=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(i*1e3,10)!==this.duration){if(!i&&i!==0)return;this.updateDuration(parseInt(i*1e3,10))}var e=this.playedIndex,t=this.cachedIndex;if(p.typeOf(s.played)!=="Undefined"){var n=this.findIndex(s.played*1e3,e);if(n<0)return;this.updateProgress("played",{newIndex:n,curIndex:e,millisecond:parseInt(s.played*1e3,10)}),this.playedIndex=n}if(p.typeOf(s.cached)!=="Undefined"){var r=this.findIndex(s.cached*1e3,t);if(r<0)return;this.updateProgress("cached",{newIndex:r,curIndex:t,millisecond:parseInt(s.cached*1e3,10)}),this.cachedIndex=r}}},{key:"findIndex",value:function(s,i){var e=this.fragments;if(!e||e.length===0)return-1;if(e.length===1)return 0;if(i>-1&&i<e.length&&s>e[i].start&&s<e[i].end)return i;if(s>e[e.length-1].start)return e.length-1;for(var t=0;t<e.length;t++)if(s>e[t].start&&s<=e[t].end){i=t;break}return i}},{key:"findHightLight",value:function(){for(var s=this.root.children,i=0;i<s.length;i++)if(p.hasClass(s[i],this.fragConfig.fragFocusClass))return{dom:s[i],pos:s[i].getBoundingClientRect()}}},{key:"findFragment",value:function(s){var i=this.root.children;return s<0||s>=i.length?null:{dom:i[s],pos:i[s].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var s=this.root.children,i=0;i<s.length;i++)p.removeClass(s[i],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(s){var i=this.root.children;if(s<i.length)return p.addClass(i[s],this.fragConfig.fragFocusClass),{dom:i[s],pos:i[s].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(s){var i=this;if(Object.keys(this.fragConfig).forEach(function(t){s[t]!==void 0&&(i.fragConfig[t]=s[t])}),s.fragments){if(this.fragments=s.fragments.length===0?[{percent:1}]:s.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var e=this.root.children;e.length>0;)this.root.removeChild(e[0]);this.render()}}},{key:"render",value:function(){var s=this,i=this.style.progressColor;if(this.root||(this.root=p.createDom("xg-inners","",{},"progress-list")),this.fragments){var e=this.fragConfig,t=e.fragClass,n=e.fragFocusClass;this.progressList=this.fragments.map(function(r){var a=p.createDom("xg-inner","",{style:i?"background:".concat(i,"; flex: ").concat(r.percent):"flex: ".concat(r.percent)},"".concat(r.isFocus?n:""," xgplayer-progress-inner ").concat(t));return s.root.appendChild(a),Zs.forEach(function(o){a.appendChild(p.createDom(o.tag,"",{style:o.styleKey?"background: ".concat(s.style[o.styleKey],"; width:0;"):"width:0;"},o.className))}),{cached:a.children[0],played:a.children[1]}})}return this.root}}]),l}(),Dn={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},$t=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"onMoveOnly",function(t,n){var r=T(e),a=r.pos,o=r.config,c=r.player,h=n;if(t){p.event(t);var g=p.getEventPos(t,c.zoom),y=c.rotateDeg===90?g.clientY:g.clientX;if(a.moving&&Math.abs(a.x-y)<o.miniMoveStep)return;a.moving=!0,a.x=y,h=e.computeTime(t,y)}e.triggerCallbacks("dragmove",h,t),e._updateInnerFocus(h)}),b(T(e),"onBodyClick",function(t){e.pos.isLocked&&(e.pos.isLocked=!1,t.preventDefault(),t.stopPropagation())}),b(T(e),"_mouseDownHandler",function(t,n){e._state.time=n.currentTime,e.updateWidth(n.currentTime,n.seekTime,n.percent,0),e._updateInnerFocus(n)}),b(T(e),"_mouseUpHandler",function(t,n){var r=T(e),a=r.pos;a.moving&&e.updateWidth(n.currentTime,n.seekTime,n.percent,2)}),b(T(e),"_mouseMoveHandler",function(t,n){var r=T(e),a=r._state,o=r.pos,c=r.config,h=r.player;a.time<n.currentTime?n.forward=!0:n.forward=!1,a.time=n.currentTime,o.isDown&&!o.moving&&(o.moving=!0,c.isPauseMoving&&h.pause(),e.triggerCallbacks("dragstart",n,t),e.emitUserAction("drag","dragstart",n)),e.updateWidth(n.currentTime,n.seekTime,n.percent,1),e.triggerCallbacks("dragmove",n,t),e._updateInnerFocus(n)}),b(T(e),"onMouseDown",function(t){var n=T(e),r=n._state,a=n.player,o=n.pos,c=n.config,h=n.playerConfig,g=p.getEventPos(t,a.zoom),y=a.rotateDeg===90?g.clientY:g.clientX;if(!(a.isMini||c.closeMoveSeek||!h.allowSeekAfterEnded&&a.ended)){if(!a.duration&&!a.isPlaying){a.play();return}t.stopPropagation(),e.focus(),p.checkIsFunction(h.disableSwipeHandler)&&h.disableSwipeHandler(),p.checkIsFunction(c.onMoveStart)&&c.onMoveStart(),p.event(t),o.x=y,o.isDown=!0,o.moving=!1,r.prePlayTime=a.currentTime,a.focus({autoHide:!1}),e.isProgressMoving=!0,p.addClass(e.progressBtn,"active");var m=e.computeTime(t,y);m.prePlayTime=r.prePlayTime,e._mouseDownHandlerHook(t,m);var _=t.type;return _==="touchstart"?(e.root.addEventListener("touchmove",e.onMouseMove),e.root.addEventListener("touchend",e.onMouseUp),e.root.addEventListener("touchcancel",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),document.addEventListener("mousemove",e.onMouseMove,!1),document.addEventListener("mouseup",e.onMouseUp,!1)),!0}}),b(T(e),"onMouseUp",function(t){var n=T(e),r=n.player,a=n.config,o=n.pos,c=n.playerConfig,h=n._state;if(o){t.stopPropagation(),t.preventDefault(),p.checkIsFunction(c.enableSwipeHandler)&&c.enableSwipeHandler(),p.checkIsFunction(a.onMoveEnd)&&a.onMoveEnd(),p.event(t),p.removeClass(e.progressBtn,"active");var g=e.computeTime(t,o.x);g.prePlayTime=h.prePlayTime,o.moving?(e.triggerCallbacks("dragend",g,t),e.emitUserAction("drag","dragend",g)):(e.triggerCallbacks("click",g,t),e.emitUserAction("click","click",g)),e._mouseUpHandlerHook(t,g),o.moving=!1,o.isDown=!1,o.x=0,o.y=0,o.isLocked=!0,h.prePlayTime=0,h.time=0;var y=t.type;y==="touchend"||y==="touchcancel"?(e.root.removeEventListener("touchmove",e.onMouseMove),e.root.removeEventListener("touchend",e.onMouseUp),e.root.removeEventListener("touchcancel",e.onMouseUp),e.blur()):(document.removeEventListener("mousemove",e.onMouseMove,!1),document.removeEventListener("mouseup",e.onMouseUp,!1),o.isEnter?c.isMobileSimulateMode!=="mobile"&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(t)),p.setTimeout(T(e),function(){e.resetSeekState()},1),r.focus()}}),b(T(e),"onMouseMove",function(t){var n=T(e),r=n._state,a=n.pos,o=n.player,c=n.config;p.checkTouchSupport()&&t.preventDefault(),p.event(t);var h=p.getEventPos(t,o.zoom),g=o.rotateDeg===90?h.clientY:h.clientX,y=Math.abs(a.x-g);if(!(a.moving&&y<c.miniMoveStep||!a.moving&&y<c.miniStartStep)){a.x=g;var m=e.computeTime(t,g);m.prePlayTime=r.prePlayTime,e._mouseMoveHandlerHook(t,m)}}),b(T(e),"onMouseOut",function(t){e.triggerCallbacks("mouseout",null,t)}),b(T(e),"onMouseOver",function(t){e.triggerCallbacks("mouseover",null,t)}),b(T(e),"onMouseEnter",function(t){var n=T(e),r=n.player,a=n.pos;if(!(a.isDown||a.isEnter||r.isMini||!r.config.allowSeekAfterEnded&&r.ended)){a.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),p.event(t);var o=p.getEventPos(t,r.zoom),c=r.rotateDeg===90?o.clientY:o.clientX,h=e.computeTime(t,c);e.triggerCallbacks("mouseenter",h,t),e.focus()}}),b(T(e),"onMouseLeave",function(t){e.triggerCallbacks("mouseleave",null,t),e.unlock(),e._updateInnerFocus(null)}),b(T(e),"onVideoResize",function(){var t=e.pos,n=t.x,r=t.isDown,a=t.isEnter;if(a&&!r){var o=e.computeTime(null,n);e.onMoveOnly(null,o)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,typeof e.config.isDragingSeek=="boolean"&&(console.warn("[XGPLAYER] 'isDragingSeek' is deprecated, please use 'isDraggingSeek' instead"),e.config.isDraggingSeek=e.config.isDragingSeek),e}return N(s,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,n=e.currentTime;return t>=0?t:n+this.timeOffset}},{key:"changeState",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!t||t.length===0)&&(t=[{percent:1}]);var r=se(se({fragments:t},n),{},{actionCallback:function(o){e.emitUserAction("fragment_focus","fragment_focus",o)}});this.innerList?this.innerList.reset(r):(this.innerList=new Js(r),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(a){e[a]=e.innerList[a].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var e=this.config,t=e.fragFocusClass,n=e.fragAutoFocus,r=e.fragClass;this._initInner(this.config.fragments,{fragFocusClass:t,fragAutoFocus:n,fragClass:r,style:this.playerConfig.commonStyle||{}}),X.device==="mobile"&&(this.config.isDraggingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.listenEvents(),this.bindDomEvents(),this.initCustomStyle()}}},{key:"listenEvents",value:function(){var e=this;this.on(Fe,function(){e.onMouseLeave()}),this.on(_e,function(){e.onTimeupdate()}),this.on(Oe,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on(os,function(){e.onCacheUpdate()}),this.on(yt,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(mt,function(){e.onReset()}),this.on(Le,function(){e.onVideoResize()})}},{key:"setConfig",value:function(e){var t=this,n=null;Object.keys(e).forEach(function(r){t.config[r]=e[r],r==="fragments"&&(n=e[r])}),n&&this._initInner(n,e)}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},t=e.commonStyle,n=t.sliderBtnStyle,r=this.progressBtn;n&&(typeof n=="string"?r.style.boxShadow=n:Ye(n)==="object"&&Object.keys(n).map(function(a){r.style[a]=n[a]}))}},{key:"triggerCallbacks",value:function(e,t,n){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(r){if(r&&r.handler&&r.type===e)try{r.handler(t,n)}catch(a){console.error("[XGPLAYER][triggerCallbacks] ".concat(r," error"),a)}})}},{key:"addCallBack",value:function(e,t){t&&typeof t=="function"&&this.__dragCallBacks.push({type:e,handler:t})}},{key:"removeCallBack",value:function(e,t){var n=this.__dragCallBacks,r=-1;n.map(function(a,o){a&&a.type===e&&a.handler===t&&(r=o)}),r>-1&&n.splice(r,1)}},{key:"unlock",value:function(){var e=this.player,t=this.pos;if(t.isEnter=!1,t.isLocked=!1,!e.isMini){if(this.unbind("mousemove",this.onMoveOnly),t.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var e=this.player.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&this.root.addEventListener("touchstart",this.onMouseDown),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),e.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),p.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),p.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,t,n,r){var a=this.config,o=this.player;if(!(a.isCloseClickSeek&&r===0)){var c=t=t>=o.duration?o.duration-a.endedDiff:Number(t).toFixed(1);this.updatePercent(n),this.updateTime(e),!(r===1&&(!a.isDraggingSeek||o.config.mediaType==="audio"))&&(this._state.now=c,this._state.direc=c>o.currentTime?0:1,o.seek(c))}}},{key:"computeTime",value:function(e,t){var n=this.player,r=this.root.getBoundingClientRect(),a=r.width,o=r.height,c=r.top,h=r.left,g,y,m=t;n.rotateDeg===90?(g=o,y=c):(g=a,y=h);var _=m-y;_=_>g?g:_<0?0:_;var C=_/g;C=C<0?0:C>1?1:C,Number.isNaN(C)&&(C=this.player.currentTime/this.offsetDuration);var D=parseInt(C*this.offsetDuration*1e3,10)/1e3,A=p.getCurrentTimeByOffset(D,n.timeSegments);return{percent:C,currentTime:D,seekTime:A,offset:_,width:g,left:y,e}}},{key:"updateTime",value:function(e){var t=this.player,n=this.duration;e>n?e=n:e<0&&(e=0);var r=t.plugins.time;r&&r.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,t){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(e*100,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var n=this.player.plugins.miniprogress;n&&n.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var t=this.player,n=this._state,r=this.offsetDuration;if(!(t.isSeeking&&t.media.seeking||this.isProgressMoving||!t.hasStart)){if(n.now>-1){var a=parseInt(n.now*1e3,10)-parseInt(t.currentTime*1e3,10);if(n.direc===0&&a>300||n.direc===1&&a>-300){n.now=-1;return}else n.now=-1}var o=this.currentTime;o=p.adjustTimeByDuration(o,r,e),this.innerList.update({played:o},r),this.progressBtn.style.left="".concat(o/r*100,"%")}}},{key:"onCacheUpdate",value:function(e){var t=this.player,n=this.duration;if(t){var r=t.bufferedPoint.end;r=p.adjustTimeByDuration(r,n,e),this.innerList.update({cached:r},n)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var t=this.domEventType;(t==="touch"||t==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),this.root.removeEventListener("touchcancel",this.onMouseUp)),(t==="mouse"||t==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var e=this.player.controls?this.player.controls.config.mode:"",t=e==="bottom"?"xgplayer-progress-bottom":"";return`
    <xg-progress class="xgplayer-progress `.concat(t,`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_CENTER,index:0,disable:!1,isDraggingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:Dn.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return Dn}}]),s}(q),Dt=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.isActiving=!1,e}return N(s,[{key:"duration",get:function(){var e=this.player,t=e.offsetDuration,n=e.duration;return this.playerConfig.customDuration||t||n}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,n=e.currentTime;return t>=0?t:n}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this.player.controls.config.mode;this.mode=e==="flex"?"flex":"normal",!this.config.disable&&(this.mode==="flex"&&(this.createCenterTime(),this.root.style.display="none"),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.listenEvents())}},{key:"listenEvents",value:function(){var e=this;this.on([Fe,Oe,_e],function(t){t.eventName==="durationchange"&&(e.isActiving=!1),e.onTimeUpdate()}),this.on(yt,function(){e.onTimeUpdate(!0)}),this.on(mt,function(){e.onReset()})}},{key:"show",value:function(e){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="block"),this.centerDurDom&&(this.centerDurDom.style.display="block");return}this.root.style.display="block"}},{key:"hide",value:function(){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="none"),this.centerDurDom&&(this.centerDurDom.style.display="none");return}this.root.style.display="none"}},{key:"onTimeUpdate",value:function(e){var t=this.player,n=this.config,r=this.duration;if(!(n.disable||this.isActiving||!t.hasStart)){var a=this.currentTime+this.timeOffset;a=p.adjustTimeByDuration(a,r,e),this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(p.format(a)),r!==1/0&&r>0&&(this.centerDurDom.innerHTML=p.format(r))):(this.timeDom.innerHTML=this.minWidthTime(p.format(a)),r!==1/0&&r>0&&(this.durationDom.innerHTML=p.format(r)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(p.format(0)),this.centerDurDom.innerHTML=p.format(0)):(this.timeDom.innerHTML=this.minWidthTime(p.format(0)),this.durationDom.innerHTML=p.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(!(!e.controls||!e.controls.center)){var t=e.controls.center;this.centerCurDom=p.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-left"),this.centerDurDom=p.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-right"),t.children.length>0?t.insertBefore(this.centerCurDom,t.children[0]):t.appendChild(this.centerCurDom),t.appendChild(this.centerDurDom),this.extraEls=[this.centerCurDom,this.centerDurDom]}}},{key:"afterPlayerInit",value:function(){var e=this.config;if(this.duration===1/0||this.playerConfig.isLive?(p.hide(this.durationDom),p.hide(this.timeDom),p.hide(this.find(".time-separator")),p.show(this.find(".time-live-tag"))):p.hide(this.find(".time-live-tag")),e.hide){this.hide();return}this.show()}},{key:"changeLiveState",value:function(e){e?(p.hide(this.durationDom),p.hide(this.timeDom),p.hide(this.find(".time-separator")),p.show(this.find(".time-live-tag"))):(p.hide(this.find(".time-live-tag")),p.show(this.find(".time-separator")),p.show(this.durationDom),p.show(this.timeDom))}},{key:"updateTime",value:function(e){if(this.isActiving=!0,!(!e&&e!==0||e>this.duration)){if(this.mode==="flex"){this.centerCurDom.innerHTML=this.minWidthTime(p.format(e));return}this.timeDom.innerHTML=this.minWidthTime(p.format(e))}}},{key:"minWidthTime",value:function(e){return e.split(":").map(function(t){return'<span class="time-min-width">'.concat(t,"</span>")}).join(":")}},{key:"resetActive",value:function(){var e=this,t=this.player,n=function(){e.isActiving=!1};this.off(Oe,n),t.isSeeking&&t.media.seeking?this.once(Oe,n):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-time">
    <span class="time-current">00:00</span>
    <span class="time-separator">/</span>
    <span class="time-duration">00:00</span>
    <span class="time-live-tag">`.concat(this.i18n.LIVE_TIP,`</span>
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_LEFT,index:2,disable:!1}}}]),s}(q);function Qs(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function ea(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function ta(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`,"image/svg+xml").firstChild}var It=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onBarMousedown",function(r){var a=T(i),o=a.player,c=i.find(".xgplayer-bar");p.event(r);var h=c.getBoundingClientRect(),g=p.getEventPos(r,o.zoom),y=h.height-(g.clientY-h.top);if(g.h=y,g.barH=h.height,i.pos=g,!(y<-2))return i.updateVolumePos(y,r),document.addEventListener("mouseup",i.onBarMouseUp),i._d.isStart=!0,!1}),b(T(i),"onBarMouseMove",function(r){var a=T(i),o=a._d;if(o.isStart){var c=T(i),h=c.pos,g=c.player;r.preventDefault(),r.stopPropagation(),p.event(r);var y=p.getEventPos(r,g.zoom);o.isMoving=!0;var m=h.h-y.clientY+h.clientY;m>h.barH||i.updateVolumePos(m,r)}}),b(T(i),"onBarMouseUp",function(r){p.event(r),document.removeEventListener("mouseup",i.onBarMouseUp);var a=T(i),o=a._d;o.isStart=!1,o.isMoving=!1}),b(T(i),"onMouseenter",function(r){i._d.isActive=!0,i.focus(),i.emit("icon_mouseenter",{pluginName:i.pluginName})}),b(T(i),"onMouseleave",function(r){i._d.isActive=!1,i.unFocus(100,!1,r),i.emit("icon_mouseleave",{pluginName:i.pluginName})}),b(T(i),"onVolumeChange",function(r){if(i.player){var a=i.player,o=a.muted,c=a.volume;i._d.isMoving||(i.find(".xgplayer-drag").style.height=o||c===0?"4px":"".concat(c*100,"%"),i.config.showValueLabel&&i.updateVolumeValue()),i.animate(o,c)}}),i}return N(s,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:ea,class:"xg-volume-small"},volumeLarge:{icon:Qs,class:"xg-volume"},volumeMuted:{icon:ta,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var e=this;if(this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},!this.config.disable){this.initIcons();var t=this.playerConfig,n=t.commonStyle,r=t.volume;n.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=n.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(a){e.changeMuted(a)},{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),X.device!=="mobile"&&this.playerConfig.isMobileSimulateMode!=="mobile"&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(us,this.onVolumeChange),this.once($e,this.onVolumeChange),p.typeOf(r)!=="Number"&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(e,t){var n=this.player,r=this.find(".xgplayer-drag"),a=this.find(".xgplayer-bar");if(!(!a||!r)){var o=parseInt(e/a.getBoundingClientRect().height*1e3,10);r.style.height="".concat(e,"px");var c=Math.max(Math.min(o/1e3,1),0),h={volume:{from:n.volume,to:c}};n.muted&&(h.muted={from:!0,to:!1}),this.emitUserAction(t,"change_volume",{muted:n.muted,volume:n.volume,props:h}),n.volume=Math.max(Math.min(o/1e3,1),0),n.muted&&(n.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var e=this.player,t=e.volume,n=e.muted,r=this.find(".xgplayer-value-label"),a=Math.max(Math.min(t,1),0);r.innerText=n?0:Math.round(a*100)}},{key:"focus",value:function(){var e=this.player;e.focus({autoHide:!1}),this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),p.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2?arguments[2]:void 0,a=this._d,o=this.player;a.isActive||(this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=p.setTimeout(this,function(){a.isActive||(n?o.blur():o.focus(),p.removeClass(e.root,"slide-show"),a.isStart&&e.onBarMouseUp(r)),e._timerId=null},t))}},{key:"changeMuted",value:function(e){e&&e.stopPropagation();var t=this.player,n=this._d;n.isStart&&this.onBarMouseUp(e),this.emitUserAction(e,"change_muted",{muted:t.muted,volume:t.volume,props:{muted:{from:t.muted,to:!t.muted}}}),t.volume>0&&(t.muted=!t.muted),t.volume<.01&&(t.volume=this.config.miniVolume)}},{key:"animate",value:function(e,t){e||t===0?this.setAttr("data-state","mute"):t<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.volumeSmall),this.appendChild(".xgplayer-icon",e.volumeLarge),this.appendChild(".xgplayer-icon",e.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon",X.device==="mobile"?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var e=this.config.default||this.player.volume,t=this.config.showValueLabel;return`
    <xg-icon class="xgplayer-volume" data-state="normal">
      <div class="xgplayer-icon">
      </div>
      <xg-slider class="xgplayer-slider">
        `.concat(t?'<div class="xgplayer-value-label">'.concat(e*100,"</div>"):"",`
        <div class="xgplayer-bar">
          <xg-drag class="xgplayer-drag" style="height: `).concat(e*100,`%"></xg-drag>
        </div>
      </xg-slider>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),s}(q);function ge(){return new Date().getTime()}var Ue={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"},Ui=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_onTimeupdate",function(){i._state.isTimeUpdate=!0,i._state.autoplayStart&&(ie.logInfo("[xgLogger]".concat(i.player.playerId," _onTimeupdate")),i._sendFF("onTimeupdate"))}),b(T(i),"_onAutoplayStart",function(){ie.logInfo("[xgLogger]".concat(i.player.playerId," _onAutoplayStart")),i._state.autoplayStart=!0,i.vt&&i._sendFF("onAutoplayStart")}),b(T(i),"_onReset",function(){i._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},i.vt=0,i.pt=0,i.fvt=0,i.newPointTime=ge(),i.loadedCostTime=0,i.startCostTime=0,i._isSeeking=!1,i.seekingStart=0,i.waitingStart=0,i.fixedWaitingStart=0,i._isWaiting=!1,i._waitTimer&&p.clearTimeout(T(i),i._waitTimer),i._waittTimer&&p.clearTimeout(T(i),i._waittTimer),i._waitTimer=null,i._waittTimer=null,i._waitType=0}),b(T(i),"_onSeeking",function(){i.seekingStart||(i.suspendWaitingStatus("seek"),i.seekingStart=ge(),i.emitLog(Ue.SEEK_START,{start:ge()}))}),b(T(i),"_onSeeked",function(){i.suspendSeekingStatus("seeked")}),b(T(i),"_onWaitingLoadStart",function(){i._isWaiting||i.vt||(i._isWaiting=!0,i.waitingStart=ge(),i.fixedWaitingStart=ge(),i._waitType=1,i.emitLog(Ue.WAIT_START,{fixedStart:i.fixedWaitingStart,start:i.waitingStart,type:1,endType:"loadstart"}))}),b(T(i),"_onWaiting",function(){i._isWaiting||!i.vt||(i._isWaiting=!0,i.vt?i.seekingStart?i._waitType=2:i._waitType=0:i._waitType=1,i.fixedWaitingStart=ge(),i._waitTimer=p.setTimeout(T(i),function(){i._isWaiting&&(i.waitingStart=ge(),p.clearTimeout(T(i),i._waitTimer),i._waitTimer=null,i._startWaitTimeout(),i.emitLog(Ue.WAIT_START,{fixedStart:i.fixedWaitingStart,start:i.waitingStart,type:i._waitType,endType:i._waitType===2?"seek":"playing"}))},200))}),b(T(i),"_onError",function(){i.suspendSeekingStatus("error"),i.suspendWaitingStatus("error")}),b(T(i),"_onPlaying",function(){i._isWaiting&&i.suspendWaitingStatus("playing")}),i}return N(s,[{key:"afterCreate",value:function(){var e=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=ge(),this.loadedCostTime=0,this.startCostTime=0,this.on(hr,function(){var t=e._state,n=t.autoplayStart,r=t.isFFSend;e.startCostTime=ge()-e.newPointTime,ie.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(n," isFFSend:").concat(r," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime)),!r&&(!t.isLs&&e.emitLog(Ue.LOAD_START,{}),t.isLs=!0,t.isTimeUpdate=!1,t.isFFLoading=!0,e.pt=ge(),e.vt=0,e.fvt=0,e._initOnceEvents(),e._onWaitingLoadStart())}),this.on($e,function(){e.vt=ge(),e.fvt=e.vt-e.pt,e.loadedCostTime=e.vt-e.newPointTime;var t=e._state,n=t.isTimeUpdate,r=t.isFFSend,a=t.autoplayStart;ie.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime)),(n||a)&&e._sendFF("loadedData"),r||e.emitLog(Ue.LOADED_DATA,{}),e.suspendWaitingStatus("loadeddata")}),this.on(Yt,this._onSeeking),this.on(Oe,this._onSeeked),this.on(lr,function(){e.endState("destroy")}),this.on(Ri,function(){e.endState("urlChange"),ie.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE")),e._state.isFFSend&&e._onReset()}),this.on([fr,Ke],this._onPlaying),this.on(Wt,this._onWaiting),this.on(Kt,this._onError),this.on(Fi,function(){ie.logInfo("[xgLogger]".concat(e.player.playerId," RESET")),e.endState("reset"),e._initOnceEvents(),e._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(ht,this._onAutoplayStart),this.off(_e,this._onTimeupdate),this.once(ht,this._onAutoplayStart),this.once(_e,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=ge();var t=this._state,n=t.isFFLoading,r=t.isFFSend;ie.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(n," !isFFSend:").concat(!r)),this.vt>0&&n&&!r&&(ie.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(Ue.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&p.clearTimeout(this,this._waittTimer),this._waittTimer=p.setTimeout(this,function(){e.suspendWaitingStatus("timeout"),p.clearTimeout(e,e._waittTimer),e._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var t=ge(),n=t-this.seekingStart;this.seekingStart=0,this.emitLog(Ue.SEEK_END,{end:t,costTime:n,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(p.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(p.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var t=ge(),n=t-this.waitingStart,r=t-this.fixedWaitingStart,a=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(Ue.WAIT_END,{fixedCostTime:r>a?a:r,costTime:n>a?a:n,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,t){var n=this.player;this.emit(ls,se({t:ge(),host:p.getHostFromUrl(n.currentSrc),vtype:n.vtype,eventType:e,currentTime:this.player.currentTime,readyState:n.video.readyState,networkState:n.video.networkState},t))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),s}(q);function ia(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var ji=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"registerIcons",value:function(){return{replay:ia}}},{key:"afterCreate",value:function(){var e=this;q.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){e.player.replay()},{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(yt,function(){if(e.playerConfig.loop||p.addClass(e.player.root,"replay"),!e.config.disable){e.show();var t=e.root.querySelector("path");if(t){var n=window.getComputedStyle(t).getPropertyValue("transform");if(typeof n=="string"&&n.indexOf("none")>-1)return null;t.setAttribute("transform",n)}}}),this.on(Ce,function(){e.hide()})}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),p.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),s}(q),qt=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(e){this.config.isEndedShow=e}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(e){typeof e.player.config.poster=="string"&&(e.config.poster=e.player.config.poster)}},{key:"afterCreate",value:function(){var e=this;this.on(yt,function(){e.isEndedShow&&p.removeClass(e.root,"hide")}),this.config.hideCanplay?(this.once(_e,function(){e.onTimeUpdate()}),this.on(Ri,function(){p.removeClass(e.root,"hide"),p.addClass(e.root,"xg-showplay"),e.once(_e,function(){e.onTimeUpdate()})})):this.on(Ce,function(){p.addClass(e.root,"hide")})}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(r){t.config[r]=e[r]});var n=this.config.poster;this.update(n)}},{key:"onTimeUpdate",value:function(){var e=this;this.player.currentTime?p.removeClass(this.root,"xg-showplay"):this.once(_e,function(){e.onTimeUpdate()})}},{key:"update",value:function(e){e&&(this.config.poster=e,this.root.style.backgroundImage="url(".concat(e,")"))}},{key:"getBgSize",value:function(e){var t="";switch(e){case"cover":t="cover";break;case"contain":t="contain";break;case"fixHeight":t="auto 100%";break;default:t=""}return t?"background-size: ".concat(t,";"):""}},{key:"render",value:function(){var e=this.config,t=e.poster,n=e.hideCanplay,r=e.fillMode,a=e.notHidden,o=this.getBgSize(r),c=t?"background-image:url(".concat(t,");").concat(o):o,h=a?"xg-not-hidden":n?"xg-showplay":"";return'<xg-poster class="xgplayer-poster '.concat(h,'" style="').concat(c,`">
    </xg-poster>`)}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,notHidden:!1,poster:"",fillMode:"fixWidth"}}}]),s}(q),De={};function na(l,u){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};return De[l]&&window.clearTimeout(De[l].id),De[l]={},s.start&&s.start(),De[l].id=window.setTimeout(function(){s.end&&s.end(),window.clearTimeout(De[l].id),delete De[l]},u),De[l].id}function In(l){if(l){window.clearTimeout(l);return}Object.keys(De).map(function(u){window.clearTimeout(De[u].id),delete De[u]})}var Zt=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"onPlayerReset",function(){e.autoPlayStart=!1;var t=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),p.removeClass(e.root,t),e.show()}),b(T(e),"onAutoplayStart",function(){if(!e.autoPlayStart){var t=e.config.mode==="auto"?"auto-hide":"hide";p.addClass(e.root,t),e.autoPlayStart=!0,e.toggleTo("play")}}),e.autoPlayStart=!1,e}return N(s,[{key:"afterCreate",value:function(){var e=this.playerConfig;this.initIcons(),this.listenEvents(),this.bindClickEvents(),e.autoplay||this.show()}},{key:"listenEvents",value:function(){var e=this,t=this.player,n=this.playerConfig;this.once(ar,function(){n&&(n.lang&&n.lang==="en"?p.addClass(t.root,"lang-is-en"):n.lang==="jp"&&p.addClass(t.root,"lang-is-jp"))}),this.on(ht,this.onAutoplayStart),this.on(or,function(){var r=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),p.removeClass(e.root,r),e.show()}),this.on(Ce,function(){e.toggleTo("play")}),this.on(vt,function(){e.toggleTo("pause")}),this.on(Fi,function(){e.onPlayerReset()})}},{key:"bindClickEvents",value:function(){var e=this;this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(n){n.cancelable&&n.preventDefault(),n.stopPropagation();var r=e.player.paused;e.emitUserAction(n,"switch_play_pause",{props:"paused",from:r,to:!r})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:Mi,class:"xg-icon-play"},startPause:{icon:Hi,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){p.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){p.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var t=this;this._animateId=na("pauseplay",400,{start:function(){p.addClass(t.root,"interact"),t.show(),t.switchStatus(!0)},end:function(){p.removeClass(t.root,"interact"),!e&&t.hide(),t._animateId=null}})}},{key:"endAnimate",value:function(){p.removeClass(this.root,"interact"),In(this._animateId),this._animateId=null}},{key:"switchPausePlay",value:function(e){var t=this.player;if(e.cancelable&&e.preventDefault(),e.stopPropagation(),!(t.state<Z.READY)){var n=this.player.paused;!n&&t.state===Z.RUNNING?t.pause():t.play()}}},{key:"onPlayPause",value:function(e){this.toggleTo(e)}},{key:"toggleTo",value:function(e){var t=this.config,n=this.player;if(!(!n||n.state<Z.RUNNING||!this.autoPlayStart)){if(t.mode==="show"){this.switchStatus(),this.show();return}if(t.mode==="auto"){this.switchStatus();return}if(t.isShowPause&&n.paused&&!n.ended||t.isShowEnd&&n.ended){this.switchStatus(),this.show(),this.endAnimate();return}if(t.disableAnimate){this.switchStatus(),this.hide();return}if(e==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||n.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),In(this._animateId)}},{key:"render",value:function(){var e=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return`
    <xg-start class="xgplayer-start `.concat(e,`">
    <xg-start-inner></xg-start-inner>
    </xg-start>`)}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),s}(q),Jt=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"render",value:function(){var e=this.config.innerHtml,t=p.createDom("xg-enter","",{},"xgplayer-enter");if(e&&e instanceof window.HTMLElement)t.appendChild(e);else if(e&&typeof e=="string")t.innerHTML=e;else{for(var n="",r=1;r<=12;r++)n+='<div class="xgplayer-enter-bar'.concat(r,'"></div>');t.innerHTML='<div class="xgplayer-enter-spinner">'.concat(n,"</div>")}return t}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),s}(q),Pn=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return`
      <xg-icon class="xgplayer-miniicon">
      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="`.concat(this.i18nKeys[e],'">').concat(this.i18n[e],`</span></div>
      </xg-icon>`)}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:10}}}]),s}(q);function wn(l){var u=parseFloat(l),s=l.indexOf("%")===-1&&!Number.isNaN(u);return s&&u}var Vi=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],pr=Vi.length;function ra(){for(var l={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},u=0;u<pr;u++){var s=Vi[u];l[s]=0}return l}function sa(l){var u=window.getComputedStyle(l);return u}function Rn(l){if(typeof l=="string"&&(l=document.querySelector(l)),!(!l||Ye(l)!=="object"||!l.nodeType)){var u=sa(l);if(u.display==="none")return ra();var s={};s.width=l.offsetWidth,s.height=l.offsetHeight;for(var i=s.isBorderBox=u.boxSizing==="border-box",e=0;e<pr;e++){var t=Vi[e],n=u[t],r=parseFloat(n);s[t]=Number.isNaN(r)?0:r}var a=s.paddingLeft+s.paddingRight,o=s.paddingTop+s.paddingBottom,c=s.marginLeft+s.marginRight,h=s.marginTop+s.marginBottom,g=s.borderLeftWidth+s.borderRightWidth,y=s.borderTopWidth+s.borderBottomWidth,m=i,_=wn(u.width);_!==!1&&(s.width=_+(m?0:a+g));var C=wn(u.height);return C!==!1&&(s.height=C+(m?0:o+y)),s.innerWidth=s.width-(a+g),s.innerHeight=s.height-(o+y),s.outerWidth=s.width+c,s.outerHeight=s.height+h,s}}function gi(l,u){for(var s=0;s<l.length;s++){var i=l[s];if(i.identifier===u)return i}}var pi={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},On={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},aa=function(l){U(s,l);var u=j(s);function s(i){var e,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return F(this,s),e=u.call(this),e.isEnabled=!0,e.isDragging=!1,e.isDown=!1,e.position={},e.downPoint={},e.dragPoint={x:0,y:0},e.startPos={x:0,y:0},e._root=i instanceof Element?i:document.querySelector(i),e._handlerDom=t.handle instanceof Element?t.handle:document.querySelector(t.handle),!e._root||!e._handlerDom?sr(e):(e._bindStartEvent(),e)}return N(s,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),On[this._startKey].map(function(t){e["on".concat(t)]=e["on".concat(t)].bind(e)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var t=this;if(e){var n=On[this._startKey];n.map(function(r){window.addEventListener(r,t["on".concat(r)])}),this._boundPointerEvents=n}}},{key:"_unbindPostStartEvents",value:function(){var e=this;this._boundPointerEvents&&(this._boundPointerEvents.map(function(t){window.removeEventListener(t,e["on".concat(t)])}),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame(function(){e.animate()}))}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e,this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var t=e.changedTouches[0];this.dragStart(e,t),this.touchIdentifier=t.pointerId!==void 0?t.pointerId:t.identifier,e.preventDefault()}},{key:"ontouchmove",value:function(e){var t=gi(e.changedTouches,this.touchIdentifier);t&&this.dragMove(e,t)}},{key:"ontouchend",value:function(e){var t=gi(e.changedTouches,this.touchIdentifier);t&&this.dragEnd(e,t),e.preventDefault()}},{key:"ontouchcancel",value:function(e){var t=gi(e.changedTouches,this.touchIdentifier);t&&this.dragCancel(e,t)}},{key:"dragStart",value:function(e,t){if(!(!this._root||this.isDown||!this.isEnabled)){this.downPoint=t,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var n=Rn(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-n.height,this.startPos.maxX=window.innerWidth-n.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,t){this.isDragging=!0,this.animate(),this.emit(pi.START,this.startPos)}},{key:"dragEnd",value:function(e,t){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(pi.ENDED)),this.presetInfo())}},{key:"_dragPointerMove",value:function(e,t){var n={x:t.pageX-this.downPoint.pageX,y:t.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(n)&&this.dragRealStart(e,t),n}},{key:"dragMove",value:function(e,t){if(e=e||window.event,!!this.isDown){var n=this.startPos,r=n.x,a=n.y,o=this._dragPointerMove(e,t),c=o.x,h=o.y;c=this.checkContain("x",c,r),h=this.checkContain("y",h,a),this.position.x=r+c,this.position.y=a+h,this.dragPoint.x=c,this.dragPoint.y=h,this.emit(pi.MOVE,this.position)}}},{key:"dragCancel",value:function(e,t){this.dragEnd(e,t)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,t,n){return t+n<0?0-n:e==="x"&&t+n>this.startPos.maxX?this.startPos.maxX-n:e==="y"&&t+n>this.startPos.maxY?this.startPos.maxY-n:t}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root),t=this._getPositionCoord(e.left,"width"),n=this._getPositionCoord(e.top,"height");this.position.x=Number.isNaN(t)?0:t,this.position.y=Number.isNaN(n)?0:n,this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var t=e.transform;if(t.indexOf("matrix")===0){var n=t.split(","),r=t.indexOf("matrix3d")===0?12:4,a=parseInt(n[r],10),o=parseInt(n[r+1],10);this.position.x+=a,this.position.y+=o}}},{key:"_getPositionCoord",value:function(e,t){if(e.indexOf("%")!==-1){var n=Rn(this._root.parentNode);return n?parseFloat(e)/100*n[t]:0}return parseInt(e,10)}}]),s}(Gt),vr=function(l){U(s,l);var u=j(s);function s(i){var e;F(this,s),e=u.call(this,i),b(T(e),"onCancelClick",function(r){e.exitMini(),e.isClose=!0}),b(T(e),"onCenterClick",function(r){var a=T(e),o=a.player;o.paused?o.play():o.pause()}),b(T(e),"onScroll",function(r){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-e.pos.scrollY)<50)){var a=parseInt(p.getCss(e.player.root,"height"));a+=e.config.scrollTop,e.pos.scrollY=window.scrollY,window.scrollY>a+5?!e.isMini&&!e.isClose&&e.getMini():window.scrollY<=a&&(e.isMini&&e.exitMini(),e.isClose=!1)}}),e.isMini=!1,e.isClose=!1;var t=T(e),n=t.config;return e.pos={left:n.left<0?window.innerWidth-n.width-20:n.left,top:n.top<0?window.innerHeight-n.height-20:n.top,height:e.config.height,width:e.config.width,scrollY:window.scrollY||0},e.lastStyle=null,e}return N(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.mini=="boolean"&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.on(vt,function(){e.setAttr("data-state","pause")}),this.on(Ce,function(){e.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var e=this,t=this.player,n=this.config;if(!n.disable){if(this.config.isShowIcon){var r={config:{onClick:function(){e.getMini()}}};t.controls.registerPlugin(Pn,r,Pn.pluginName)}var a=p.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",a,this.onCancelClick),this.bind(".play-icon",a,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new aa(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:Mi,class:"xg-icon-play"},pause:{icon:Hi,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play),this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var t=this.player,n=this.playerConfig,r=this.config.target||this.player.root;this.lastStyle={},p.addClass(t.root,"xgplayer-mini"),["width","height","top","left"].map(function(a){e.lastStyle[a]=r.style[a],r.style[a]="".concat(e.pos[a],"px")}),n.fluid&&(r.style["padding-top"]=""),this.emit(Si,!0),t.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return!1;var t=this.player,n=this.playerConfig,r=this.config.target||this.player.root;p.removeClass(t.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(a){r.style[a]=e.lastStyle[a]}),this.lastStyle=null,n.fluid&&(t.root.style.width="100%",t.root.style.height="0",t.root.style["padding-top"]="".concat(n.height*100/n.width,"%")),this.emit(Si,!1),this.isMini=t.isMini=!1}},{key:"updatePos",value:function(e){this.pos=Object.assign(this.pos,e),this.isMini&&(this.player.root.style.left="".concat(this.pos.left,"px"),this.player.root.style.top="".concat(this.pos.top,"px"),this.player.root.style.width="".concat(this.pos.width,"px"),this.player.root.style.height="".concat(this.pos.height,"px"))}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=p.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick),this.unbind(".play-icon",e,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return`
      <xg-mini-layer class="xg-mini-layer">
      <xg-mini-header class="xgplayer-mini-header">
      `.concat(Ne(this,"MINI_DRAG",this.playerConfig.isHideTips),`
      </xg-mini-header>
      <div class="mini-cancel-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>
        </svg>
      </div>
      <div class="play-icon">
      </div>
      </xg-mini-layer>`)}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),s}(q),Mt={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},vi=["videoClick","videoDbClick"],et=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onMouseMove",function(r){var a=T(i),o=a.player,c=a.playerConfig;o.isActive||(o.focus({autoHide:!c.closeDelayBlur}),!c.closeFocusVideoFocus&&o.media.focus())}),b(T(i),"onMouseEnter",function(r){var a=T(i),o=a.playerConfig,c=a.player;!o.closeFocusVideoFocus&&c.media.focus(),o.closeDelayBlur?c.focus({autoHide:!1}):c.focus(),i.emit(cs)}),b(T(i),"onMouseLeave",function(r){var a=i.playerConfig,o=a.closePlayerBlur,c=a.leavePlayerTime,h=a.closeDelayBlur;!o&&!h&&(c?i.player.focus({autoHide:!0,delay:c}):i.player.blur({ignorePaused:!0})),i.emit(hs)}),b(T(i),"onVideoClick",function(r){var a=T(i),o=a.player,c=a.playerConfig;r.target&&c.closeVideoClick||(r.target===o.root||r.target===o.media||r.target===o.innerContainer||r.target===o.media.__canvas)&&(r.preventDefault(),c.closeVideoStopPropagation||r.stopPropagation(),i._clickCount++,i.clickTimer&&(clearTimeout(i.clickTimer),i.clickTimer=null),i.clickTimer=setTimeout(function(){i._clickCount&&(i._clickCount--,Re(T(i),vi[0],function(h,g){i.switchPlayPause(g.e)},{e:r,paused:o.paused}),clearTimeout(i.clickTimer),i.clickTimer=null)},300))}),b(T(i),"onVideoDblClick",function(r){var a=T(i),o=a.player,c=a.playerConfig;if(!(c.closeVideoDblclick||!r.target||r.target!==o.media&&r.target!==o.media.__canvas)){if(!c.closeVideoClick&&i._clickCount<2){i._clickCount=0;return}i._clickCount=0,i.clickTimer&&(clearTimeout(i.clickTimer),i.clickTimer=null),r.preventDefault(),r.stopPropagation(),Re(T(i),vi[1],function(h,g){i.emitUserAction(g.e,"switch_fullscreen",{props:"fullscreen",from:o.fullscreen,to:!o.fullscreen}),o.fullscreen?o.exitFullscreen():o.getFullscreen()},{e:r,fullscreen:o.fullscreen})}}),i}return N(s,[{key:"afterCreate",value:function(){var e=this;this._clickCount=0,vi.map(function(n){e.__hooks[n]=null});var t=this.playerConfig.isMobileSimulateMode;t==="mobile"||X.device==="mobile"&&!X.os.isIpad||this.initEvents()}},{key:"initEvents",value:function(){var e=this,t=this.player,n=t.media,r=t.root,a=this.playerConfig.enableContextmenu;r&&r.addEventListener("click",this.onVideoClick,!1),r&&r.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(Mt).map(function(o){r.addEventListener(o,e[Mt[o]],!1)}),!a&&n&&n.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(e){var t=this.player;this.emitUserAction(e,"switch_play_pause",{props:"paused",from:t.paused,to:!t.paused}),t.ended?t.duration!==1/0&&t.duration>0&&t.replay():t.paused?t.play():t.pause()}},{key:"onContextmenu",value:function(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"destroy",value:function(){var e=this,t=this.player,n=t.video,r=t.root;this.clickTimer&&clearTimeout(this.clickTimer),r.removeEventListener("click",this.onVideoClick,!1),r.removeEventListener("dblclick",this.onVideoDblClick,!1),n.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(Mt).map(function(a){r.removeEventListener(a,e[Mt[a]],!1)})}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}]),s}(Xe),je={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},oa={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},ua={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function Ln(l){return l&&l.length>0?l[l.length-1]:null}function la(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var ca=function(){function l(u){var s=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};F(this,l),b(this,"onTouchStart",function(e){var t=s._pos,n=s.root,r=Ln(e.touches);t.x=r?parseInt(r.pageX,10):e.pageX,t.y=r?parseInt(r.pageX,10):e.pageX,t.start=!0,s.__setPress(e),n.addEventListener(s.events.end,s.onTouchEnd),n.addEventListener(s.events.cancel,s.onTouchCancel),n.addEventListener(s.events.move,s.onTouchMove),s.trigger(je.TOUCH_START,e)}),b(this,"onTouchCancel",function(e){s.onTouchEnd(e)}),b(this,"onTouchEnd",function(e){var t=s._pos,n=s.root;s.__clearPress(),n.removeEventListener(s.events.cancel,s.onTouchCancel),n.removeEventListener(s.events.end,s.onTouchEnd),n.removeEventListener(s.events.move,s.onTouchMove),e.moving=t.moving,e.press=t.press,t.press&&s.trigger(je.PRESS_END,e),s.trigger(je.TOUCH_END,e),!t.press&&!t.moving&&s.__setDb(e),t.press=!1,t.start=!1,t.moving=!1}),b(this,"onTouchMove",function(e){var t=s._pos,n=s.config,r=Ln(e.touches),a=r?parseInt(r.pageX,10):e.pageX,o=r?parseInt(r.pageY,10):e.pageX,c=a-t.x,h=o-t.y;Math.abs(h)<n.miniStep&&Math.abs(c)<n.miniStep||(s.__clearPress(),t.press&&s.trigger(je.PRESS_END,e),t.press=!1,t.moving=!0,s.trigger(je.TOUCH_MOVE,e))}),this._pos={moving:!1,start:!1,x:0,y:0},this.config=la(),Object.keys(i).map(function(e){s.config[e]=i[e]}),this.root=u,this.events=i.eventType==="mouse"?ua:oa,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return N(l,[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(s){var i=this,e=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){i.trigger(je.PRESS,s),i._pos.press=!0,i.__clearPress()},e.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(s){var i=this,e=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(je.DOUBlE_CLICK,s);return}this.dbIntrvalId=setTimeout(function(){i.__clearDb(),!i._pos.start&&!i._pos.press&&!i._pos.moving&&i.trigger(je.CLICK,s)},e.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(s,i){this.__handlers[s]||(this.__handlers[s]=[]),this.__handlers[s].push(i)}},{key:"off",value:function(s,i){if(this.__handlers[s]){for(var e=this.__handlers[s],t=-1,n=0;n<e.length;n++)if(e[n]===i){t=n;break}t>=0&&this.__handlers[s].splice(t,1)}}},{key:"trigger",value:function(s,i){this.__handlers[s]&&this.__handlers[s].map(function(e){try{e(i)}catch(t){console.error("trigger>>:".concat(s),t)}})}},{key:"destroy",value:function(){var s=this,i={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(i).forEach(function(e){s.root.removeEventListener(e,s[i[e]])})}}]),l}();function ha(){return new DOMParser().parseFromString(`<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path opacity="0.54"
    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"
    fill="white" />
  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>
</svg>`,"image/svg+xml").firstChild}var rt={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},mi=["videoClick","videoDbClick"],Qt=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"onTouchStart",function(t){var n=T(e),r=n.player,a=n.config,o=n.pos,c=n.playerConfig,h=e.getTouche(t);if(h&&!a.disableGesture&&e.duration>0&&!r.ended){o.isStart=!0,e.timer&&clearTimeout(e.timer),p.checkIsFunction(c.disableSwipeHandler)&&c.disableSwipeHandler(),e.find(".xg-dur").innerHTML=p.format(e.duration);var g=e.root.getBoundingClientRect();r.rotateDeg===90?(o.top=g.left,o.left=g.top,o.width=g.height,o.height=g.width):(o.top=g.top,o.left=g.left,o.width=g.width,o.height=g.height);var y=parseInt(h.pageX-o.left,10),m=parseInt(h.pageY-o.top,10);o.x=r.rotateDeg===90?m:y,o.y=r.rotateDeg===90?y:m,o.scopeL=a.scopeL*o.width,o.scopeR=(1-a.scopeR)*o.width,o.scopeM1=o.width*(1-a.scopeM)/2,o.scopeM2=o.width-o.scopeM1}}),b(T(e),"onTouchMove",function(t){var n=e.getTouche(t),r=T(e),a=r.pos,o=r.config,c=r.player;if(!(!n||o.disableGesture||!e.duration||!a.isStart)){var h=o.miniMoveStep,g=o.hideControlsActive,y=parseInt(n.pageX-a.left,10),m=parseInt(n.pageY-a.top,10),_=c.rotateDeg===90?m:y,C=c.rotateDeg===90?y:m;if(Math.abs(_-a.x)>h||Math.abs(C-a.y)>h){var D=_-a.x,A=C-a.y,O=a.scope;if(O===-1&&(O=e.checkScope(_,C,D,A,a),O===0&&(g?c.blur():c.focus({autoHide:!1}),!a.time&&(a.time=parseInt(c.currentTime*1e3,10)+e.timeOffset*1e3)),a.scope=O),O===-1||O>0&&!o.gestureY||O===0&&!o.gestureX)return;e.executeMove(D,A,O,a.width,a.height),a.x=_,a.y=C}}}),b(T(e),"onTouchEnd",function(t){var n=T(e),r=n.player,a=n.pos,o=n.playerConfig;if(setTimeout(function(){r.getPlugin("progress")&&r.getPlugin("progress").resetSeekState()},10),!!a.isStart){a.scope>-1&&t.cancelable&&t.preventDefault();var c=e.config,h=c.disableGesture,g=c.gestureX;!h&&g?e.endLastMove(a.scope):a.time=0,a.scope=-1,e.resetPos(),p.checkIsFunction(o.enableSwipeHandler)&&o.enableSwipeHandler(),e.changeAction(rt.AUTO)}}),b(T(e),"onRootTouchMove",function(t){e.config.disableGesture||!e.config.gestureX||e.checkIsRootTarget(t)&&(t.stopPropagation(),e.pos.isStart?e.onTouchMove(t):e.onTouchStart(t))}),b(T(e),"onRootTouchEnd",function(t){e.pos.scope>-1&&e.onTouchEnd(t)}),e.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},e.timer=null,e}return N(s,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:ha,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this;mi.map(function(g){e.__hooks[g]=null});var t=this.playerConfig,n=this.config,r=this.player;t.closeVideoDblclick===!0&&(n.closedbClick=!0),this.resetPos(),p.isUndefined(t.disableGesture)||(n.disableGesture=!!t.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=p.createDom("xg-mask","",{},"xgmask"),r.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var a=this.domEventType==="mouse"?"mouse":"touch";this.touch=new ca(this.root,{eventType:a,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(g){g.preventDefault()}),r.root.addEventListener("touchmove",this.onRootTouchMove,!0),r.root.addEventListener("touchend",this.onRootTouchEnd,!0),r.root.addEventListener("touchcancel",this.onRootTouchEnd,!0);var o=this.player.controls;o&&o.center&&(o.center.addEventListener("touchmove",this.onRootTouchMove,!0),o.center.addEventListener("touchend",this.onRootTouchEnd,!0),o.center.addEventListener("touchcancel",this.onRootTouchEnd,!0)),this.on(Fe,function(){var g=e.player,y=e.config;g.duration>0&&g.duration*1e3<y.moveDuration&&(y.moveDuration=g.duration*1e3)}),this.on([Ke,yt],function(){var g=e.pos,y=g.time,m=g.isStart;!m&&y>0&&(e.pos.time=0)});var c={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(c).map(function(g){e.touch.on(g,function(y){e[c[g]](y)})}),!n.disableActive){var h=r.plugins.progress;h&&(h.addCallBack("dragmove",function(g){e.activeSeekNote(g.currentTime,g.forward)}),["dragend","click"].forEach(function(g){h.addCallBack(g,function(){e.changeAction(rt.AUTO)})}))}}},{key:"registerThumbnail",value:function(){var e=this.player,t=e.plugins.thumbnail;if(t&&t.usable){this.thumbnail=t.createThumbnail(null,"mobile-thumbnail");var n=this.find(".time-preview");n.insertBefore(this.thumbnail,n.children[0])}}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},t=e.commonStyle,n=t.playedColor,r=t.progressColor,a=t.timePreviewStyle,o=t.curTimeColor,c=t.durationColor;if(n&&(this.find(".xg-curbar").style.backgroundColor=n),r&&(this.find(".xg-bar").style.backgroundColor=r),a){var h=this.find(".time-preview");Object.keys(a).forEach(function(m){h.style[m]=a[m]})}var g=o||n,y=c;g&&(this.find(".xg-cur").style.color=g),y&&(this.find(".xg-dur").style.color=y),this.config.disableTimeProgress&&p.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(t){e.pos[t]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var t=this.player,n=this.root;n.setAttribute("data-xg-action",e);var r=t.plugins.start;r&&r.recover()}},{key:"getTouche",value:function(e){var t=this.player.rotateDeg,n=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return t===0?{pageX:n.pageX,pageY:n.pageY}:{pageX:n.pageX,pageY:n.pageY}}},{key:"checkScope",value:function(e,t,n,r,a){var o=a.width,c=-1;if(e<0||e>o)return c;var h=Math.abs(r===0?n:n/r);return Math.abs(n)>0&&h>=1.73&&e>a.scopeM1&&e<a.scopeM2?c=0:(Math.abs(n)===0||h<=.57)&&(c=e<a.scopeL?1:e>a.scopeR?2:3),c}},{key:"executeMove",value:function(e,t,n,r,a){switch(n){case 0:this.updateTime(e/r*this.config.scopeM);break;case 1:this.updateBrightness(t/a);break;case 2:X.os.isIos||this.updateVolume(t/a);break}}},{key:"endLastMove",value:function(e){var t=this,n=this.pos,r=this.player,a=this.config,o=(n.time-this.timeOffset)/1e3;switch(e){case 0:r.seek(Number(o).toFixed(1)),a.hideControlsEnd?r.blur():r.focus(),this.timer=setTimeout(function(){t.pos.time=0},500);break}this.changeAction(rt.AUTO)}},{key:"checkIsRootTarget",value:function(e){var t=this.player.plugins||{};return t.progress&&t.progress.root.contains(e.target)?!1:t.start&&t.start.root.contains(e.target)||t.controls&&t.controls.root.contains(e.target)}},{key:"sendUseAction",value:function(e){var t=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:t,to:!t})}},{key:"clickHandler",value:function(e){var t=this.player,n=this.config,r=this.playerConfig;if(t.state<Z.RUNNING){r.closeVideoClick||(this.sendUseAction(p.createEvent("click")),t.play());return}!n.closedbClick||r.closeVideoClick?t.isActive?t.blur():t.focus():r.closeVideoClick||((t.isActive||n.focusVideoClick)&&(this.sendUseAction(p.createEvent("click")),this.switchPlayPause()),t.focus())}},{key:"dbClickHandler",value:function(e){var t=this.config,n=this.player;!t.closedbClick&&n.state>=Z.RUNNING&&(this.sendUseAction(p.createEvent("dblclick")),this.switchPlayPause())}},{key:"onClick",value:function(e){var t=this,n=this.player;Re(this,mi[0],function(r,a){t.clickHandler(a.e)},{e,paused:n.paused})}},{key:"onDbClick",value:function(e){var t=this,n=this.player;Re(this,mi[1],function(r,a){t.dbClickHandler(a.e)},{e,paused:n.paused})}},{key:"onPress",value:function(e){var t=this.pos,n=this.config,r=this.player;n.disablePress||(t.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:r.playbackRate,to:n.pressRate}),r.playbackRate=n.pressRate,this.changeAction(rt.PLAYBACK))}},{key:"onPressEnd",value:function(e){var t=this.pos,n=this.config,r=this.player;n.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:r.playbackRate,to:t.rate}),r.playbackRate=t.rate,t.rate=1,this.changeAction(rt.AUTO))}},{key:"updateTime",value:function(e){var t=this.player,n=this.config,r=this.player.duration;e=Number(e.toFixed(4));var a=parseInt(e*n.moveDuration,10)+this.timeOffset;a+=this.pos.time,a=a<0?0:a>r*1e3?r*1e3-200:a,t.getPlugin("time")&&t.getPlugin("time").updateTime(a/1e3),t.getPlugin("progress")&&t.getPlugin("progress").updatePercent(a/1e3/this.duration,!0),this.activeSeekNote(a/1e3,e>0),n.isTouchingSeek&&t.seek(Number((a-this.timeOffset)/1e3).toFixed(1)),this.pos.time=a}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var t=this.player,n=this.pos;if(e=parseInt(e*100,10),n.volume+=e,!(Math.abs(n.volume)<10)){var r=parseInt(t.volume*10,10)-parseInt(n.volume/10,10);r=r>10?10:r<1?0:r,t.volume=r/10,n.volume=0}}},{key:"updateBrightness",value:function(e){var t=this.pos,n=this.config,r=this.xgMask;if(n.darkness){this.player.rotateDeg&&(e=-e);var a=t.light+.8*e;a=a>n.maxDarkness?n.maxDarkness:a<0?0:a,r&&(r.style.backgroundColor="rgba(0,0,0,".concat(a,")")),t.light=a}}},{key:"activeSeekNote",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.player,r=this.config,a=!(this.duration!==1/0&&this.duration>0);if(!(!e||typeof e!="number"||a||r.disableActive)){e<0?e=0:e>n.duration&&(e=n.duration-.2),this.changeAction(rt.SEEKING);var o=n.plugins.start;o&&o.focusHide(),this.find(".xg-dur").innerHTML=p.format(this.duration),this.find(".xg-cur").innerHTML=p.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),t?p.removeClass(this.find(".xg-seek-show"),"xg-back"):p.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var t=this.player,n=t.plugins.thumbnail;n&&n.usable&&this.thumbnail&&n.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<Z.ATTACHED)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!0}},{key:"enableGesture",value:function(){this.config.disableGesture=!1}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0),e.root.removeEventListener("touchcancel",this.onRootTouchEnd,!0);var t=this.player.controls;t&&t.center&&(t.center.removeEventListener("touchmove",this.onRootTouchMove,!0),t.center.removeEventListener("touchend",this.onRootTouchEnd,!0),t.center.removeEventListener("touchcancel",this.onRootTouchEnd,!0))}},{key:"render",value:function(){var e=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return`
     <xg-trigger class="trigger">
     <div class="`.concat(e,`"></div>
        <div class="time-preview">
            <div class="xg-seek-show `).concat(this.config.disableSeekIcon?" hide-seek-icon":"",`">
              <i class="xg-seek-icon"></i>
              <span class="xg-cur">00:00</span>
              <span class="xg-separator">/</span>
              <span class="xg-dur">00:00</span>
            </div>
              <div class="xg-bar xg-timebar">
                <div class="xg-curbar"></div>
              </div>
        </div>
        <div class="xg-playbackrate xg-top-note">
            <span><i>`).concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,`</span>
        </div>
     </xg-trigger>
    `)}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:60*6*1e3,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),s}(q);function fa(l){l.preventDefault(),l.returnValue=!1}function Fn(l){var u=l.tagName;return!!(u==="INPUT"||u==="TEXTAREA"||l.isContentEditable)}var gt=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onBodyKeyDown",function(r){if(i.player){var a=r||window.event,o=a.keyCode,c=T(i),h=c._keyState,g=c.player,y=i.config,m=y.disable,_=y.disableBodyTrigger,C=y.isIgnoreUserActive;if(m||_||!(g.isUserActive||C)||Fn(a.target)||!i.checkIsVisible()||a.metaKey||a.altKey||a.ctrlKey){h.isBodyKeyDown=!1;return}!r.repeat&&!h.isKeyDown&&((a.target===document.body||i.config.isGlobalTrigger&&!Fn(a.target))&&i.checkCode(o,!0)&&(h.isBodyKeyDown=!0),document.addEventListener("keyup",i.onBodyKeyUp)),h.isBodyKeyDown&&i.handleKeyDown(a)}}),b(T(i),"onBodyKeyUp",function(r){i.player&&(document.removeEventListener("keyup",i.onBodyKeyUp),i.handleKeyUp(r))}),b(T(i),"onKeydown",function(r){if(i.player){var a=r||window.event,o=T(i),c=o._keyState;if(!a.repeat){if(i.config.disable||i.config.disableRootTrigger||a.metaKey||a.altKey||a.ctrlKey)return;a&&(a.keyCode===37||i.checkCode(a.keyCode))&&(a.target===i.player.root||a.target===i.player.video||a.target===i.player.controls.el)&&(c.isKeyDown=!0),i.player.root.addEventListener("keyup",i.onKeyup)}c.isKeyDown&&i.handleKeyDown(a)}}),b(T(i),"onKeyup",function(r){i.player&&(i.player.root.removeEventListener("keyup",i.onKeyup),i.handleKeyUp(r))}),i}return N(s,[{key:"mergekeyCodeMap",value:function(){var e=this,t=this.config.keyCodeMap;t&&Object.keys(t).map(function(n){e.keyCodeMap[n]?["keyCode","action","disable","pressAction","disablePress","isBodyTarget"].map(function(r){t[n][r]&&(e.keyCodeMap[n][r]=t[n][r])}):e.keyCodeMap[n]=t[n]})}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var e=typeof this.config.seekStep=="function"?this.config.seekStep(this.player):this.config.seekStep;!e||typeof e!="number"||(this.seekStep=e),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,disablePress:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,disablePress:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,disablePress:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disablePress:!1,disable:!1},right:{keyCode:39,action:"seek",pressAction:"changePlaybackRate",disablePress:!1,disable:!1},esc:{keyCode:27,action:"exitFullscreen",disablePress:!0,disable:!1}},this.mergekeyCodeMap(),this._keyState={isKeyDown:!1,isBodyKeyDown:!1,isPress:!1,tt:0,playbackRate:0},this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(n){t.config[n]=e[n]})}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var e=this.player.root.getBoundingClientRect(),t=e.height,n=e.top,r=e.bottom,a=window.innerHeight;return!(n<0&&n<0-t*.9||r>0&&r-a>t*.9)}},{key:"checkCode",value:function(e,t){var n=this,r=!1;return Object.keys(this.keyCodeMap).map(function(a){n.keyCodeMap[a]&&e===n.keyCodeMap[a].keyCode&&!n.keyCodeMap[a].disable&&(r=!t||t&&!n.keyCodeMap[a].noBodyTarget)}),r}},{key:"downVolume",value:function(e){var t=this.player;if(!(t.volume<=0)){var n=parseFloat((t.volume-.1).toFixed(1)),r={volume:{from:t.volume,to:n}};this.emitUserAction(e,"change_volume",{props:r}),n>=0?t.volume=n:t.volume=0}}},{key:"upVolume",value:function(e){var t=this.player;if(!(t.volume>=1)){var n=parseFloat((t.volume+.1).toFixed(1)),r={volume:{from:t.volume,to:n}};this.emitUserAction(e,"change_volume",{props:r}),n<=1?t.volume=n:t.volume=1}}},{key:"seek",value:function(e){var t=this.player,n=t.currentTime,r=t.offsetCurrentTime,a=t.duration,o=t.offsetDuration,c=t.timeSegments,h=r>-1?r:n,g=o||a,y=e.repeat&&this.seekStep>=4?parseInt(this.seekStep/2,10):this.seekStep;h+y<=g?h=h+y:h=g;var m=p.getCurrentTimeByOffset(h,c),_={currentTime:{from:n,to:m}};this.emitUserAction(e,"seek",{props:_}),this.player.currentTime=m}},{key:"seekBack",value:function(e){var t=this.player,n=t.currentTime,r=t.offsetCurrentTime,a=t.timeSegments,o=e.repeat?parseInt(this.seekStep/2,10):this.seekStep,c=r>-1?r:n,h=c-o;h<0&&(h=0),h=p.getCurrentTimeByOffset(h,a);var g={currentTime:{from:n,to:h}};this.emitUserAction(e,"seek",{props:g}),this.player.currentTime=h}},{key:"changePlaybackRate",value:function(e){var t=this._keyState,n=this.config,r=this.player;t.playbackRate===0&&(t.playbackRate=r.playbackRate,r.playbackRate=n.playbackRate)}},{key:"playPause",value:function(e){var t=this.player;t&&(this.emitUserAction(e,"switch_play_pause"),t.paused?t.play():t.pause())}},{key:"exitFullscreen",value:function(e){var t=this.player,n=t.fullscreen,r=t.cssfullscreen;n&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:n,to:!n}),t.exitFullscreen()),r&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:r,to:!r}),t.exitCssFullscreen())}},{key:"handleKeyDown",value:function(e){var t=this._keyState;if(e.repeat){t.isPress=!0;var n=Date.now();if(n-t.tt<200)return;t.tt=n}this.handleKeyCode(e.keyCode,e,t.isPress)}},{key:"handleKeyUp",value:function(e){var t=this._keyState;t.playbackRate>0&&(this.player.playbackRate=t.playbackRate,t.playbackRate=0),t.isKeyDown=!1,t.isPress=!1,t.tt=0}},{key:"handleKeyCode",value:function(e,t,n){for(var r=Object.keys(this.keyCodeMap),a=0;a<r.length;a++){var o=this.keyCodeMap[r[a]],c=o.action,h=o.keyCode,g=o.disable,y=o.pressAction,m=o.disablePress;if(h===e){if(!g&&!(n&&m)){var _=n&&y||c;typeof _=="function"?c(t,this.player,n):typeof _=="string"&&typeof this[_]=="function"&&this[_](t,this.player,n),this.emit(fs,se({key:r[a],target:t.target,isPress:n},this.keyCodeMap[r[a]]))}fa(t),t.stopPropagation();break}}}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown),this.player.root.removeEventListener("keyup",this.onKeyup),document.removeEventListener("keyup",this.onBodyKeyUp)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!1,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!0,keyCodeMap:{},disable:!1,playbackRate:2,isIgnoreUserActive:!0}}}]),s}(Xe);function da(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">
  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>
</svg>
`,"image/svg+xml").firstChild}var ei=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"registerIcons",value:function(){return{loadingIcon:da}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return`
    <xg-loading class="xgplayer-loading">
      <xg-loading-inner></xg-loading-inner>
    </xg-loading>`}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:te.ROOT}}}]),s}(q),ga=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_onDurationChange",function(){i.updateSegments();var r=i.player,a=r.currentTime,o=r.timeSegments;if(i._checkIfEnabled(o)){var c=p.getIndexByTime(a,o),h=p.getOffsetCurrentTime(a,o,c);i.player.offsetCurrentTime=h,i.changeIndex(c,o)}}),b(T(i),"_onLoadedData",function(){var r=i.player.timeSegments;if(i._checkIfEnabled(r)){var a=p.getOffsetCurrentTime(0,r);i.player.offsetCurrentTime=a,i.changeIndex(0,r),i.curPos.start>0&&(i.player.currentTime=i.curPos.start)}}),b(T(i),"_onTimeupdate",function(){var r=i.player,a=r.currentTime,o=r.timeSegments;if(i._checkIfEnabled(o)){var c=o.length;i.lastCurrentTime=a;var h=p.getIndexByTime(a,o);h!==i.curIndex&&i.changeIndex(h,o);var g=p.getOffsetCurrentTime(a,o,h);if(i.player.offsetCurrentTime=g,!!i.curPos){var y=i.curPos,m=y.start,_=y.end;a<m?i.player.currentTime=m:a>_&&h>=c-1&&i.player.pause()}}}),b(T(i),"_onSeeking",function(){var r=i.player,a=r.currentTime,o=r.timeSegments;if(i._checkIfEnabled(o))if(a<o[0].start)i.player.currentTime=o[0].start;else if(a>o[o.length-1].end)i.player.currentTime=o[o.length-1].end;else{var c=p.getIndexByTime(a,o);if(c>=0){var h=i.getSeekTime(a,i.lastCurrentTime,c,o);h>=0&&(i.player.currentTime=h)}}}),b(T(i),"_onPlay",function(){var r=i.player,a=r.currentTime,o=r.timeSegments;i._checkIfEnabled(o)&&a>=o[o.length-1].end&&(i.player.currentTime=o[0].start)}),i}return N(s,[{key:"afterCreate",value:function(){this.curIndex=-1,this.curPos=null,this.lastCurrentTime=0,this.updateSegments(),this.on(Fe,this._onDurationChange),this.on($e,this._onLoadedData),this.on(_e,this._onTimeupdate),this.on(Yt,this._onSeeking),this.on(Ce,this._onPlay)}},{key:"setConfig",value:function(e){var t=this;if(e){var n=Object.keys(e);n.length<1||(n.forEach(function(r){t.config[r]=e[r]}),this.updateSegments())}}},{key:"updateSegments",value:function(){var e=this.config,t=e.disable,n=e.segments,r=this.player;if(t||!n||n.length===0)r.timeSegments=[],r.offsetDuration=0,r.offsetCurrentTime=-1;else{var a=this.formatTimeSegments(n,r.duration);r.timeSegments=a,r.offsetDuration=a.length>0?a[a.length-1].duration:0}}},{key:"formatTimeSegments",value:function(e,t){var n=[];return e?(e.sort(function(r,a){return r.start-a.start}),e.forEach(function(r,a){var o={};if(o.start=r.start<0?0:r.start,o.end=t>0&&r.end>t?t:r.end,!(t>0&&o.start>t)){n.push(o);var c=o.end-o.start;if(a===0)o.offset=r.start,o.cTime=0,o.segDuration=c,o.duration=c;else{var h=n[a-1];o.offset=h.offset+(o.start-h.end),o.cTime=h.duration+h.cTime,o.segDuration=c,o.duration=h.duration+c}}}),n):[]}},{key:"getSeekTime",value:function(e,t,n,r){var a=-1,o=r[n],c=o.start,h=o.end;if(e>=c&&e<=h)return a;var g=e-t;if(g<0&&e<c){var y=t>c?t-c:0;return a=n-1>=0?r[n-1].end+g+y:0,a}return-1}},{key:"_checkIfEnabled",value:function(e){return!(!e||e.length<1)}},{key:"changeIndex",value:function(e,t){this.curIndex=e,e>=0&&t.length>0?this.curPos=t[e]:this.curPos=null}}],[{key:"pluginName",get:function(){return"TimeSegmentsControls"}},{key:"defaultConfig",get:function(){return{disable:!0,segments:[]}}}]),s}(Xe);function pa(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">
  <g>
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath>
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`,"image/svg+xml").firstChild}var ti=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.rotateDeg=e.config.rotateDeg||0,e}return N(s,[{key:"afterCreate",value:function(){var e=this;if(!this.config.disable){W(G(s.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(Le,function(){e.rotateDeg&&e.config.innerRotate&&p.setTimeout(e,function(){e.updateRotateDeg(e.rotateDeg,e.config.innerRotate)},100)});var t=this.player.root;this.rootWidth=t.style.width||t.offsetWidth||t.clientWidth,this.rootHeight=t.style.height||t.offsetHeight||t.clientHeight,this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate)}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(e,t){if(e||(e=0),t){this.player.videoRotateDeg=e;return}var n=this.player,r=this.rootWidth,a=this.rootHeight,o=n.root,c=n.innerContainer,h=n.media,g=o.offsetWidth,y=c&&t?c.offsetHeight:o.offsetHeight,m=r,_=a,C=0,D=0;(e===.75||e===.25)&&(m="".concat(y,"px"),_="".concat(g,"px"),C=-(y-g)/2,D=-(g-y)/2);var A="translate(".concat(C,"px,").concat(D,"px) rotate(").concat(e,"turn)"),O={transformOrigin:"center center",transform:A,webKitTransform:A,height:_,width:m},H=t?h:o,K=t?n.getPlugin("poster"):null;Object.keys(O).map(function(Y){H.style[Y]=O[Y],K&&K.root&&(K.root.style[Y]=O[Y])})}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=this.player;this.rotateDeg||(this.rotateDeg=0);var a=e?1:-1;this.rotateDeg=(this.rotateDeg+1+a*.25*n)%1,this.updateRotateDeg(this.rotateDeg,t),r.emit(ds,this.rotateDeg*360)}},{key:"registerIcons",value:function(){return{rotate:pa}}},{key:"render",value:function(){if(!this.config.disable)return`
    <xg-icon class="xgplayer-rotate">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ne(this,"ROTATE_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),s}(tt);function va(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}function ma(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}var st={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},ii=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"switchPIP",function(r){if(!i.isPIPAvailable())return!1;r.stopPropagation&&r.stopPropagation(),i.isPip?(i.exitPIP(),i.emitUserAction(r,"change_pip",{props:"pip",from:!0,to:!1}),i.setAttr("data-state","normal")):i.player.media.readyState===4&&(i.requestPIP(),i.emitUserAction(r,"change_pip",{props:"pip",from:!1,to:!0}),i.setAttr("data-state","pip"))}),i}return N(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.pip=="boolean"&&(e.config.showIcon=e.player.config.pip)}},{key:"afterCreate",value:function(){var e=this;this.isPIPAvailable()&&(W(G(s.prototype),"afterCreate",this).call(this),this.pMode=st.INLINE,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(Li,function(){e.config.showIcon&&(p.removeClass(e.find(".xgplayer-icon"),"xg-icon-disable"),e.bind("click",e.switchPIP))}))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:va,class:"xg-get-pip"},pipIconExit:{icon:ma,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.pipIcon),this.appendChild(".xgplayer-icon",e.pipIconExit)}},{key:"initPipEvents",value:function(){var e=this,t=this.player;this.leavePIPCallback=function(){var n=t.paused;p.setTimeout(e,function(){!n&&t.mediaPlay()},0),!n&&t.mediaPlay(),e.setAttr("data-state","normal"),e.pipWindow=null,t.emit(pn,!1)},this.enterPIPCallback=function(n){t.emit(pn,!0),n!=null&&n.pictureInPictureWindow&&(e.pipWindow=n.pictureInPictureWindow),e.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(n){var r=t.media.webkitPresentationMode;e.pMode===st.FULLSCREEN&&r!==st.FULLSCREEN&&t.onFullscreenChange(null,!1),e.pMode=r,r===st.PIP?e.enterPIPCallback(n):r===st.INLINE&&e.leavePIPCallback(n)},t.media&&(t.media.addEventListener("enterpictureinpicture",this.enterPIPCallback),t.media.addEventListener("leavepictureinpicture",this.leavePIPCallback),s.checkWebkitSetPresentationMode(t.media)&&t.media.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"copyStyleIntoPiPWindow",value:function(e){var t=Pe(document.styleSheets).map(function(r){try{return Pe(r.cssRules).map(function(o){return o.cssText}).join("")}catch{var a=document.createElement("link");a.rel="stylesheet",a.type=r.type,a.media=r.media,a.href=r.href,e.document.head.appendChild(a)}return""}).filter(Boolean).join(`
`),n=document.createElement("style");n.textContent=t,e.document.head.appendChild(n)}},{key:"requestPIP",value:function(){var e=this,t=this.player,n=this.playerConfig,r=this.config;if(!(!this.isPIPAvailable()||this.isPip))try{var a=n.poster;if(a&&(t.media.poster=p.typeOf(a)==="String"?a:a.poster),r.preferDocument&&this.isDocPIPAvailable()){var o={};if(r.width&&r.height)o.width=r.width,o.height=r.height;else{var c=t.root.getBoundingClientRect();o.width=c.width,o.height=c.height}documentPictureInPicture.requestWindow(o).then(function(h){var g=r.docPiPNode,y=r.docPiPStyle;e.enterPIPCallback();var m=g||t.root,_=m.parentElement,C=m.previousSibling,D=m.nextSibling;e.copyStyleIntoPiPWindow(h);var A=document.createElement("style");if(A.append("body{padding:0; margin:0;}"),y){var O="";typeof y=="string"?O=y:typeof y=="function"&&(O=y.call(r)),O&&A.append(O)}else m===t.root&&A.append(`
              .xgplayer{width: 100%!important; height: 100%!important;}
            `);h.document.head.append(A),h.document.body.append(m),h.addEventListener("pagehide",function(H){_&&(D?_.insertBefore(m,D):C?_.insertBefore(m,C.nextSibling):_.appendChild(m)),e.leavePIPCallback()},{once:!0})})}else s.checkWebkitSetPresentationMode(t.media)?t.media.webkitSetPresentationMode("picture-in-picture"):t.media.requestPictureInPicture();return!0}catch(h){return console.error("requestPiP",h),!1}}},{key:"exitPIP",value:function(){var e=this.player;try{if(this.isPIPAvailable()&&this.isPip){var t;this.isDocPIPAvailable()&&(t=documentPictureInPicture)!==null&&t!==void 0&&t.window?documentPictureInPicture.window.close():s.checkWebkitSetPresentationMode(e.media)?e.media.webkitSetPresentationMode("inline"):document.exitPictureInPicture()}return!0}catch(n){return console.error("exitPIP",n),!1}}},{key:"isPip",get:function(){var e,t=this.player;return!!(this.isDocPIPAvailable()&&(e=documentPictureInPicture)!==null&&e!==void 0&&e.window)||document.pictureInPictureElement&&document.pictureInPictureElement===t.media||t.media.webkitPresentationMode===st.PIP}},{key:"isPIPAvailable",value:function(){var e=this.player.media,t=p.typeOf(document.pictureInPictureEnabled)==="Boolean"?document.pictureInPictureEnabled:!1;return t&&(p.typeOf(e.disablePictureInPicture)==="Boolean"&&!e.disablePictureInPicture||e.webkitSupportsPresentationMode&&p.typeOf(e.webkitSetPresentationMode)==="Function")||this.isDocPIPAvailable()}},{key:"isDocPIPAvailable",value:function(){return"documentPictureInPicture"in window&&/^(https|file)/.test(location.protocol)}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this);var e=this.player;e.media.removeEventListener("enterpictureinpicture",this.enterPIPCallback),e.media.removeEventListener("leavepictureinpicture",this.leavePIPCallback),s.checkWebkitSetPresentationMode(e.media)&&e.media.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(!(!this.config.showIcon||!this.isPIPAvailable()))return`<xg-icon class="xgplayer-pip">
      <div class="xgplayer-icon xg-icon-disable">
      </div>
      `.concat(Ne(this,"PIP",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:6,showIcon:!1,preferDocument:!1,width:void 0,height:void 0,docPiPNode:void 0,docPiPStyle:void 0}}},{key:"checkWebkitSetPresentationMode",value:function(e){return typeof e.webkitSetPresentationMode=="function"}}]),s}(tt);function ya(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var zi=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"playNext",function(t){var n=T(e),r=n.player;t.preventDefault(),t.stopPropagation(),e.idx+1<e.config.urlList.length?(e.idx++,e.nextHandler(e.config.urlList[e.idx],e.idx),r.emit(Ii,e.idx+1)):(e.nextHandler(),r.emit(Ii))}),e.idx=-1,e}return N(s,[{key:"afterCreate",value:function(){!this.config.urlList||this.config.urlList.length===0||(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:ya}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=X.device==="mobile"?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var t=this.player;e&&(t.pause(),t.currentTime=0,t.switchURL?t.switchURL(e):t.src=e,t.config.url=e,t.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!(!this.config.urlList||this.config.urlList.length===0))return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ne(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),s}(q),mr={exports:{}};(function(l,u){(function(s,i){l.exports=i()})(Vt,function(){return function s(i,e,t){var n=window,r="application/octet-stream",a=t||r,o=i,c=!e&&!t&&o,h=document.createElement("a"),g=function(V){return String(V)},y=n.Blob||n.MozBlob||n.WebKitBlob||g,m=e||"download",_,C;if(y=y.call?y.bind(n):Blob,String(this)==="true"&&(o=[o,a],a=o[0],o=o[1]),c&&c.length<2048&&(m=c.split("/").pop().split("?")[0],h.href=c,h.href.indexOf(c)!==-1)){var D=new XMLHttpRequest;return D.open("GET",c,!0),D.responseType="blob",D.onload=function(V){s(V.target.response,m,r)},setTimeout(function(){D.send()},0),D}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(o))if(o.length>1024*1024*1.999&&y!==g)o=K(o),a=o.type||r;else return navigator.msSaveBlob?navigator.msSaveBlob(K(o),m):Y(o);else if(/([\x80-\xff])/.test(o)){var A=0,O=new Uint8Array(o.length),H=O.length;for(A;A<H;++A)O[A]=o.charCodeAt(A);o=new y([O],{type:a})}_=o instanceof y?o:new y([o],{type:a});function K(V){var Q=V.split(/[:;,]/),z=Q[1],$=Q[2]=="base64"?atob:decodeURIComponent,J=$(Q.pop()),le=J.length,oe=0,he=new Uint8Array(le);for(oe;oe<le;++oe)he[oe]=J.charCodeAt(oe);return new y([he],{type:z})}function Y(V,Q){if("download"in h)return h.href=V,h.setAttribute("download",m),h.className="download-js-link",h.innerHTML="downloading...",h.style.display="none",document.body.appendChild(h),setTimeout(function(){h.click(),document.body.removeChild(h),Q===!0&&setTimeout(function(){n.URL.revokeObjectURL(h.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(V)&&(V="data:"+V.replace(/^data:([\w\/\-\+]+)/,r)),window.open(V)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=V),!0;var z=document.createElement("iframe");document.body.appendChild(z),!Q&&/^data:/.test(V)&&(V="data:"+V.replace(/^data:([\w\/\-\+]+)/,r)),z.src=V,setTimeout(function(){document.body.removeChild(z)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(_,m);if(n.URL)Y(n.URL.createObjectURL(_),!0);else{if(typeof _=="string"||_.constructor===g)try{return Y("data:"+a+";base64,"+n.btoa(_))}catch{return Y("data:"+a+","+encodeURIComponent(_))}C=new FileReader,C.onload=function(V){Y(this.result)},C.readAsDataURL(_)}return!0}})})(mr);var Ea=mr.exports;const _a=Oi(Ea);function Ca(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var Wi=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"download",function(t){if(!e.isLock){e.emitUserAction(t,"download");var n=e.playerConfig.url,r="";p.typeOf(n)==="String"?r=n:p.typeOf(n)==="Array"&&n.length>0&&(r=n[0].src);var a=e.getAbsoluteURL(r);_a(a),e.isLock=!0,e.timer=window.setTimeout(function(){e.isLock=!1,window.clearTimeout(e.timer),e.timer=null},300)}}),e.timer=null,e.isLock=!1,e}return N(s,[{key:"afterCreate",value:function(){W(G(s.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.appendChild(".xgplayer-icon",this.icons.download),this._handler=this.hook("click",this.download,{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.bind(["click","touchend"],this._handler))}},{key:"registerIcons",value:function(){return{download:Ca}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var t=document.createElement("div");t.innerHTML='<a href="'.concat(e,'">x</a>'),e=t.firstChild.href}return e}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat(Ne(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:3,disable:!0}}}]),s}(tt),Gi=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.screenShot=="boolean"&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){W(G(s.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(t){e.fitVideo&&(e.width=t.vWidth,e.height=t.vHeight)},this.once(Le,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,t){var n=document.createElement("a");n.href=e,n.download=t;var r;try{typeof MouseEvent<"u"?r=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}):(r=document.createEvent("MouseEvents"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null))}catch(a){console.error("MouseEvent unsupported",a)}r&&n.dispatchEvent(r)}},{key:"createCanvas",value:function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");this.canvasCtx=r,this.canvas=n,n.width=e||this.config.width,n.height=t||this.config.height,r.imageSmoothingEnabled=!0,r.imageSmoothingEnabled&&(r.imageSmoothingQuality="high")}},{key:"onClickBtn",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot");var n=this.config;this.shot(n.width,n.height).then(function(r){t.emit(gs,r),n.saveImg&&t.saveScreenShot(r,n.name+n.format)})}},{key:"shot",value:function(e,t){var n=this,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},a=this.config,o=this.player,c=r.quality||a.quality,h=r.type||a.type;return new Promise(function(g,y){var m=null,_;if(o.media.canvas)m=o.media.canvas;else{n.canvas?(n.canvas.width=e||a.width,n.canvas.height=t||a.height):n.createCanvas(e,t),m=n.canvas,_=n.canvasCtx;var C=o.media.videoWidth/o.media.videoHeight,D=m.width/m.height,A=0,O=0,H=o.media.videoWidth,K=o.media.videoHeight,Y,V,Q,z;C>D?(Q=m.width,z=m.width/C,Y=0,V=Math.round((m.height-z)/2)):C===D?(Q=m.width,z=m.height,Y=0,V=0):C<D&&(Q=m.height*C,z=m.height,Y=Math.round((m.width-Q)/2),V=0),_.drawImage(o.media,A,O,H,K,Y,V,Q,z)}var $=m.toDataURL(h,c).replace(h,"image/octet-stream");$=$.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),g($)})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(Le,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",t="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(e,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[t],'">').concat(this.i18n[t],"</span>"),`
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,saveImg:!0,fitVideo:!0,disable:!1,name:"screenshot"}}}]),s}(tt),Ta=function(){function l(u){F(this,l),this.config=u.config,this.parent=u.root,this.root=p.createDom("ul","",{},"xg-options-list xg-list-slide-scroll ".concat(this.config.className)),u.root.appendChild(this.root);var s=this.config.maxHeight;s&&this.setStyle({maxHeight:s}),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var i=this.config.domEventType==="touch"?"touchend":"click";this._delegates=q.delegate.call(this,this.root,"li",i,this.onItemClick)}return N(l,[{key:"renderItemList",value:function(s){var i=this,e=this.config,t=this.root;s?e.data=s:s=e.data,e.style&&Object.keys(e.style).map(function(n){t.style[n]=e[n]}),s.length>0&&(this.attrKeys=Object.keys(s[0])),this.root.innerHTML="",s.map(function(n,r){var a=n.selected?"option-item selected":"option-item";n["data-index"]=r,i.root.appendChild(p.createDom("li","<span>".concat(n.showText,"</span>"),n,a))})}},{key:"onItemClick",value:function(s){s.delegateTarget||(s.delegateTarget=s.target);var i=s.delegateTarget;if(i&&p.hasClass(i,"selected"))return!1;var e=typeof this.config.onItemClick=="function"?this.config.onItemClick:null,t=this.root.querySelector(".selected");p.addClass(i,"selected"),t&&p.removeClass(t,"selected"),e(s,{from:t?this.getAttrObj(t,this.attrKeys):null,to:this.getAttrObj(i,this.attrKeys)})}},{key:"getAttrObj",value:function(s,i){if(!s||!i)return{};var e={};i.map(function(n){e[n]=s.getAttribute(n)});var t=s.getAttribute("data-index");return t&&(e.index=Number(t)),e}},{key:"show",value:function(){p.removeClass(this.root,"hide"),p.addClass(this.root,"active")}},{key:"hide",value:function(){p.removeClass(this.root,"active"),p.addClass(this.root,"hide")}},{key:"setStyle",value:function(s){var i=this;Object.keys(s).forEach(function(e){i.root.style[e]=s[e]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(s){s.destroy&&s.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),l}(),Ae={SIDE:"side",MIDDLE:"middle",DEFAULT:"default"},at={CLICK:"click",HOVER:"hover"};function ka(l,u){return l===Ae.SIDE?u===te.CONTROLS_LEFT?"xg-side-list xg-left-side":"xg-side-list xg-right-side":""}var Je=X.device==="mobile",pt=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"onEnter",function(t){t.stopPropagation(),e.emit("icon_mouseenter",{pluginName:e.pluginName}),e.switchActiveState(t)}),b(T(e),"switchActiveState",function(t){t.stopPropagation();var n=e.config.toggleMode;n===at.CLICK?e.toggle(!e.isActive):e.toggle(!0)}),b(T(e),"onLeave",function(t){t.stopPropagation(),e.emit("icon_mouseleave",{pluginName:e.pluginName}),e.config.listType!==Ae.SIDE&&e.isActive&&e.toggle(!1)}),b(T(e),"onListEnter",function(t){e.enterType=2}),b(T(e),"onListLeave",function(t){e.enterType=0,e.isActive&&e.toggle(!1)}),e.isIcons=!1,e.isActive=!1,e.curValue=null,e.curIndex=0,e}return N(s,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,t=this.config;this.initIcons(),Je=Je||this.domEventType==="touch",Je&&X.device==="mobile"&&t.listType===Ae.DEFAULT&&(t.listType=Ae.SIDE),t.hidePortrait&&p.addClass(this.root,"portrait"),this.on([Le,We],function(){e._resizeList()}),this.once(Ke,function(){t.list&&t.list.length>0&&(e.renderItemList(t.list),e.show())}),Je&&this.on(Ni,function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)}),Je?(t.toggleMode=at.CLICK,this.activeEvent="touchend"):this.activeEvent=t.toggleMode===at.CLICK?"click":"mouseenter",t.toggleMode===at.CLICK?this.bind(this.activeEvent,this.switchActiveState):(this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var e=this,t=this.icons,n=Object.keys(t),r=!1;n.length>0&&(n.forEach(function(a){e.appendChild(".xgplayer-icon",t[a]),!r&&(r=t[a])}),this.isIcons=r),!r&&(this.appendChild(".xgplayer-icon",p.createDom("span","",{},"icon-text")),p.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||p.addClass(this.root,"show")}},{key:"hide",value:function(){p.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,t,n){if(e===void 0)return"";var r=this.config.list;!n&&(n=this.player.lang),t=!t||p.isUndefined(e[t])?"text":t,typeof e=="number"&&(e=r[e]);try{return Ye(e[t])==="object"?e[t][n]||e[t].en:e[t]}catch(a){return console.warn(a),""}}},{key:"toggle",value:function(e){if(!(e===this.isActive||this.config.disable)){var t=this.player.controls,n=this.config.listType;e?(n===Ae.SIDE?t.blur():t.focus(),this.optionsList&&this.optionsList.show()):(n===Ae.SIDE?t.focus():t.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,t){e.stopPropagation();var n=this.config,r=n.listType,a=n.list;this.curIndex=t.to.index,this.curItem=a[this.curIndex],this.changeCurrentText();var o=this.config.isItemClickHide;(o||Je||r===Ae.SIDE)&&this.toggle(!1)}},{key:"onIconClick",value:function(e){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,t=this.curIndex<e.length?this.curIndex:0,n=e[t];n&&(this.find(".icon-text").innerHTML=this.getTextByLang(n,"iconText"))}}},{key:"renderItemList",value:function(e,t){var n=this,r=this.config,a=this.optionsList,o=this.player;if(typeof t=="number"&&(this.curIndex=t,this.curItem=r.list[t]),a){a.renderItemList(e),this.changeCurrentText();return}var c={config:{data:e||[],className:ka(r.listType,r.position),onItemClick:function(_,C){n.onItemClick(_,C)},domEventType:Je?"touch":"mouse"},root:r.listType===Ae.SIDE?o.innerContainer||o.root:this.root};if(this.config.isShowIcon){var h=this.player.root.getBoundingClientRect(),g=h.height,y=r.listType===Ae.MIDDLE?g-50:g;y&&r.heightLimit&&(c.config.maxHeight="".concat(y,"px")),this.optionsList=new Ta(c),this.changeCurrentText(),this.show()}this._resizeList()}},{key:"_resizeList",value:function(){if(this.config.heightLimit){var e=this.player.root.getBoundingClientRect(),t=e.height,n=this.config.listType===Ae.MIDDLE?t-50:t;this.optionsList&&this.optionsList.setStyle({maxHeight:"".concat(n,"px")})}}},{key:"destroy",value:function(){var e=this.config;e.toggleMode===at.CLICK?this.unbind(this.activeEvent,this.switchActiveState):(this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave)),this.isIcons&&this.unbind("click",this.onIconClick),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",`">
    <div class="xgplayer-icon">
    </div>
   </xg-icon>`)}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:100,list:[],listType:"default",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0,toggleMode:at.HOVER,heightLimit:!0}}}]),s}(q),ni=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.curTime=0,e.isPaused=!0,e}return N(s,[{key:"beforeCreate",value:function(e){var t=e.config.list;Array.isArray(t)&&t.length>0&&(e.config.list=t.map(function(n){return!n.text&&n.name&&(n.text=n.name),n.text||(n.text=n.definition),n}))}},{key:"afterCreate",value:function(){var e=this;W(G(s.prototype),"afterCreate",this).call(this),this.on("resourceReady",function(t){e.changeDefinitionList(t)}),this.on(ur,function(t){e.renderItemList(e.config.list,t.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||p.addClass(this.root,"show")}},{key:"initDefinition",value:function(){var e=this.config,t=e.list,n=e.defaultDefinition;if(t.length>0){var r=null;t.map(function(a){a.definition===n&&(r=a)}),r||(r=t[0]),this.changeDefinition(r)}}},{key:"renderItemList",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.list||[],n=arguments.length>1?arguments[1]:void 0,r=n&&n.definition?n.definition:this.config.defaultDefinition;n&&t.forEach(function(c){c.selected=!1});var a=0,o=t.map(function(c,h){var g=se(se({},c),{},{showText:e.getTextByLang(c)||c.definition,selected:!1});return(c.selected||c.definition&&c.definition==r)&&(g.selected=!0,a=h),g});W(G(s.prototype),"renderItemList",this).call(this,o,a)}},{key:"changeDefinitionList",value:function(e){Array.isArray(e)&&(this.config.list=e.map(function(t){return!t.text&&t.name&&(t.text=t.name),t.text||(t.text=t.definition),t}),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(e,t){this.player.changeDefinition(e,t)}},{key:"onItemClick",value:function(e,t){var n=this.player.definitionList;W(G(s.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(e,"change_definition",{from:t.from,to:t.to});for(var r=0;r<n.length;r++)t.to&&n[r].definition===t.to.definition&&(t.to.url=n[r].url),t.from&&n[r].definition===t.from.definition&&(t.from.url=n[r].url);this.player.changeDefinition(t.to,t.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return se(se({},pt.defaultConfig),{},{position:te.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0})}}]),s}(pt),ri=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.curRate=1,e}return N(s,[{key:"beforeCreate",value:function(e){var t=e.player.config.playbackRate,n=t?Array.isArray(t)?t:e.config.list:[];Array.isArray(n)&&(e.config.list=n.map(function(r){return typeof r=="number"?r={rate:r,text:"".concat(r,"x")}:!r.text&&r.rate&&(r.text="".concat(r.rate,"x")),r}))}},{key:"afterCreate",value:function(){var e=this;W(G(s.prototype),"afterCreate",this).call(this),this.on(ps,function(){e.curValue!==e.player.playbackRate&&e.renderItemList()}),this.renderItemList()}},{key:"show",value:function(e){!this.config.list||this.config.list.length===0||W(G(s.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(e,t){W(G(s.prototype),"onItemClick",this).call(this,e,t);var n=e.delegateTarget,r=Number(n.getAttribute("rate"));if(!r||r===this.curValue)return!1;var a={playbackRate:{from:this.player.playbackRate,to:r}};this.emitUserAction(e,"change_rate",{props:a}),this.curValue=r,this.player.playbackRate=r}},{key:"renderItemList",value:function(){var e=this,t=this.player.playbackRate||1;this.curValue=t;var n=-1,r=this.config.list.map(function(a,o){var c={rate:a.rate};return c.rate===t&&(c.selected=!0,n=o),c.showText=e.getTextByLang(a),c});W(G(s.prototype),"renderItemList",this).call(this,r,n)}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,t=this.curIndex<e.length?this.curIndex:0,n=e[t],r="";!n||this.curIndex<0?r="".concat(this.player.playbackRate,"x"):r=this.getTextByLang(n,"iconText"),this.find(".icon-text").innerHTML=r}}},{key:"destroy",value:function(){W(G(s.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return se(se({},pt.defaultConfig),{},{position:te.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1})}}]),s}(pt),si=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(Kt,function(t){e.onError(t)})}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=this.player,n=e.errorType,r=t.errorNote?this.i18n[t.errorNote]:"";if(!r)switch(n){case"decoder":r=this.i18n.MEDIA_ERR_DECODE;break;case"network":r=this.i18n.MEDIA_ERR_NETWORK;break;default:r=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=r,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return`<xg-error class="xgplayer-error">
      <div class="xgplayer-errornote">
       <span class="xgplayer-error-text"></span>
       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>
      </div>
    </xg-error>`}}],[{key:"pluginName",get:function(){return"error"}}]),s}(q),Ki=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(t){(e.config.onClick||e.customOnClick)&&(t.preventDefault(),t.stopPropagation(),e.customOnClick?e.customOnClick(t):e.config.onClick(t))}),this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var t=this;Object.keys(e).map(function(n){t.root.style[n]=e[n]})}},{key:"showPrompt",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=r;var a=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),p.addClass(this.root,"show"),n.mode==="arrow"&&p.addClass(this.root,"arrow"),typeof e=="string"?this.find(".xgplayer-prompt-detail").innerHTML=e:this.find(".xgplayer-prompt-detail").innerHTML="".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),n.style&&this.setStyle(n.style);var o=typeof n.autoHide=="boolean"?n.autoHide:this.config.autoHide;if(o){var c=n.interval||a;this.intervalId=setTimeout(function(){t.hide()},c)}}}},{key:"hide",value:function(){p.removeClass(this.root,"show"),p.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(w.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),s}(q),Nn={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function yr(l){Object.keys(Nn).map(function(u){l[u]===void 0&&(l[u]=Nn[u])})}var Bn={_updateDotDom:function(u,s){if(s){var i=this.calcuPosition(u.time,u.duration),e=u.style||{};e.left="".concat(i.left,"%"),e.width="".concat(i.width,"%"),s.setAttribute("data-text",u.text),s.setAttribute("data-time",u.time),i.isMini?p.addClass(s,"mini"):p.removeClass(s,"mini"),Object.keys(e).map(function(t){s.style[t]=e[t]})}},initDots:function(){var u=this;this._ispots.map(function(s){u.createDot(s,!1)}),this.ispotsInit=!0},createDot:function(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this.player.plugins.progress;if(i&&(s&&(yr(u),this._ispots.push(u)),!(!this.ispotsInit&&s))){var e=this.calcuPosition(u.time,u.duration),t=u.style||{};t.left="".concat(e.left,"%"),t.width="".concat(e.width,"%");var n="xgspot_".concat(u.id," xgplayer-spot");e.isMini&&(n+=" mini");var r=u.template?'<div class="xgplayer-spot-pop">'.concat(u.template,"</div>"):"",a=p.createDom("xg-spot",r,{"data-text":u.text,"data-time":u.time,"data-id":u.id},n);Object.keys(t).map(function(o){a.style[o]=t[o]}),i.outer&&i.outer.appendChild(a),this.positionDot(a,u.id)}},findDot:function(u){if(this.player.plugins.progress){var s=this._ispots.filter(function(i,e){return i.id===u});return s.length>0?s[0]:null}},updateDot:function(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.player.plugins.progress;if(i){var e=this.findDot(u.id);if(e&&Object.keys(u).map(function(n){e[n]=u[n]}),!!this.ispotsInit){var t=i.find('xg-spot[data-id="'.concat(u.id,'"]'));t&&(this._updateDotDom(u,t),s&&this.showDot(u.id))}}},deleteDot:function(u){var s=this._ispots,i=this.player.plugins.progress;if(i){for(var e=[],t=0;t<s.length;t++)s[t].id===u&&e.push(t);for(var n=e.length,r=n-1;r>=0;r--)if(s.splice(e[r],1),this.ispotsInit){var a=i.find('xg-spot[data-id="'.concat(u,'"]'));a&&a.parentElement.removeChild(a)}}},deleteAllDots:function(){var u=this.player.plugins.progress;if(u){if(!this.ispotsInit){this._ispots=[];return}for(var s=u.root.getElementsByTagName("xg-spot"),i=s.length-1;i>=0;i--)u.outer.removeChild(s[i]);this._ispots=[]}},updateAllDots:function(){var u=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=this.player.plugins.progress;if(i){if(!this.ispotsInit){this._ispots=s;return}this._ispots=[];var e=i.root.getElementsByTagName("xg-spot"),t=e.length;if(t>s.length)for(var n=t-1;n>s.length-1;n--)i.outer.removeChild(e[n]);s.forEach(function(r,a){a<t?(e[a].setAttribute("data-id","".concat(r.id)),u._ispots.push(r),u.updateDot(r)):u.createDot(r)})}},positionDots:function(){var u=this,s=this._ispots,i=this.playerSize,e=this.player.sizeInfo,t=this.player.plugins.progress;!t||e.width===i.width||(i.width=e.width,i.left=e.left,s.forEach(function(n){var r=t.find('xg-spot[data-id="'.concat(n.id,'"]'));r&&u.positionDot(r,n.id)}))},positionDot:function(u,s){var i=p.findDom(u,".xgplayer-spot-pop");if(i){var e=this.playerSize,t=u.getBoundingClientRect(),n=i.getBoundingClientRect(),r=t.left-e.left,a=e.width-r-t.width/2;if(r<n.width/2||e.width<n.width){var o=n.width/2-r;i.style.left="".concat(o,"px")}else if(a<n.width/2){var c=a-n.width/2+t.width/2;i.style.left="".concat(c,"px")}else i.style.left="50%"}},updateDuration:function(){var u=this,s=this.player.plugins.progress;if(s){var i=this._ispots;i.forEach(function(e){var t=s.find('xg-spot[data-id="'.concat(e.id,'"]'));u._updateDotDom(e,t)})}},getAllDotsDom:function(){var u=this.player.plugins.progress;if(!u)return[];var s=u.root.getElementsByTagName("xg-spot");return s},getDotDom:function(u){var s=this.player.plugins.progress;if(s)return s.find('xg-spot[data-id="'.concat(u,'"]'))}};function ba(l){var u=l.config,s=l.player;Object.keys(Bn).map(function(e){l[e]=Bn[e].bind(l)});var i=s.config.progressDot||u.ispots||[];l._ispots=i.map(function(e){return yr(e),e}),l.ispotsInit=!1,l.playerSize={left:s.sizeInfo.left,width:s.sizeInfo.width},l.on(Fe,function(){l.ispotsInit?l.updateDuration():l.initDots()}),l.on(Le,function(){l.positionDots()})}var ot={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseOver"},Er=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),b(T(e),"onMousemove",function(t){if(!e.config.disable){if(p.hasClass(t.target,"xg-spot-content")&&e.config.isHideThumbnailHover){e.player.plugins.progress.onMouseLeave(t);return}(e._state.f||p.hasClass(t.target,"xg-spot-content"))&&(p.event(t),t.stopPropagation())}}),b(T(e),"onMousedown",function(t){e.config.disable||(e._state.f||p.hasClass(t.target,"xg-spot-content"))&&(p.event(t),t.stopPropagation())}),b(T(e),"onMouseup",function(t){if(e.isDrag){var n=e.player.plugins.progress;n&&n.pos&&(n.onMouseUp(t),!n.pos.isEnter&&n.onMouseLeave(t))}}),b(T(e),"onDotMouseLeave",function(t){if(!e.config.disable){e._curDot.removeEventListener("mouseleave",e.onDotMouseLeave),e.blurDot(t.target),e._curDot=null;var n=e.player.plugins.progress;n&&n.enableBlur(),e.show()}}),b(T(e),"onProgressMouseOver",function(t,n){if(!e.config.disable&&p.hasClass(n.target,"xgplayer-spot")&&!e._curDot){e._curDot=n.target,e.focusDot(n.target),e._curDot.children.length>0&&e.hide();var r=e.player.plugins.progress;r&&r.disableBlur(),e._curDot.addEventListener("mouseleave",e.onDotMouseLeave)}}),e._ispots=[],e.videoPreview=null,e.videothumbnail=null,e.thumbnail=null,e.timeStr="",e._state={now:0,f:!1},e}return N(s,[{key:"beforeCreate",value:function(e){var t=e.player.plugins.progress;t&&(e.root=t.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(t,n){n.seekTime&&e.player.seek(n.seekTime)}),this.transformTimeHook=this.hook("transformTime",function(t){e.setTimeContent(p.format(t))}),ba(this),this.on(Fe,function(){e.show()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map(function(n){t.config[n]=e[n]})}},{key:"onPluginsReady",value:function(){var e=this.player;e.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this,t=this.player.plugins.progress;if(t&&(Object.keys(ot).map(function(r){e[ot[r]]=e[ot[r]].bind(e),t.addCallBack(r,e[ot[r]])}),X.device!=="mobile")){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var n=this.hook("previewClick",function(){});this.handlerPreviewClick=function(r){r.stopPropagation(),n(parseInt(e._state.now*1e3,10)/1e3,r),t&&t.onMouseUp(r)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(e,t){this.config.disable||!this.player.duration||this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!0,this.videoPreview&&p.addClass(this.videoPreview,"show"))}},{key:"onProgressDragEnd",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!1,this.videoPreview&&p.removeClass(this.videoPreview,"show"))}},{key:"onProgressClick",value:function(e,t){this.config.disable||p.hasClass(t.target,"xgplayer-spot")&&(t.stopPropagation(),t.preventDefault(),["time","id","text"].map(function(n){e[n]=t.target.getAttribute("data-".concat(n))}),e.time&&(e.time=Number(e.time)),this.handlerSpotClick(t,e))}},{key:"updateLinePos",value:function(e,t){var n=this.root,r=this.previewLine,a=this.player,o=this.config,c=a.controls.mode,h=c==="flex",g=n.getBoundingClientRect().width;if(!(!g&&this._hasThumnail)){g=this._hasThumnail&&g<o.width?o.width:g;var y=e-g/2,m;y<0&&!h?(y=0,m=e-g/2):y>t-g&&!h?(m=y-(t-g),y=t-g):m=0,m!==void 0&&(r.style.transform="translateX(".concat(m.toFixed(2),"px)")),n.style.transform="translateX(".concat(y.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(e){var t=this.timeText,n=this.timePoint;t.innerHTML=e,!this.thumbnail&&(n.innerHTML=e)}},{key:"updatePosition",value:function(e,t,n,r){var a=this.root,o=this.config,c=this._state;if(a){c.now=n,this.transformTimeHook(n);var h=this.timeStr;r&&r.target&&p.hasClass(r.target,"xgplayer-spot")?(this.showTips(r.target.getAttribute("data-text"),!1,h),this.focusDot(r.target),c.f=!0,o.isFocusDots&&c.f&&(c.now=parseInt(r.target.getAttribute("data-time"),10))):o.defaultText?(c.f=!1,this.showTips(o.defaultText,!0,h)):(c.f=!1,this.hideTips("")),this.updateTimeText(h),this.updateThumbnails(c.now),this.updateLinePos(e,t)}}},{key:"setTimeContent",value:function(e){this.timeStr=e}},{key:"updateThumbnails",value:function(e){var t=this.player,n=this.videoPreview,r=this.config,a=t.plugins.thumbnail;if(a&&a.usable){this.thumbnail&&a.update(this.thumbnail,e,r.width,r.height);var o=n&&n.getBoundingClientRect();this.videothumbnail&&a.update(this.videothumbnail,e,o.width,o.height)}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(X.device!=="mobile"){var t=this.player,n=this.config,r=t.getPlugin("thumbnail");if(r&&r.setConfig(e),!r||!r.usable||!n.isShowThumbnail){p.addClass(this.root,"short-line no-thumbnail");return}else p.removeClass(this.root,"short-line no-thumbnail");n.mode==="short"&&p.addClass(this.root,"short-line"),this._hasThumnail=!0;var a=this.find(".xg-spot-thumbnail");this.thumbnail=r.createThumbnail(a,"progress-thumbnail"),n.isShowCoverPreview&&(this.videoPreview=p.createDom("xg-video-preview","",{},"xgvideo-preview"),t.root.appendChild(this.videoPreview),this.videothumbnail=r.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}}},{key:"calcuPosition",value:function(e,t){var n=this.player.plugins.progress,r=this.player,a=n.root.getBoundingClientRect().width,o=r.duration/a*6;return e+t>r.duration&&(t=r.duration-e),e/r.duration*100,t/r.duration,{left:e/r.duration*100,width:t/r.duration*100,isMini:t<o}}},{key:"showDot",value:function(e){var t=this.findDot(e);if(t){var n=this.root.getBoundingClientRect(),r=n.width,a=t.time/this.player.duration*r;this.updatePosition(a,r,t.time)}}},{key:"focusDot",value:function(e,t){e&&(t||(t=e.getAttribute("data-id")),p.addClass(e,"active"),this._activeDotId=t)}},{key:"blurDot",value:function(e){if(!e){var t=this._activeDotId;e=this.getDotDom(t)}e&&(p.removeClass(e,"active"),this._activeDotId=null)}},{key:"showTips",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";p.addClass(this.root,"no-timepoint"),e&&(p.addClass(this.find(".xg-spot-content"),"show-text"),t&&this.config.mode==="production"?(p.addClass(this.root,"product"),this.tipText.textContent=e):(p.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?e:"".concat(n," ").concat(e)))}},{key:"hideTips",value:function(){p.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",p.removeClass(this.find(".xg-spot-content"),"show-text"),p.removeClass(this.root,"product")}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"enable",value:function(){var e=this.config,t=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&e.isShowThumbnail&&this.registerThumbnail(t.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var e=this,t=this.player.plugins.progress;t&&Object.keys(ot).map(function(n){t.removeCallBack(n,e[ot[n]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return X.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",`">
      <div class="xg-spot-content">
        <div class="xg-spot-thumbnail">
          <span class="xg-spot-time"></span>
        </div>
        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>
      </div>
      <div class="xgplayer-progress-point">00:00</div>
      <div class="xg-spot-ext-text"></div>
      <div class="xg-spot-line"></div>
    </div>`)}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90}}}]),s}(q),Yi=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.ratio=1,e.interval=null,e._preloadMark={},e}return N(s,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([Fe],function(){var t=e.config,n=t.pic_num,r=t.interval;e.usable&&(e.interval=r>0?r:Math.round(e.player.duration*1e3/n)/1e3)})}},{key:"setConfig",value:function(e){var t=this;if(e){var n=Object.keys(e);n.length<1||(n.forEach(function(r){t.config[r]=e[r]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var e=this.config,t=e.urls,n=e.pic_num;return t&&t.length>0&&n>0}},{key:"initThumbnail",value:function(){var e=this.config,t=e.width,n=e.height,r=e.pic_num,a=e.interval;this.ratio=t/n*100,this.interval=a||Math.round(this.player.duration/r),this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var t=this;if(!this._preloadMark[e]){var n=this.config.urls,r=n.length,a=[];e>0&&a.push(e-1),a.push(e),e>0&&e<r-1&&a.push(e+1),a.map(function(o){!t._preloadMark[o]&&o>=0&&o<r&&(t._preloadMark[o]=1,p.preloadImg(n[o],function(){t._preloadMark[o]=2}))})}}},{key:"getPosition",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=this.config,a=r.pic_num,o=r.row,c=r.col,h=r.width,g=r.height;this.interval=Math.round(this.player.duration/a);var y=Math.ceil(e/this.interval);y=y>a?a:y;var m=y<o*c?0:Math.ceil(y/(o*c))-1,_=y-m*(c*o),C=_>0?Math.ceil(_/c)-1:0,D=_>0?_-C*c-1:0,A=0,O=0;if(t&&n){var H=t/n;H<h/g?(O=n,A=O*(h/g)):(A=t,O=A/(h/g))}else n?t||(O=n||g,A=O*(h/g)):(A=t||h,O=A/(h/g));var K=this.getUrlByIndex(m);return{urlIndex:m,rowIndex:C,colIndex:D,url:K,height:O,width:A,style:{backgroundImage:"url(".concat(K,")"),backgroundSize:"".concat(A*c,"px auto"),backgroundPosition:"-".concat(D*A,"px -").concat(C*O,"px"),width:"".concat(A,"px"),height:"".concat(O,"px")}}}},{key:"update",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",o=this.config,c=o.pic_num,h=o.urls;if(!(c<=0||!h||h.length===0)){var g=this.getPosition(t,n,r);this.preload(g.urlIndex),Object.keys(g.style).map(function(y){e.style[y]=g.style[y]}),Object.keys(a).map(function(y){e.style[y]=a[y]})}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,t){var n=p.createDom("xg-thumbnail","",{},"thumbnail ".concat(t));return e&&e.appendChild(n),n}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),s}(q);function yi(l){return l?"background:".concat(l,";"):""}var Xi=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onTimeupdate",function(){var r=i.player.ended,a=T(i),o=a.offsetDuration,c=i.currentTime;c=p.adjustTimeByDuration(c,o,r),i.update({played:c},o)}),i}return N(s,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,n=e.currentTime;return t>=0?t:n}},{key:"afterCreate",value:function(){var e=this;this.root&&(this.on(_e,this.onTimeupdate),this.on(mt,function(){e.reset()}))}},{key:"reset",value:function(){this.update({played:0,cached:0},0)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;!t||!this.root||(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/t*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/t*100,"%")))}},{key:"render",value:function(){var e=this.playerConfig,t=e.commonStyle,n=e.miniprogress;if(n){var r=this.config,a=r.mode,o=r.height,c={cached:yi(t.cachedColor),played:yi(t.playedColor),progress:yi(t.progressColor),height:o>0&&o!==2?"height: ".concat(o,"px;"):""},h=a==="show"?"xg-mini-progress-show":"";return'<xg-mini-progress class="xg-mini-progress '.concat(h,'" style="').concat(c.progress," ").concat(c.height,`">
    <xg-mini-progress-cache class="xg-mini-progress-cache" style="`).concat(c.cached,`"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played" style="`).concat(c.played,`"></xg-mini-progress-played>
    </xg-mini-progress>`)}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{mode:"auto",height:2}}}]),s}(q),ut={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate",POSTER:"poster"};function Sa(){try{return parseInt(window.performance.now(),10)}catch{return new Date().getTime()}}function Aa(){try{var l=document.createElement("canvas").getContext;return!!l}catch{return!1}}var Ht=null,_r=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onLoadedData",function(r){i.player&&(i._frameCount=i.config.startFrameCount,i.stop(),i.renderOnTimeupdate(r),i.off(_e,i.renderOnTimeupdate),i.on(_e,i.renderOnTimeupdate))}),b(T(i),"onVisibilitychange",function(r){document.visibilityState==="visible"?i._checkIfCanStart()&&i.start():document.visibilityState==="hidden"&&i.stop()}),b(T(i),"renderOnTimeupdate",function(r){if(i._frameCount>0)i.renderOnce(),i._frameCount--;else{i._isLoaded=!0,i.off(_e,i.renderOnTimeupdate);var a=i.config.startInterval;!i.player.paused&&i._checkIfCanStart()&&i.start(0,a)}}),b(T(i),"start",function(r,a){var o=i.player.video,c=Sa(),h=i.checkVideoIsSupport(o);!h||!i.canvasCtx||(a||(a=i.interval),i.stop(),o.videoWidth&&o.videoHeight&&(i.videoPI=o.videoHeight>0?parseInt(o.videoWidth/o.videoHeight*100,10):0,(i.config.mode===ut.REAL_TIME||c-i.preTime>=a)&&(o&&o.videoWidth&&i.update(h,i.videoPI),i.preTime=c)),i.frameId=i._loopType==="timer"?p.setTimeout(T(i),i.start,a):p.requestAnimationFrame(i.start))}),b(T(i),"stop",function(){i.frameId&&(i._loopType==="timer"?p.clearTimeout(T(i),i.frameId):p.cancelAnimationFrame(i.frameId),i.frameId=null)}),i}return N(s,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.dynamicBg===!0&&(this.config.disable=!1),s.isSupport||(this.config.disable=!0);var t=this.config,n=t.disable,r=t.mode,a=t.frameRate;n||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/a,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this._loopType=this.config.mode!==ut.REAL_TIME&&this.interval>=1e3?"timer":"animation",this.once(Li,function(){e.player&&(e.init(),e.renderByPoster(),e.player.paused||e.start())}),r!==ut.POSTER&&(r!==ut.FIRST_FRAME&&(this.on(mt,function(){e.stop()}),this.on(Ce,function(){var o=e.config.startInterval;e._checkIfCanStart()&&e.start(0,o)}),this.on(vt,function(){e.stop()})),this.on($e,this.onLoadedData),this.on(hr,function(){e._isLoaded=!1,e.stop()}),document.addEventListener("visibilitychange",this.onVisibilitychange)))}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(n){n==="root"&&e[n]!==t.config[n]?t.reRender(e[n]):n==="frameRate"?t.interval=parseInt(1e3/e[n],10):n==="disable"&&e[n]&&t.stop(),t.config[n]=e[n]})}},{key:"init",value:function(e){var t=this.player,n=this.config;this.canvasFilter=s.supportCanvasFilter();try{var r=e||n.root;r||(r=n.isInnerRender&&t.innerContainer||t.root),r.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(n.index,`"><canvas>
        </canvas><xgmask></xgmask></div>`)),this.root=r.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=n.filter,this.canvas.style.webkitFilter=n.filter),this.mask=this.find("xgmask"),n.addMask&&(this.mask.style.background=n.maskBg),this.canvasCtx=this.canvas.getContext("2d")}catch(a){ie.logError("plugin:DynamicBg",a)}}},{key:"reRender",value:function(e){var t=this.config.disable;if(!(!t&&!this.root)){this.stop();var n=this.root?this.root.parentElement:null;if(n!==e&&n.removeChild(this.root),!e){this.root=null;return}this.init(e),this.renderOnce();var r=this.config.startInterval;this._checkIfCanStart()&&this.start(0,r)}}},{key:"checkVideoIsSupport",value:function(e){if(!e)return null;var t=e&&e instanceof window.HTMLVideoElement?e:e.canvas?e.canvas:e.flyVideo?e.flyVideo:null;if(t&&!(X.browser==="safari"&&p.isMSE(t)))return t;var n=t?t.tagName.toLowerCase():"";return n==="canvas"||n==="img"?t:null}},{key:"renderByPoster",value:function(){var e=this.playerConfig.poster;if(e){var t=p.typeOf(e)==="String"?e:p.typeOf(e.poster)==="String"?e.poster:null;this.updateImg(t)}}},{key:"_checkIfCanStart",value:function(){var e=this.config.mode;return this._isLoaded&&!this.player.paused&&e!==ut.FIRST_FRAME&&e!==ut.POSTER}},{key:"renderOnce",value:function(){var e=this.player.video;if(!(!e.videoWidth||!e.videoHeight)){this.videoPI=parseInt(e.videoWidth/e.videoHeight*100,10);var t=this.checkVideoIsSupport(e);t&&this.update(t,this.videoPI)}}},{key:"updateImg",value:function(e){var t=this;if(e){var n=this.canvas.getBoundingClientRect(),r=n.width,a=n.height,o=new window.Image;o.onload=function(){if(!(!t.canvas||t.frameId||t.isStart)){t.canvas.height=a,t.canvas.width=r;var c=parseInt(r/a*100,10);t.update(o,c),o=null}},o.src=e}}},{key:"update",value:function(e,t){if(!(!this.canvas||!this.canvasCtx||!t))try{var n=this._pos,r=this.config,a=this.canvas.getBoundingClientRect(),o=a.width,c=a.height;if(o!==n.width||c!==n.height||n.pi!==t){var h=parseInt(o/c*100,10);n.pi=t,n.width!==o&&(n.width=this.canvas.width=o),n.height!==c&&(n.height=this.canvas.height=c);var g=c,y=o;h<t?y=parseInt(c*t/100,10):h>t&&(g=parseInt(o*100/t,10)),n.rwidth=y*r.multiple,n.rheight=g*r.multiple,n.x=(o-n.rwidth)/2,n.y=(c-n.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=r.filter),this.canvasCtx.drawImage(e,n.x,n.y,n.rwidth,n.rheight)}catch(m){ie.logError("plugin:DynamicBg",m)}}},{key:"destroy",value:function(){this.stop(),document.removeEventListener("visibilitychange",this.onVisibilitychange),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return typeof Ht=="boolean"||(Ht=Aa()),Ht}},{key:"supportCanvasFilter",value:function(){return!(X.browser==="safari"||X.browser==="firefox")}}]),s}(q),$i={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}},Ct="info",Ei=vs,Cr=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_recordUserActions",function(r){var a=i._getTime(),o=Object.assign({},r,{msg:r.msg||r.action});i._stats[Ct].push(se(se({type:"userAction"},a),{},{payload:o}))}),b(T(i),"_onReset",function(){i.reset()}),b(T(i),"_recordInfo",function(r){i.info(r)}),b(T(i),"_downloadStats",function(){var r=i.getStats(),a=new Blob([JSON.stringify(r)],{type:"application/json"}),o=window.URL.createObjectURL(a),c=document.createElement("a");c.style.display="none",c.href=o,c.download="player.txt",c.disabled=!1,c.click()}),i}return N(s,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(Ai,this._recordUserActions),this.on(Ei.STATS_INFO,this._recordInfo),this.on(Ei.STATS_DOWNLOAD,this._downloadStats),this.on(Ei.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var t=this._getTime();this._stats[Ct].push(se(se({},t),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var t=Date.now(),n=t-e.startMs,r=se({cat:"function",dur:n,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:!0},e);this._info(r)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var e;this._stats=(e={},b(e,Ct,[]),b(e,"media",{}),e)}},{key:"getStats",value:function(){for(var e=this.player,t=e.media,n=[],r=0;r<t.buffered.length;r++)n.push({start:t.buffered.start(r),end:t.buffered.end(r)});var a={currentTime:t.currentTime,readyState:t.readyState,buffered:n,paused:t.paused,ended:t.ended};return this._stats.media=a,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){var e=this._stats[Ct],t=e.map(function(n){var r=n.payload.data,a="";try{r instanceof Error?a=r.msg:r!==void 0&&(a=JSON.stringify(r))}catch(o){console.log("err",o)}return"[".concat(n.timeFormat,"] : ").concat(n.payload.msg," ").concat(a," ")});return t}},{key:"_getProfile",value:function(){var e={traceEvents:[]},t=this._stats[Ct];return t.forEach(function(n){n.payload.profile&&e.traceEvents.push(n.payload)}),e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),s}(Xe),qi=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onGapJump",function(){var r=T(i),a=r.player,o=r.config;if(a.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(a.media.seeking){if(!i.seekingEventReceived)return}else i.seekingEventReceived=!1;if(!(a.media.paused&&a.media.currentTime!==0&&i.hasPlayed)){var c=a.media.buffered,h=o.smallGapLimit||.5,g=o.gapDetectionThreshold||.3,y=a.media.currentTime,m=i._getIndex(c,y,g);if(!(m===null||m===0)){console.log("GapJump  bufferRange ",c.start(m),c.end(m));var _=c.start(m)+.1,C=a.media.duration;if(!(_>C)){var D=_-y,A=D<=h;D<s.BROWSER_GAP_TOLERANCE||A&&(o.useGapJump!==!1&&(a.media.currentTime=i.isSafari?_+.1:_),i.player&&i.player.emit("detectGap"),console.log("gapJump gapIndex",m," isGapSamll:",A," currentTime:",a.media.currentTime," jumpSize:",y-a.media.currentTime),_!==.08&&a&&a.emit("log",{type:"oneevent",end_type:"gap",vid:a.config.vid,ext:{video_postion:Math.floor(_*1e3)}}))}}}}}),i}return N(s,[{key:"afterCreate",value:function(){var e=this,t=this.config.useGapJump;t!==!1&&(this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(Wt,this.onGapJump),this.on(Ce,function(){e.hasPlayed=!0}),this.on(Yt,function(){e.seekingEventReceived=!0}))}},{key:"_getIndex",value:function(e,t,n){if(!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6)return null;for(var r=this._getBuffered(e),a=null,o=0;o<r.length;o++){var c=r[o];if(c.start>t&&(o===0||r[o-1].end-t<=n)){a=o;break}}return a}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}]),s}(q);qi.BROWSER_GAP_TOLERANCE=.001;var Tr=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"onWaiting",function(){var r=T(i),a=r.config;i.jumpCnt>a.jumpCntMax||i.timer||a.useWaitingTimeoutJump===!1||(i.timer=setTimeout(i.onJump,a.waitingTime*1e3))}),b(T(i),"onJump",function(){var r=T(i),a=r.player,o=r.config;if(clearTimeout(i.timer),i.timer=null,!(i.jumpCnt>o.jumpCntMax||o.useWaitingTimeoutJump===!1)&&!(a.media.paused&&a.media.currentTime!==0&&i.hasPlayed)){i.jumpSize=o.jumpSize*(i.jumpCnt+1),i.jumpCnt===o.jumpSize&&i.jumpSize<6&&(i.jumpSize=6);var c=a.currentTime+i.jumpSize,h=a.media.duration;c>h||(i.jumpCnt++,a.currentTime=c)}}),i}return N(s,[{key:"afterCreate",value:function(){var e=this,t=this.config,n=t.useWaitingTimeoutJump,r=t.jumpSize;n!==!1&&(this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=r,this.on(Wt,this.onWaiting),this.on([fr,Ke],function(){clearTimeout(e.timer),e.timer=null,e.jumpSize=e.config.jumpSize}),this.on(Ce,function(){e.hasPlayed=!0}))}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]),s}(q),lt="cdn",Ut=["cdn"],kr=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"getSpeed",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lt;if(!i.speedListCache||!i.speedListCache[r]||i.speedListCache[r].length<=0)return 0;var a=0;return i.speedListCache[r].map(function(o){a+=o}),Math.floor(a/i.speedListCache[r].length)}),b(T(i),"startTimer",function(){p.isMSE(i.player.video)||(i.initSpeedList(),i.cnt=0,i.timer=setTimeout(i.testSpeed,i.config.testTimeStep))}),b(T(i),"initSpeedList",function(){i.speedListCache={},Ut.forEach(function(r){i.speedListCache[r]=[]})}),b(T(i),"_onRealSpeedChange",function(r){r.speed&&i.appendList(r.speed,r.type||lt)}),b(T(i),"testSpeed",function(){if(clearTimeout(i.timer),i.timer=null,!(!i.player||!i.config.openSpeed)){var r=i.config,a=r.url,o=r.loadSize,c=r.testCnt,h=r.testTimeStep,g=a+(a.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(i.cnt>=c)){i.cnt++;try{var y=new Date().getTime(),m=null,_=new XMLHttpRequest;i.xhr=_,_.open("GET",g);var C={},D=Math.floor(Math.random()*10);C.Range="bytes="+D+"-"+(o+D),C&&Object.keys(C).forEach(function(A){_.setRequestHeader(A,C[A])}),_.onreadystatechange=function(){if(_.readyState===4){i.xhr=null,m=new Date().getTime();var A=_.getResponseHeader("Content-Length")/1024*8,O=Math.round(A*1e3/(m-y));i.appendList(O),i.timer=setTimeout(i.testSpeed,h)}},_.send()}catch(A){console.error(A)}}}}),b(T(i),"appendList",function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt;if(!(!i.speedListCache||!i.speedListCache[a])){var o=i.config.saveSpeedMax;i.speedListCache[a].length>=o&&i.speedListCache[a].shift(),i.speedListCache[a].push(r);var c=T(i),h=c.player;h&&(a===lt?h.realTimeSpeed=r:h[i.getSpeedName("realTime",a)]=r),i.updateSpeed(a)}}),b(T(i),"updateSpeed",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lt,a=i.getSpeed(r),o=T(i),c=o.player;if(c)if(r===lt)(!c.avgSpeed||a!==c.avgSpeed)&&(c.avgSpeed=a,c.emit(vn,{speed:a,realTimeSpeed:c.realTimeSpeed}));else{var h=i.getSpeedName("avg",r);(!c[h]||a!==c[h])&&(c[h]=a,c.emit(vn,{speed:a,realTimeSpeed:c.realTimeSpeed}))}}),i}return N(s,[{key:"afterCreate",value:function(){var e=this.config,t=e.openSpeed,n=e.addSpeedTypeList;(n==null?void 0:n.length)>0&&Ut.push.apply(Ut,Pe(n)),this.initSpeedList(),this.on("real_time_speed",this._onRealSpeedChange),this.timer=null,this.cnt=0,this.xhr=null,t&&this.on([$e,Di],this.startTimer)}},{key:"getSpeedName",value:function(e,t){return e+"Speed"+t.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(e){if(this.config.openSpeed=e,!e&&this.timer){clearTimeout(this.timer),this.timer=null;return}if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){var e=this;this.off("real_time_speed",this._onRealSpeedChange),this.off([$e,Di],this.startTimer),Ut.forEach(function(t){e.speedListCache&&e.speedListCache[t]&&(e.speedListCache[t]=[])}),this.speedListCache&&(this.speedListCache={}),clearTimeout(this.timer),this.timer=null,this.xhr&&this.xhr.readyState!==4&&(this.xhr.cancel&&this.xhr.cancel(),this.xhr=null)}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:200*1024,testTimeStep:3e3,url:"",saveSpeedMax:5,addSpeedTypeList:[]}}}]),s}(q),br=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){var e=this,t=this.player,n=this.config,r=t.media||t.video;if(this.timer=null,this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,this._payload=[],!n.disabled){var a=r.getVideoPlaybackQuality;a&&(this.on(Ce,function(){e._startTick()}),this.on(vt,function(){e._stopTick()}),this.on(yt,function(){e._stopTick()}),this.on(mt,function(){e._stopTick()}))}}},{key:"_startTick",value:function(){var e=this;this._stopTick(),this._timer=setTimeout(function(){e._checkDecodeFPS(),e._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkBuffer",value:function(e,t){for(var n=!1,r=[],a=0;a<t.length;a++){var o=t.start(a),c=t.end(a);if(r.push({start:o,end:c}),o<=e&&e<=c-1){n=!0;break}}return{enoughBuffer:n,buffers:r}}},{key:"_checkStuck",value:function(e,t,n,r){var a=this.player.media||this.player.video,o=document.hidden,c=a.paused,h=a.readyState,g=a.currentTime,y=a.buffered;if(!(o||c||h<4)){var m=this._checkBuffer(g,y),_=m.enoughBuffer,C=m.buffers;_&&(e<=this.config.reportFrame?(this._currentStuckCount++,this._payload.push({currentTime:g,buffers:C,curDecodedFrames:e,totalVideoFrames:t,droppedVideoFrames:n,checkInterval:r}),this._currentStuckCount>=this.config.stuckCount&&(this.emit(ms,this._payload),this._reset())):this._reset())}}},{key:"_reset",value:function(){this._payload=[],this._currentStuckCount=0}},{key:"_checkDecodeFPS",value:function(){var e=this.player.media||this.player.video;if(e){var t=e.getVideoPlaybackQuality(),n=t.totalVideoFrames,r=t.droppedVideoFrames,a=performance.now();if(n&&this._lastCheckPoint){var o=n-this._lastDecodedFrames,c=a-this._lastCheckPoint;this._checkStuck(o,n,r,c)}this._lastDecodedFrames=n,this._lastCheckPoint=a}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}]),s}(q);ct.use($i);var xa=N(function l(u,s){var i,e,t;F(this,l);var n=s&&s.isMobileSimulateMode==="mobile",r=s.isLive,a=r?[]:[ga,$t,Xi,Er,Dt],o=[].concat(a,[xt,At,ti,zi,ni,ri,Wi,Gi,It,ii]),c=[ji,qt,Zt,ei,Jt,si,Ki,Yi,vr];this.plugins=[Cr,Ui].concat(Pe(o),c,[qi,Tr]);var h=n?"mobile":X.device;switch(h){case"pc":(i=this.plugins).push.apply(i,[gt,et,dt,kr,br]);break;case"mobile":(e=this.plugins).push.apply(e,[Qt]);break;default:(t=this.plugins).push.apply(t,[gt,et,dt])}(X.os.isIpad||h==="pc")&&this.plugins.push(_r),X.os.isIpad&&this.plugins.push(et),this.ignores=[],this.i18n=[]}),de=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s)}(Xt);b(de,"defaultPreset",xa);b(de,"Util",p);b(de,"Sniffer",X);b(de,"Errors",zt);b(de,"Events",ys);b(de,"Plugin",q);b(de,"BasePlugin",Xe);b(de,"I18N",ct);b(de,"STATE_CLASS",w);b(de,"InstManager",gr);b(de,"PlayIcon",xt);b(de,"TimeIcon",Dt);b(de,"Progress",$t);b(de,"FullscreenIcon",At);b(de,"CssFullscreenIcon",dt);b(de,"VolumeIcon",It);var io=N(function l(u,s){var i,e,t;F(this,l);var n=s&&s.isMobileSimulateMode==="mobile",r=s.isLive,a=r?[]:[$t,Xi,Er,Dt],o=[].concat(a,[xt,At,ti,zi,ni,ri,Wi,Gi,It,ii]),c=[ji,qt,Zt,ei,Jt,si,Ki,Yi,vr];this.plugins=[Cr,Ui].concat(Pe(o),c,[qi,Tr]);var h=n?"mobile":X.device;switch(h){case"pc":(i=this.plugins).push.apply(i,[gt,et,dt,kr,br]);break;case"mobile":(e=this.plugins).push.apply(e,[Qt]);break;default:(t=this.plugins).push.apply(t,[gt,et,dt])}(X.os.isIpad||h==="pc")&&this.plugins.push(_r),this.ignores=[],this.i18n=[]}),no=N(function l(){var u,s;F(this,l);var i=[xt,At,Dt,It,ti,ni,ri,dt,ii];switch(this.plugins=[qt,Zt,ei,Jt,si].concat(i),X.device){case"pc":(u=this.plugins).push.apply(u,[gt,et]);break;case"mobile":this.plugins.push(Qt);break;default:(s=this.plugins).push.apply(s,[gt,et])}this.ignores=[],this.i18n=[$i]}),ro=N(function l(){F(this,l);var u=[Qt,$t,xt,At,Dt,ti,zi,ni,ri,Wi,Gi,It,ii],s=[ji,qt,Zt,ei,Jt,si,Ki,Yi,Xi];this.plugins=[Ui].concat(u,s),this.ignores=[],this.i18n=[$i]}),so={LANG:"zh-hk",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}},ao={LANG:"jp",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/ ",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/ ",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH:"",REFRESH_TIPS:"",FORWARD:"",LIVE_TIP:""}},oo={LANG:"br",TEXT:{ERROR_TYPES:{network:{code:1,msg:"erro de download de vdeo"},mse:{code:2,msg:"erro de anexao de fluxo"},parse:{code:3,msg:"erro de anlise"},format:{code:4,msg:"formato incorreto"},decoder:{code:5,msg:"erro de decodificao"},runtime:{code:6,msg:"erros gramaticais"},timeout:{code:7,msg:"tempo limite de reproduo"},other:{code:8,msg:"outros erros"}},HAVE_NOTHING:"No h informaes sobre se o udio/vdeo est pronto",HAVE_METADATA:"Os metadados de udio/vdeo esto prontos ",HAVE_CURRENT_DATA:"Os dados sobre a localizao de reproduo atual esto disponveis, mas no h dados suficientes para reproduzir o prximo quadro/milissegundo",HAVE_FUTURE_DATA:"Atual e pelo menos um quadro de dados est disponvel",HAVE_ENOUGH_DATA:"Os dados disponveis so suficientes para comear a jogar",NETWORK_EMPTY:"O udio/vdeo no foi inicializado",NETWORK_IDLE:"O udio/vdeo est ativo e foi selecionado para recursos, mas nenhuma rede est sendo usada",NETWORK_LOADING:"O navegador est baixando os dados",NETWORK_NO_SOURCE:"Nenhuma fonte de udio/vdeo foi encontrada",MEDIA_ERR_ABORTED:"O processo de busca  abortado pelo usurio",MEDIA_ERR_NETWORK:"Ocorreu um erro durante o download",MEDIA_ERR_DECODE:"Ocorreu um erro durante a decodificao",MEDIA_ERR_SRC_NOT_SUPPORTED:"No h suporte para udio/vdeo",REPLAY:"Repetir",ERROR:"A rede est offline",PLAY_TIPS:"Reproduzir",PAUSE_TIPS:"Pausar",PLAYNEXT_TIPS:"Reproduzir prximo",DOWNLOAD_TIPS:"Baixar",ROTATE_TIPS:"Girar",RELOAD_TIPS:"Recarregar",FULLSCREEN_TIPS:"Tela cheia",EXITFULLSCREEN_TIPS:"Sair da tela cheia",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Sair da cssfullscreen",TEXTTRACK:"Legenda",PIP:"PIP",SCREENSHOT:"Captura de tela",LIVE:"AO VIVO",OFF:"Desligado",OPEN:"Abrir",MINI_DRAG:"Clique e segure para arrastar",MINISCREEN:"Minitela",REFRESH_TIPS:"Tente",REFRESH:"Atualizar",FORWARD:"encaminhar",LIVE_TIP:"Ao vivo"}},uo={LANG:"de",TEXT:{ERROR_TYPES:{network:{code:1,msg:"Fehler beim Herunterladen des Videos"},mse:{code:2,msg:"Fehler beim Anhngen des Streams"},parse:{code:3,msg:"Fehler beim Parsen"},format:{code:4,msg:"falsches Format"},decoder:{code:5,msg:"Dekodierungsfehler"},runtime:{code:6,msg:"grammatikalische Fehler"},timeout:{code:7,msg:"Wiedergabeunterbrechung"},other:{code:8,msg:"andere Fehler"}},HAVE_NOTHING:"Es sind keine Informationen darber vorhanden, ob Audio/Video wiedergabebereit ist",HAVE_METADATA:"Audio-/Video-Metadaten knnen genutzt werden ",HAVE_CURRENT_DATA:"Es sind Daten ber die aktuelle Wiedergabeposition verfgbar, jedoch reichen diese nicht aus, um den nchsten Frame / die nchste Millisekunde wiederzugeben",HAVE_FUTURE_DATA:"Das aktuelle und mindestens ein Datenframe ist verfgbar",HAVE_ENOUGH_DATA:"Die verfgbaren Daten reichen aus, um die Wiedergabe zu starten",NETWORK_EMPTY:"Audio/Video wurde nicht initialisiert",NETWORK_IDLE:"Audio/Video ist aktiv und wurde fr die Ressourcen ausgewhlt, aber es wird kein Netzwerk verwendet",NETWORK_LOADING:"Der Browser ldt die Daten herunter",NETWORK_NO_SOURCE:"Keine Audio-/Videoquelle gefunden",MEDIA_ERR_ABORTED:"Der Abrufvorgang wurde vom Benutzer abgebrochen",MEDIA_ERR_NETWORK:"Beim Herunterladen ist ein Fehler aufgetreten",MEDIA_ERR_DECODE:"Bei der Entschlsselung ist ein Fehler aufgetreten",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/Video wird nicht untersttzt",REPLAY:"Erneute Wiedergabe",ERROR:"Das Netzwerk ist offline",PLAY_TIPS:"Wiedergabe",PAUSE_TIPS:"Anhalten",PLAYNEXT_TIPS:"Nchstes wiedergeben",DOWNLOAD_TIPS:"Herunterladen",ROTATE_TIPS:"Drehen",RELOAD_TIPS:"Neu laden",FULLSCREEN_TIPS:"Vollbildschirm",EXITFULLSCREEN_TIPS:"Vollbildschirm beenden",CSSFULLSCREEN_TIPS:"CSS-Vollbildschirm",EXITCSSFULLSCREEN_TIPS:"CSS-Vollbildschirm beenden",TEXTTRACK:"Beschriftung",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Aus",OPEN:"ffnen",MINI_DRAG:"Klicken und zum Ziehen halten",MINISCREEN:"Miniaturbildschirm",REFRESH_TIPS:"Bitte versuchen",REFRESH:"Aktualisieren",FORWARD:"weiterleiten",LIVE_TIP:"Live"}},lo={LANG:"es",TEXT:{ERROR_TYPES:{network:{code:1,msg:"error de descarga de vdeo"},mse:{code:2,msg:"error al aadir emisin"},parse:{code:3,msg:"error de anlisis"},format:{code:4,msg:"formato incorrecto"},decoder:{code:5,msg:"error de descodificacin"},runtime:{code:6,msg:"errores gramaticales"},timeout:{code:7,msg:"tiempo de espera de reproduccin agotado"},other:{code:8,msg:"otros errores"}},HAVE_NOTHING:"No hay informacin sobre si el audio o el vdeo estn listos",HAVE_METADATA:"Los metadatos de audio o vdeo estn listos ",HAVE_CURRENT_DATA:"Los datos sobre la ubicacin de reproduccin actual estn disponibles, pero no hay suficientes datos para reproducir el siguiente marco/milisegundo",HAVE_FUTURE_DATA:"El marco de datos actual y al menos uno ms estn disponibles",HAVE_ENOUGH_DATA:"Los datos disponibles son suficientes para iniciar la reproduccin",NETWORK_EMPTY:"El audio o el vdeo no se han iniciado",NETWORK_IDLE:"El audio o el vdeo estn activos y se han seleccionado para los recursos, pero no se utiliza ninguna red",NETWORK_LOADING:"El navegador est descargando los datos",NETWORK_NO_SOURCE:"No se ha encontrado ninguna fuente de audio o vdeo",MEDIA_ERR_ABORTED:"El usuario ha cancelado el proceso de recuperacin",MEDIA_ERR_NETWORK:"Se ha producido un error al descargar",MEDIA_ERR_DECODE:"Se ha producido un error al descodificar",MEDIA_ERR_SRC_NOT_SUPPORTED:"El audio o el vdeo no son compatibles",REPLAY:"Volver a reproducir",ERROR:"La red est fuera de lnea",PLAY_TIPS:"Reproducir",PAUSE_TIPS:"Pausar",PLAYNEXT_TIPS:"Reproducir siguiente",DOWNLOAD_TIPS:"Descargar",ROTATE_TIPS:"Girar",RELOAD_TIPS:"Cargar de nuevo",FULLSCREEN_TIPS:"Pantalla completa",EXITFULLSCREEN_TIPS:"Salir de la pantalla completa",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Salir de cssfullscreen",TEXTTRACK:"Subttulo",PIP:"PIP",SCREENSHOT:"Captura de pantalla",LIVE:"EN DIRECTO",OFF:"Desactivado",OPEN:"Abrir",MINI_DRAG:"Haz clic y mantn pulsado para arrastrar",MINISCREEN:"Minipantalla",REFRESH_TIPS:"Intntalo",REFRESH:"Volver a cargar",FORWARD:"reenviar",LIVE_TIP:"En directo"}},co={LANG:"fr",TEXT:{ERROR_TYPES:{network:{code:1,msg:"erreur de tlchargement vido"},mse:{code:2,msg:"erreur d'ajout du stream"},parse:{code:3,msg:"erreur d'analyse"},format:{code:4,msg:"format erron"},decoder:{code:5,msg:"erreur de dcodage"},runtime:{code:6,msg:"erreurs grammaticales"},timeout:{code:7,msg:"lecture expire"},other:{code:8,msg:"autres erreurs"}},HAVE_NOTHING:"Il n'y a pas d'information sur la disponibilit de l'audio/vido",HAVE_METADATA:"Les mtadonnes audio/vido sont prtes ",HAVE_CURRENT_DATA:"Les donnes relatives  l'emplacement de lecture actuel sont disponibles, mais les donnes ne sont pas suffisantes pour lire l'image/la milliseconde suivante",HAVE_FUTURE_DATA:"Trame de donnes actuelles (au moins une) disponible",HAVE_ENOUGH_DATA:"Les donnes disponibles sont suffisantes pour dmarrer la lecture",NETWORK_EMPTY:"L'audio/vido n'a pas t initialis",NETWORK_IDLE:"L'audio/vido est actif et a t slectionn comme ressource, mais aucun rseau n'est utilis",NETWORK_LOADING:"Le navigateur tlcharge les donnes",NETWORK_NO_SOURCE:"Aucune source audio/vido n'a t trouve",MEDIA_ERR_ABORTED:"Le processus de recherche est interrompu par l'utilisateur",MEDIA_ERR_NETWORK:"Une erreur s'est produite lors du tlchargement",MEDIA_ERR_DECODE:"Une erreur s'est produite lors du dcodage",MEDIA_ERR_SRC_NOT_SUPPORTED:"L'audio/vido n'est pas pris en charge",REPLAY:"Relancer",ERROR:"Le rseau est hors ligne",PLAY_TIPS:"Lire",PAUSE_TIPS:"Mettre en pause",PLAYNEXT_TIPS:"Lire l'lment suivant",DOWNLOAD_TIPS:"Tlcharger",ROTATE_TIPS:"Pivoter",RELOAD_TIPS:"Actualiser",FULLSCREEN_TIPS:"Plein cran",EXITFULLSCREEN_TIPS:"Quitter le plein cran",CSSFULLSCREEN_TIPS:"Plein cran css",EXITCSSFULLSCREEN_TIPS:"Quitter le plein cran css",TEXTTRACK:"Lgende",PIP:"PIP",SCREENSHOT:"Capture d'cran",LIVE:"EN DIRECT",OFF:"Dsactiv",OPEN:"Ouvrir",MINI_DRAG:"Cliquer et maintenir pour faire glisser",MINISCREEN:"Mini cran",REFRESH_TIPS:"Essayez",REFRESH:"Actualiser",FORWARD:"transfrer",LIVE_TIP:"En direct"}},ho={LANG:"id",TEXT:{ERROR_TYPES:{network:{code:1,msg:"kesalahan unduh video"},mse:{code:2,msg:"kesalahan penambahan stream"},parse:{code:3,msg:"kesalahan penguraian"},format:{code:4,msg:"format salah"},decoder:{code:5,msg:"kesalahan dekode"},runtime:{code:6,msg:"kesalahan tata bahasa"},timeout:{code:7,msg:"waktu pemutaran habis"},other:{code:8,msg:"kesalahan lainnya"}},HAVE_NOTHING:"Tidak ada informasi mengenai apakah audio/video sudah siap",HAVE_METADATA:"Metadata audio/video siap ",HAVE_CURRENT_DATA:"Data mengenai lokasi pemutaran saat ini tersedia, tetapi data tidak cukup untuk memutar bingkai berikutnya/milidetik",HAVE_FUTURE_DATA:"Data saat ini dan setidaknya satu bingkai data tersedia",HAVE_ENOUGH_DATA:"Data yang tersedia cukup untuk mulai memutar",NETWORK_EMPTY:"Audio/video belum diinisialisasi",NETWORK_IDLE:"Audio/video sedang aktif dan telah dipilih untuk sumber daya, tetapi tidak ada jaringan yang digunakan",NETWORK_LOADING:"Peramban sedang mengunduh data",NETWORK_NO_SOURCE:"Tidak ada sumber audio/video yang ditemukan",MEDIA_ERR_ABORTED:"Proses pengambilan dihentikan oleh pengguna",MEDIA_ERR_NETWORK:"Terjadi kesalahan ketika mengunduh",MEDIA_ERR_DECODE:"Terjadi kesalahan ketika mendekode",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video tidak didukung",REPLAY:"Putar ulang",ERROR:"Jaringan offline",PLAY_TIPS:"Putar",PAUSE_TIPS:"Jeda",PLAYNEXT_TIPS:"Putar berikutnya",DOWNLOAD_TIPS:"Unduh",ROTATE_TIPS:"Putar",RELOAD_TIPS:"Muat ulang",FULLSCREEN_TIPS:"Layar penuh",EXITFULLSCREEN_TIPS:"Keluar dari layar penuh",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Keluar dari cssfullscreen",TEXTTRACK:"Keterangan",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LANGSUNG",OFF:"Tidak Aktif",OPEN:"Buka",MINI_DRAG:"Klik dan tahan untuk menarik",MINISCREEN:"Layar mini",REFRESH_TIPS:"Silakan Coba",REFRESH:"Segarkan",FORWARD:"teruskan",LIVE_TIP:"Langsung"}},fo={LANG:"it",TEXT:{ERROR_TYPES:{network:{code:1,msg:"errore di download del video"},mse:{code:2,msg:"errore di accodamento del flusso"},parse:{code:3,msg:"errore di analisi"},format:{code:4,msg:"formato errato"},decoder:{code:5,msg:"errore di decodifica"},runtime:{code:6,msg:"errori grammaticali"},timeout:{code:7,msg:"timeout della riproduzione"},other:{code:8,msg:"altri errori"}},HAVE_NOTHING:"Non ci sono informazioni che indichino se l'audio/il video  pronto",HAVE_METADATA:"I metadati audio/video sono pronti ",HAVE_CURRENT_DATA:"I dati sulla posizione corrente di riproduzione sono disponibili, ma non ci sono dati sufficienti per riprodurre il prossimo frame/millisecondo",HAVE_FUTURE_DATA:"Corrente e almeno un frame di dati  disponibile",HAVE_ENOUGH_DATA:"I dati disponibili sono sufficienti per avviare la riproduzione",NETWORK_EMPTY:"L'audio/Il video non  stato inizializzato",NETWORK_IDLE:"L'audio/Il video  attivo ed  stato selezionato per le risorse, ma non viene utilizzata alcuna rete",NETWORK_LOADING:"Il browser sta scaricando i dati",NETWORK_NO_SOURCE:"Nessuna origine audio/video trovata",MEDIA_ERR_ABORTED:"Il processo di recupero  stato interrotto dall'utente",MEDIA_ERR_NETWORK:"Si  verificato un errore durante il download",MEDIA_ERR_DECODE:"Si  verificato un errore durante la decodificazione",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/Video non supportato",REPLAY:"Riproduci di nuovo",ERROR:"Rete offline",PLAY_TIPS:"Riproduci",PAUSE_TIPS:"Sospendi",PLAYNEXT_TIPS:"Riproduci successivo",DOWNLOAD_TIPS:"Scarica",ROTATE_TIPS:"Ruota",RELOAD_TIPS:"Ricarica",FULLSCREEN_TIPS:"Schermo intero",EXITFULLSCREEN_TIPS:"Esci dallo schermo intero",CSSFULLSCREEN_TIPS:"Schermo intero CSS",EXITCSSFULLSCREEN_TIPS:"Esci dallo schermo intero CSS",TEXTTRACK:"Didascalia",PIP:"Immagine nell'immagine",SCREENSHOT:"Screenshot",LIVE:"IN DIRETTA",OFF:"Inattivo",OPEN:"Apri",MINI_DRAG:"Fai clic e tieni premuto per trascinare",MINISCREEN:"Minischermo",REFRESH_TIPS:"Prova",REFRESH:"Aggiorna",FORWARD:"inoltra",LIVE_TIP:"In diretta"}},go={LANG:"kr",TEXT:{ERROR_TYPES:{network:{code:1,msg:"  "},mse:{code:2,msg:"  "},parse:{code:3,msg:"  "},format:{code:4,msg:" "},decoder:{code:5,msg:" "},runtime:{code:6,msg:" "},timeout:{code:7,msg:"  "},other:{code:8,msg:" "}},HAVE_NOTHING:"/     ",HAVE_METADATA:"/   ",HAVE_CURRENT_DATA:"         /    ",HAVE_FUTURE_DATA:"        ",HAVE_ENOUGH_DATA:"     ",NETWORK_EMPTY:"/  ",NETWORK_IDLE:"/        ",NETWORK_LOADING:"   ",NETWORK_NO_SOURCE:"/    ",MEDIA_ERR_ABORTED:"    ",MEDIA_ERR_NETWORK:"   ",MEDIA_ERR_DECODE:"   ",MEDIA_ERR_SRC_NOT_SUPPORTED:"/  ",REPLAY:"",ERROR:"  ",PLAY_TIPS:"",PAUSE_TIPS:" ",PLAYNEXT_TIPS:" ",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:" ",FULLSCREEN_TIPS:" ",EXITFULLSCREEN_TIPS:"  ",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"cssfullscreen ",TEXTTRACK:"",PIP:"PIP",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"   ",MINISCREEN:"",REFRESH_TIPS:" ",REFRESH:" ",FORWARD:"",LIVE_TIP:""}},po={LANG:"ms-my",TEXT:{ERROR_TYPES:{network:{code:1,msg:"ralat muat turun video"},mse:{code:2,msg:"ralat menambahkan aliran"},parse:{code:3,msg:"ralat penghuraian"},format:{code:4,msg:"format salah"},decoder:{code:5,msg:"ralat mendekod"},runtime:{code:6,msg:"kesalahan tatabahasa"},timeout:{code:7,msg:"masa putar habis"},other:{code:8,msg:"kesalahan lain"}},HAVE_NOTHING:"Tiada maklumat sama ada audio/video sedia",HAVE_METADATA:"Metadata audio/video sedia ",HAVE_CURRENT_DATA:"Data tentang lokasi putar semasa tersedia, tetapi tidak cukup data untuk memainkan bingkai/milidetik seterusnya",HAVE_FUTURE_DATA:"Data semasa dan sekurang-kurangnya satu bingkai tersedia",HAVE_ENOUGH_DATA:"Data yang tersedia mencukupi untuk memulakan permainan",NETWORK_EMPTY:"Audio/video belum diinisialisasi",NETWORK_IDLE:"Audio/video aktif dan telah dipilih untuk sumber, tetapi tiada rangkaian digunakan",NETWORK_LOADING:"Pelayar sedang memuat turun data",NETWORK_NO_SOURCE:"Tiada sumber audio/video ditemui",MEDIA_ERR_ABORTED:"Proses pengambilan dibatalkan oleh pengguna",MEDIA_ERR_NETWORK:"Ralat berlaku semasa muat turun",MEDIA_ERR_DECODE:"Ralat berlaku semasa mendekod",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video tidak disokong",REPLAY:"Main semula",ERROR:"Rangkaian offline",PLAY_TIPS:"Putar",PAUSE_TIPS:"Jeda",PLAYNEXT_TIPS:"Putar seterusnya",DOWNLOAD_TIPS:"Muat turun",ROTATE_TIPS:"Putar",RELOAD_TIPS:"Muat semula",FULLSCREEN_TIPS:"Skrin penuh",EXITFULLSCREEN_TIPS:"Keluar skrin penuh",CSSFULLSCREEN_TIPS:"Cssskrin penuh",EXITCSSFULLSCREEN_TIPS:"Keluar cssskrin penuh",TEXTTRACK:"Kapsyen",PIP:"PIP",SCREENSHOT:"Tangkapan skrin",LIVE:"LIVE",OFF:"Matikan",OPEN:"Buka",MINI_DRAG:"Klik dan tahan untuk seret",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Sila Cuba",REFRESH:"Segarkan",FORWARD:"ke hadapan",LIVE_TIP:"Langsung"}},vo={LANG:"ru",TEXT:{ERROR_TYPES:{network:{code:1,msg:"  "},mse:{code:2,msg:"  "},parse:{code:3,msg:"  "},format:{code:4,msg:" "},decoder:{code:5,msg:" "},runtime:{code:6,msg:" "},timeout:{code:7,msg:"- "},other:{code:8,msg:" "}},HAVE_NOTHING:"    /",HAVE_METADATA:" /  ",HAVE_CURRENT_DATA:"     ,       /",HAVE_FUTURE_DATA:"       ",HAVE_ENOUGH_DATA:"     ",NETWORK_EMPTY:"/  ",NETWORK_IDLE:"/     ,    ",NETWORK_LOADING:"  ",NETWORK_NO_SOURCE:" /  ",MEDIA_ERR_ABORTED:"   ",MEDIA_ERR_NETWORK:"   ",MEDIA_ERR_DECODE:"   ",MEDIA_ERR_SRC_NOT_SUPPORTED:"/  ",REPLAY:" ",ERROR:"  ",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:" ",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:" ",EXITFULLSCREEN_TIPS:"   ",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"  cssfullscreen",TEXTTRACK:"",PIP:"  ",SCREENSHOT:" ",LIVE:" ",OFF:"",OPEN:"",MINI_DRAG:"  ,  ",MINISCREEN:"-",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:" "}},mo={LANG:"th",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:" "}},HAVE_NOTHING:"/",HAVE_METADATA:"/ ",HAVE_CURRENT_DATA:" /",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/ ",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:" cssfullscreen",TEXTTRACK:"",PIP:"PIP",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}},yo={LANG:"vn",TEXT:{ERROR_TYPES:{network:{code:1,msg:"li ti video v"},mse:{code:2,msg:"li ni lung"},parse:{code:3,msg:"li phn tch c php"},format:{code:4,msg:"sai nh dng"},decoder:{code:5,msg:"li gii m"},runtime:{code:6,msg:"li ng php"},timeout:{code:7,msg:"ht thi gian pht"},other:{code:8,msg:"li khc"}},HAVE_NOTHING:"Khng c thng tin v vic m thanh/video  sn sng hay cha",HAVE_METADATA:"Siu d liu v m thanh/video  sn sng ",HAVE_CURRENT_DATA:" c d liu v v tr pht hin ti, nhng khng c  d liu  pht khung hnh/mili giy tip theo",HAVE_FUTURE_DATA:"Hin ti v c t nht mt khung d liu kh dng",HAVE_ENOUGH_DATA:"D liu kh dng    bt u pht",NETWORK_EMPTY:"Cha khi to m thanh/video",NETWORK_IDLE:"m thanh/video ang hot ng v  c chn lm ti nguyn nhng khng c mng no c s dng",NETWORK_LOADING:"Trnh duyt ang ti d liu v",NETWORK_NO_SOURCE:"Khng tm thy ngun m thanh/video",MEDIA_ERR_ABORTED:"Ngi dng  hy b quy trnh tm np",MEDIA_ERR_NETWORK:" xy ra li khi ti v",MEDIA_ERR_DECODE:" xy ra li khi gii m",MEDIA_ERR_SRC_NOT_SUPPORTED:"m thanh/video khng c h tr",REPLAY:"Pht li",ERROR:"Mng ang ngoi tuyn",PLAY_TIPS:"Pht",PAUSE_TIPS:"Tm dng",PLAYNEXT_TIPS:"Pht tip",DOWNLOAD_TIPS:"Ti v",ROTATE_TIPS:"Xoay",RELOAD_TIPS:"Ti li",FULLSCREEN_TIPS:"Ton mn hnh",EXITFULLSCREEN_TIPS:"Thot ch  ton mn hnh",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Thot ch  cssfullscreen",TEXTTRACK:"Ch thch",PIP:"PIP",SCREENSHOT:"nh chp mn hnh",LIVE:"TRC TIP",OFF:"Tt",OPEN:"M",MINI_DRAG:"Nhp gi  ko",MINISCREEN:"Mn hnh nh",REFRESH_TIPS:"Vui lng th",REFRESH:"Lm mi",FORWARD:"chuyn tip",LIVE_TIP:"Pht trc tip"}},Sr={exports:{}};(function(l,u){(function(s,i){l.exports=i()})(typeof window<"u"?window:typeof self<"u"?self:typeof globalThis<"u"?globalThis:typeof Vt<"u"?Vt:Vt,function(){return function(){var s={"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/style/index.scss":function(n,r,a){var o=a("./node_modules/css-loader/dist/runtime/sourceMaps.js"),c=a.n(o),h=a("./node_modules/css-loader/dist/runtime/api.js"),g=a.n(h)()(c());g.push([n.id,".danmu{overflow:hidden;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;box-shadow:-2px 0 0 0 rgba(0,0,0,.04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}","",{version:3,sources:["webpack://./src/style/danmu.scss"],names:[],mappings:"AAAA,OACE,eAAA,CACA,gBAAA,CACA,oBAAA,CACA,SACE,iBAAA,CACA,kBAAA,CAIJ,cACE,UAAA,CACA,WAAA,CACA,mBAAA,CACA,qBAAA,CACA,qBAAA,CACA,YAAA,CACA,cAAA,CACA,iBAAA,CACA,iBAAA,CACA,gBAAA,CACA,kCACE,iBAAA,CACA,wBAAA,CAEF,uBACE,UAAA,CACA,WAAA,CACA,gBAAA,CACA,iBAAA,CACA,aAAA,CACA,mBAAA,CACA,qBAAA,CACA,qCAAA,CACA,sBAAA,CACA,cAAA,CACA,eAAA,CACA,aAAA",sourcesContent:[`.danmu {
  overflow: hidden;
  user-select: none;
  -ms-user-select: none;
  > * {
    position: absolute;
    white-space: nowrap;
  }
}

.danmu-switch {
  width: 32px;
  height: 20px;
  border-radius: 100px;
  background-color: #ccc;
  box-sizing: border-box;
  outline: none;
  cursor: pointer;
  position: relative;
  text-align: center;
  margin: 10px auto;
  &.danmu-switch-active {
    padding-left: 12px;
    background-color: #f85959;
  }
  span.txt {
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    display: block;
    border-radius: 100px;
    background-color: #ffffff;
    box-shadow: -2px 0 0 0 rgba(0, 0, 0, 0.04);
    font-family: PingFangSC;
    font-size: 10px;
    font-weight: 500;
    color: #f44336;
  }
}
`],sourceRoot:""}]),r.A=g},"./node_modules/css-loader/dist/runtime/api.js":function(n){n.exports=function(r){var a=[];return a.toString=function(){return this.map(function(o){var c="",h=o[5]!==void 0;return o[4]&&(c+="@supports (".concat(o[4],") {")),o[2]&&(c+="@media ".concat(o[2]," {")),h&&(c+="@layer".concat(o[5].length>0?" ".concat(o[5]):""," {")),c+=r(o),h&&(c+="}"),o[2]&&(c+="}"),o[4]&&(c+="}"),c}).join("")},a.i=function(o,c,h,g,y){typeof o=="string"&&(o=[[null,o,void 0]]);var m={};if(h)for(var _=0;_<this.length;_++){var C=this[_][0];C!=null&&(m[C]=!0)}for(var D=0;D<o.length;D++){var A=[].concat(o[D]);h&&m[A[0]]||(y!==void 0&&(A[5]===void 0||(A[1]="@layer".concat(A[5].length>0?" ".concat(A[5]):""," {").concat(A[1],"}")),A[5]=y),c&&(A[2]&&(A[1]="@media ".concat(A[2]," {").concat(A[1],"}")),A[2]=c),g&&(A[4]?(A[1]="@supports (".concat(A[4],") {").concat(A[1],"}"),A[4]=g):A[4]="".concat(g)),a.push(A))}},a}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":function(n){n.exports=function(r){var a=r[1],o=r[3];if(!o)return a;if(typeof btoa=="function"){var c=btoa(unescape(encodeURIComponent(JSON.stringify(o))));return[a].concat(["/*# ".concat("sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(c)," */")]).join(`
`)}return[a].join(`
`)}},"./node_modules/d/index.js":function(n,r,a){var o=a("./node_modules/d/node_modules/type/value/is.js"),c=a("./node_modules/d/node_modules/type/plain-function/is.js"),h=a("./node_modules/es5-ext/object/assign/index.js"),g=a("./node_modules/es5-ext/object/normalize-options.js"),y=a("./node_modules/es5-ext/string/#/contains/index.js");(n.exports=function(m,_){var C,D,A,O,H;return arguments.length<2||typeof m!="string"?(O=_,_=m,m=null):O=arguments[2],o(m)?(C=y.call(m,"c"),D=y.call(m,"e"),A=y.call(m,"w")):(C=A=!0,D=!1),H={value:_,configurable:C,enumerable:D,writable:A},O?h(g(O),H):H}).gs=function(m,_,C){var D,A,O,H;return typeof m!="string"?(O=C,C=_,_=m,m=null):O=arguments[3],o(_)?c(_)?o(C)?c(C)||(O=C,C=void 0):C=void 0:(O=_,_=C=void 0):_=void 0,o(m)?(D=y.call(m,"c"),A=y.call(m,"e")):(D=!0,A=!1),H={get:_,set:C,configurable:D,enumerable:A},O?h(g(O),H):H}},"./node_modules/d/node_modules/type/function/is.js":function(n,r,a){var o=a("./node_modules/d/node_modules/type/prototype/is.js");n.exports=function(c){if(typeof c!="function"||!hasOwnProperty.call(c,"length"))return!1;try{if(typeof c.length!="number"||typeof c.call!="function"||typeof c.apply!="function")return!1}catch{return!1}return!o(c)}},"./node_modules/d/node_modules/type/object/is.js":function(n,r,a){var o=a("./node_modules/d/node_modules/type/value/is.js"),c={object:!0,function:!0,undefined:!0};n.exports=function(h){return!!o(h)&&hasOwnProperty.call(c,typeof h)}},"./node_modules/d/node_modules/type/plain-function/is.js":function(n,r,a){var o=a("./node_modules/d/node_modules/type/function/is.js"),c=/^\s*class[\s{/}]/,h=Function.prototype.toString;n.exports=function(g){return!(!o(g)||c.test(h.call(g)))}},"./node_modules/d/node_modules/type/prototype/is.js":function(n,r,a){var o=a("./node_modules/d/node_modules/type/object/is.js");n.exports=function(c){if(!o(c))return!1;try{return c.constructor?c.constructor.prototype===c:!1}catch{return!1}}},"./node_modules/d/node_modules/type/value/is.js":function(n){var r=void 0;n.exports=function(a){return a!==r&&a!==null}},"./node_modules/es5-ext/function/noop.js":function(n){n.exports=function(){}},"./node_modules/es5-ext/object/assign/index.js":function(n,r,a){n.exports=a("./node_modules/es5-ext/object/assign/is-implemented.js")()?Object.assign:a("./node_modules/es5-ext/object/assign/shim.js")},"./node_modules/es5-ext/object/assign/is-implemented.js":function(n){n.exports=function(){var r,a=Object.assign;return typeof a=="function"&&(a(r={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),r.foo+r.bar+r.trzy==="razdwatrzy")}},"./node_modules/es5-ext/object/assign/shim.js":function(n,r,a){var o=a("./node_modules/es5-ext/object/keys/index.js"),c=a("./node_modules/es5-ext/object/valid-value.js"),h=Math.max;n.exports=function(g,y){var m,_,C,D=h(arguments.length,2);for(_=1,g=Object(c(g)),C=function(A){try{g[A]=y[A]}catch(O){m||(m=O)}};_<D;++_)y=arguments[_],o(y).forEach(C);if(m!==void 0)throw m;return g}},"./node_modules/es5-ext/object/is-value.js":function(n,r,a){var o=a("./node_modules/es5-ext/function/noop.js")();n.exports=function(c){return c!==o&&c!==null}},"./node_modules/es5-ext/object/keys/index.js":function(n,r,a){n.exports=a("./node_modules/es5-ext/object/keys/is-implemented.js")()?Object.keys:a("./node_modules/es5-ext/object/keys/shim.js")},"./node_modules/es5-ext/object/keys/is-implemented.js":function(n){n.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},"./node_modules/es5-ext/object/keys/shim.js":function(n,r,a){var o=a("./node_modules/es5-ext/object/is-value.js"),c=Object.keys;n.exports=function(h){return c(o(h)?Object(h):h)}},"./node_modules/es5-ext/object/normalize-options.js":function(n,r,a){var o=a("./node_modules/es5-ext/object/is-value.js"),c=Array.prototype.forEach,h=Object.create,g=function(y,m){var _;for(_ in y)m[_]=y[_]};n.exports=function(y){var m=h(null);return c.call(arguments,function(_){o(_)&&g(Object(_),m)}),m}},"./node_modules/es5-ext/object/valid-callable.js":function(n){n.exports=function(r){if(typeof r!="function")throw TypeError(r+" is not a function");return r}},"./node_modules/es5-ext/object/valid-value.js":function(n,r,a){var o=a("./node_modules/es5-ext/object/is-value.js");n.exports=function(c){if(!o(c))throw TypeError("Cannot use null or undefined");return c}},"./node_modules/es5-ext/string/#/contains/index.js":function(n,r,a){n.exports=a("./node_modules/es5-ext/string/#/contains/is-implemented.js")()?String.prototype.contains:a("./node_modules/es5-ext/string/#/contains/shim.js")},"./node_modules/es5-ext/string/#/contains/is-implemented.js":function(n){var r="razdwatrzy";n.exports=function(){return typeof r.contains=="function"&&r.contains("dwa")===!0&&r.contains("foo")===!1}},"./node_modules/es5-ext/string/#/contains/shim.js":function(n){var r=String.prototype.indexOf;n.exports=function(a){return r.call(this,a,arguments[1])>-1}},"./node_modules/event-emitter/index.js":function(n,r,a){var o,c,h,g,y,m,_,C=a("./node_modules/d/index.js"),D=a("./node_modules/es5-ext/object/valid-callable.js"),A=Function.prototype.apply,O=Function.prototype.call,H=Object.create,K=Object.defineProperty,Y=Object.defineProperties,V=Object.prototype.hasOwnProperty,Q={configurable:!0,enumerable:!1,writable:!0};o=function(z,$){var J;return D($),V.call(this,"__ee__")?J=this.__ee__:(J=Q.value=H(null),K(this,"__ee__",Q),Q.value=null),J[z]?typeof J[z]=="object"?J[z].push($):J[z]=[J[z],$]:J[z]=$,this},c=function(z,$){var J,le;return D($),le=this,o.call(this,z,J=function(){h.call(le,z,J),A.call($,this,arguments)}),J.__eeOnceListener__=$,this},y={on:o,once:c,off:h=function(z,$){var J,le,oe,he;if(D($),!V.call(this,"__ee__")||!(J=this.__ee__)[z])return this;if(typeof(le=J[z])=="object")for(he=0;oe=le[he];++he)(oe===$||oe.__eeOnceListener__===$)&&(le.length===2?J[z]=le[+!he]:le.splice(he,1));else(le===$||le.__eeOnceListener__===$)&&delete J[z];return this},emit:g=function(z){var $,J,le,oe,he;if(V.call(this,"__ee__")&&(oe=this.__ee__[z]))if(typeof oe=="object"){for($=1,J=arguments.length,he=Array(J-1);$<J;++$)he[$-1]=arguments[$];for($=0,oe=oe.slice();le=oe[$];++$)A.call(le,this,he)}else switch(arguments.length){case 1:O.call(oe,this);break;case 2:O.call(oe,this,arguments[1]);break;case 3:O.call(oe,this,arguments[1],arguments[2]);break;default:for($=1,J=arguments.length,he=Array(J-1);$<J;++$)he[$-1]=arguments[$];A.call(oe,this,he)}}},_=Y({},m={on:C(o),once:C(c),off:C(h),emit:C(g)}),n.exports=r=function(z){return z==null?H(_):Y(Object(z),m)},r.methods=y},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(n){var r=[];function a(c){for(var h=-1,g=0;g<r.length;g++)if(r[g].identifier===c){h=g;break}return h}function o(c,h){for(var g={},y=[],m=0;m<c.length;m++){var _=c[m],C=h.base?_[0]+h.base:_[0],D=g[C]||0,A="".concat(C," ").concat(D);g[C]=D+1;var O=a(A),H={css:_[1],media:_[2],sourceMap:_[3],supports:_[4],layer:_[5]};if(O!==-1)r[O].references++,r[O].updater(H);else{var K=function(Y,V){var Q=V.domAPI(V);return Q.update(Y),function(z){z?(z.css!==Y.css||z.media!==Y.media||z.sourceMap!==Y.sourceMap||z.supports!==Y.supports||z.layer!==Y.layer)&&Q.update(Y=z):Q.remove()}}(H,h);h.byIndex=m,r.splice(m,0,{identifier:A,updater:K,references:1})}y.push(A)}return y}n.exports=function(c,h){var g=o(c=c||[],h=h||{});return function(y){y=y||[];for(var m=0;m<g.length;m++){var _=a(g[m]);r[_].references--}for(var C=o(y,h),D=0;D<g.length;D++){var A=a(g[D]);r[A].references===0&&(r[A].updater(),r.splice(A,1))}g=C}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":function(n){var r={};n.exports=function(a,o){var c=function(h){if(r[h]===void 0){var g=document.querySelector(h);if(window.HTMLIFrameElement&&g instanceof window.HTMLIFrameElement)try{g=g.contentDocument.head}catch{g=null}r[h]=g}return r[h]}(a);if(!c)throw Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");c.appendChild(o)}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":function(n){n.exports=function(r){var a=document.createElement("style");return r.setAttributes(a,r.attributes),r.insert(a,r.options),a}},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":function(n,r,a){n.exports=function(o){var c=a.nc;c&&o.setAttribute("nonce",c)}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":function(n){n.exports=function(r){if(typeof document>"u")return{update:function(){},remove:function(){}};var a=r.insertStyleElement(r);return{update:function(o){var c,h,g;c="",o.supports&&(c+="@supports (".concat(o.supports,") {")),o.media&&(c+="@media ".concat(o.media," {")),(h=o.layer!==void 0)&&(c+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),c+=o.css,h&&(c+="}"),o.media&&(c+="}"),o.supports&&(c+="}"),(g=o.sourceMap)&&typeof btoa<"u"&&(c+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(g))))," */")),r.styleTagTransform(c,a,r.options)},remove:function(){var o;(o=a).parentNode===null||o.parentNode.removeChild(o)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":function(n){n.exports=function(r,a){if(a.styleSheet)a.styleSheet.cssText=r;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(r))}}}},i={};function e(n){var r=i[n];if(r!==void 0)return r.exports;var a=i[n]={id:n,exports:{}};return s[n](a,a.exports,e),a.exports}e.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(r,{a:r}),r},e.d=function(n,r){for(var a in r)e.o(r,a)&&!e.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:r[a]})},e.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.nc=void 0;var t={};return function(){e.r(t),e.d(t,{default:function(){return sn},DanmuJs:function(){return sn}});var n=e("./node_modules/event-emitter/index.js"),r=e.n(n);function a(x,P){(P==null||P>x.length)&&(P=x.length);for(var k=0,f=Array(P);k<P;k++)f[k]=x[k];return f}var o=typeof window<"u"&&window.location.href.indexOf("danmu-debug")>-1,c=function(){var x;function P(k){if(!(this instanceof P))throw TypeError("Cannot call a class as a function");this.constructorName=k||""}return x=[{key:"info",value:function(k){for(var f,d=arguments.length,v=Array(d>1?d-1:0),E=1;E<d;E++)v[E-1]=arguments[E];o&&(f=console).log.apply(f,["[Danmu Log][".concat(this.constructorName,"]"),k].concat(function(S){if(Array.isArray(S))return a(S)}(v)||function(S){if(typeof Symbol<"u"&&S[Symbol.iterator]!=null||S["@@iterator"]!=null)return Array.from(S)}(v)||function(S,R){if(S){if(typeof S=="string")return a(S,void 0);var L=Object.prototype.toString.call(S).slice(8,-1);if(L==="Object"&&S.constructor&&(L=S.constructor.name),L==="Map"||L==="Set")return Array.from(L);if(L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return a(S,void 0)}}(v)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}],function(k,f){for(var d=0;d<f.length;d++){var v=f[d];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}(P.prototype,x),P}(),h=function(){var x;function P(){if(!(this instanceof P))throw TypeError("Cannot call a class as a function")}return x=[{key:"setLogger",value:function(k){this.logger=(c!=null&&typeof Symbol<"u"&&c[Symbol.hasInstance]?c[Symbol.hasInstance](k):k instanceof c)?k:new c((k||"")+".js")}}],function(k,f){for(var d=0;d<f.length;d++){var v=f[d];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}(P.prototype,x),P}(),g=Object.prototype.hasOwnProperty;function y(x,P){if(m(P)==="Object"&&m(x)==="Object")return Object.keys(P).forEach(function(k){var f,d;m(P[k])!=="Object"||(f=P[k],(d=Node)!=null&&typeof Symbol<"u"&&d[Symbol.hasInstance]?!!d[Symbol.hasInstance](f):f instanceof d)?m(P[k])==="Array"?x[k]=m(x[k])==="Array"?x[k].concat(P[k]):P[k]:x[k]=P[k]:x[k]?y(x[k],P[k]):x[k]=P[k]}),x}function m(x){return Object.prototype.toString.call(x).match(/([^\s.*]+)(?=]$)/g)[0]}function _(x,P,k,f){if(f)x.on(P,k),x.once(f,function v(){x.off(P,k),x.off(f,v)});else{var d=function(v){k(v),x.off(P,d)};x.on(P,d)}}function C(x,P,k){var f=x.style;try{f[P]=k}catch{f.setProperty(P,k)}}function D(x){return typeof x=="number"&&!Number.isNaN(x)}function A(x){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(x)}function O(x,P){return(O=Object.setPrototypeOf||function(k,f){return k.__proto__=f,k})(x,P)}function H(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H=function(){return!!x})()}var K=new c("bullet"),Y=function(x){var P;if(typeof x!="function"&&x!==null)throw TypeError("Super expression must either be null or a function");function k(f){var d,v,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(this instanceof k))throw TypeError("Cannot call a class as a function");d=A(d=k),v=function(I,B){var M;if(B&&(((M=B)&&typeof Symbol<"u"&&M.constructor===Symbol?"symbol":typeof M)=="object"||typeof B=="function"))return B;if(I===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return I}(this,H()?Reflect.construct(d,[],A(this).constructor):d.apply(this,void 0));var S=f.container,R=f.recycler,L=f.config;return v.setLogger(K),v.danmu=f,v.options=E,v.duration=E.duration,v.id=E.id,v.container=S,v.mode=E.mode==="top"||E.mode==="bottom"?E.mode:"scroll",v.start=E.start,v.prior=E.prior,v.realTime=E.realTime,v.color=E.color,v.bookChannelId=E.bookChannelId,v.reuseDOM=!0,v.noCopyEl=!!(L.disableCopyDOM||E.disableCopyDOM),v.recycler=R,v._fullySlideInScreenDuration=void 0,v._lastMoveTime=void 0,v.status="waiting",E.elLazyInit||(v.bulletCreateFail=!v._makeEl()),v}return k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&O(k,x),P=[{key:"moveV",get:function(){var f=this.danmu,d=this.options,v=this._moveV;if(!v){if(d.moveV)v=d.moveV;else if(this.elPos){var E=f.containerPos;v=(this.direction==="b2t"?E.height+(f.config.chaseEffect?this.height:0):E.width+(f.config.chaseEffect?this.width:0))/this.duration*1e3}v&&(v*=f.main.playRate,this._moveV=v)}return v}},{key:"direction",get:function(){return this.danmu.direction}},{key:"fullySlideIntoScreen",get:function(){var f=!0;return this.mode==="scroll"&&this._lastMoveTime&&this._fullySlideInScreenDuration>0&&(f=(new Date().getTime()-this._lastMoveTime)/1e3>=this._fullySlideInScreenDuration),f}},{key:"_makeEl",value:function(){var f,d,v=this.danmu,E=this.options,S=v.config,R=v.globalHooks,L="",I=E.style||{};if(I.perspective="500em",E.el||E.elLazyInit){if(this.noCopyEl&&(this.reuseDOM=!1),E.elLazyInit){if(typeof R.bulletCreateEl=="function")try{var B,M=R.bulletCreateEl(E);B=HTMLElement,f=(B!=null&&typeof Symbol<"u"&&B[Symbol.hasInstance]?B[Symbol.hasInstance](M):M instanceof B)?M:M.el}catch{}}else if(E.el.nodeType===1&&!E.el.parentNode)if(this.reuseDOM){var ue=function(ee){if(!ee||ee.nodeType!==1)return"";var Te=document.createElement(ee.tagName);return Array.prototype.forEach.call(ee.attributes,function(ke){Te.setAttribute(ke.name,ke.value)}),ee.innerHTML&&(Te.innerHTML=ee.innerHTML),Te}(E.el);E.eventListeners&&E.eventListeners.length>0&&E.eventListeners.forEach(function(ee){ue.addEventListener(ee.event,ee.listener,ee.useCapture||!1)}),(f=this.recycler.use()).childNodes.length>0&&(f.innerHTML=""),f.textContent&&(f.textContent=""),f.appendChild(ue)}else f=E.el}else typeof E.txt=="string"&&((f=this.recycler.use()).textContent=E.txt);if(!f||!v.main)return!1;if(D(S.bulletOffset)&&S.bulletOffset>=0)d=S.bulletOffset;else{var ae=v.containerPos;d=ae.width/10>100?100:ae.width/10}var pe=E.realTime?0:Math.floor(Math.random()*d);I.left=this.updateOffset(pe,!0),Object.keys(I).forEach(function(ee){var Te=ee.replace(/[A-Z]/g,function(ke){return"-"+ke.toLowerCase()});L+="".concat(Te,":").concat(I[ee],";")});var ne=L,re=f.style;try{re.cssText=ne}catch{}return this.el=f,E.like&&E.like.el&&this.setLikeDom(E.like.el,E.like.style),!0}},{key:"updateOffset",value:function(f){var d=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.random=f;var v=this.danmu.containerPos.width+f+"px";return d||C(this.el,"left",this.danmu.containerPos.width+f+"px"),v}},{key:"attach",value:function(){if(this.options.elLazyInit&&!this.el&&this._makeEl(),this.danmu&&this.danmu.main){var f=this.danmu,d=this.options,v=this.el,E=f.globalHooks;E.bulletAttaching&&E.bulletAttaching(d),this.container.contains(v)||this.container.appendChild(v),this.elPos=v.getBoundingClientRect(),this.direction==="b2t"?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV&&(this.duration=(this.danmu.containerPos.width+this.random+this.width)/this.moveV*1e3),E.bulletAttached&&E.bulletAttached(d,v)}}},{key:"detach",value:function(){var f=this.el,d=this.danmu,v=this.options,E=d.globalHooks;f&&(E.bulletDetaching&&E.bulletDetaching(v),this.reuseDOM?this.recycler.unused(f):f.parentNode&&f.parentNode.removeChild(f),E.bulletDetached&&E.bulletDetached(v,f),this.el=null),this.elPos=void 0}},{key:"topInit",value:function(){this.logger&&this.logger.info("topInit #".concat(this.options.txt||"[DOM Element]","#")),this.direction==="b2t"?(C(this.el,"transformOrigin","left top"),C(this.el,"transform","translateX(-".concat(this.top,"px) translateY(").concat(this.danmu.containerPos.height,"px) translateZ(0px) rotate(90deg)")),C(this.el,"transition","transform 0s linear 0s")):C(this.el,"top","".concat(this.top,"px"))}},{key:"pauseMove",value:function(){var f=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.status!=="paused"&&(this.status!=="forcedPause"&&(this.status="paused"),this._moveV=void 0,this.el))if(this.mode==="scroll"){var d=this.danmu.containerPos;if(f){var v=(new Date().getTime()-this._lastMoveTime)/1e3*this.moveV,E=0;E=this.moveMoreS-v>=0?this.direction==="b2t"?(this.moveMoreS-v)/this.moveContainerHeight*d.height:(this.moveMoreS-v)/this.moveContainerWidth*d.width:this.moveMoreS-v,this.direction==="b2t"?C(this.el,"transform","translateX(-".concat(this.top,"px) translateY(").concat(E,"px) translateZ(0px) rotate(90deg)")):C(this.el,"left","".concat(E,"px"))}else this.direction==="b2t"?C(this.el,"transform","translateX(-".concat(this.top,"px) translateY(").concat(this.el.getBoundingClientRect().top-d.top,"px) translateZ(0px) rotate(90deg)")):C(this.el,"left","".concat(this.el.getBoundingClientRect().left-d.left,"px"));this.direction==="b2t"||C(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),C(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+new Date().getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(f){if(this.hasMove||(this.danmu.emit("bullet_start",this),this.hasMove=!0),(this.status!=="forcedPause"||f)&&this.el&&this.status!=="start")if(this.status="start",this.mode==="scroll"){var d,v=this.danmu.containerPos;if(!this.el)return;var E=this.el.getBoundingClientRect();if(this.direction==="b2t"){d=E.bottom-v.bottom;var S=(E.bottom-v.top)/this.moveV;C(this.el,"transition","transform ".concat(S,"s linear 0s")),C(this.el,"transform","translateX(-".concat(this.top,"px) translateY(-").concat(this.height,"px) translateZ(0px) rotate(90deg)")),this._lastMoveTime=new Date().getTime(),this.moveMoreS=E.top-v.top,this.moveContainerHeight=v.height}else{d=E.right-v.right;var R=E.right-v.left,L=R/this.moveV;E.right>v.left?(C(this.el,"transition","transform ".concat(L,"s linear 0s")),C(this.el,"transform","translateX(-".concat(R,"px) translateY(0px) translateZ(0px)")),this._lastMoveTime=new Date().getTime(),this.moveMoreS=E.left-v.left,this.moveContainerWidth=v.width):(this.status="end",this.remove())}this._fullySlideInScreenDuration=d/this.moveV}else{var I=new Date().getTime(),B=(this.startTime&&I-this.startTime>this.duration?I-this.startTime:this.duration)/1e3;C(this.el,"left","50%"),C(this.el,"margin","0 0 0 -".concat(this.width/2,"px")),C(this.el,"visibility","hidden"),C(this.el,"transition","visibility ".concat(B,"s 0s")),this.pastDuration||(this.pastDuration=1),this.startTime=I}}},{key:"remove",value:function(){var f=!(arguments.length>0)||arguments[0]===void 0||arguments[0];this.logger&&this.logger.info("remove #".concat(this.options.txt||"[DOM Element]","#")),f&&this.pauseMove(),this.el&&this.el.parentNode&&(this.detach(),this.options.el&&this.options.el.nodeType===1&&this.noCopyEl&&C(this.options.el,"transform","none"),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(f){this.el&&(this.el.style.fontSize=f)}},{key:"setLikeDom",value:function(f,d){if(f){Object.keys(d).forEach(function(S){f.style[S]=d[S]});var v="danmu-like";if(f.className=v,this.el){var E=this.el.querySelector("."+v);E&&this.el.removeChild(E),this.el.innerHTML="".concat(this.el.innerHTML).concat(f.outerHTML)}}return f}}],function(f,d){for(var v=0;v<d.length;v++){var E=d[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}(k.prototype,P),k}(h);function V(x){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(x)}function Q(x,P){return(Q=Object.setPrototypeOf||function(k,f){return k.__proto__=f,k})(x,P)}function z(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(z=function(){return!!x})()}var $=function(x){var P;if(typeof x!="function"&&x!==null)throw TypeError("Super expression must either be null or a function");function k(f){var d,v;if(!(this instanceof k))throw TypeError("Cannot call a class as a function");return d=V(d=k),(v=function(E,S){var R;if(S&&(((R=S)&&typeof Symbol<"u"&&R.constructor===Symbol?"symbol":typeof R)=="object"||typeof S=="function"))return S;if(E===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return E}(this,z()?Reflect.construct(d,[],V(this).constructor):d.apply(this,void 0))).setLogger("channel"),v.danmu=f,v.width=0,v.height=0,v.reset(!0),v.channels=[],v.updatePos(),_(v.danmu,"bullet_remove",function(E){v.removeBullet(E.bullet)},"destroy"),_(v.danmu,"channel_resize",function(){v.resize()},"destroy"),v}return k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&Q(k,x),P=[{key:"direction",get:function(){return this.danmu.direction}},{key:"checkAvailableTrack",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",d=this.channels,v=!1;if(f==="scroll")for(var E,S=0;S<d.length;S++){if(E=d[S],v=!0,E.operating[f]){v=!1;continue}var R=E.queue[f][0];if(R&&!R.fullySlideIntoScreen){v=!1;continue}if(v)break}else v=!0;return v}},{key:"destroy",value:function(){for(var f in this.logger&&this.logger.info("destroy"),this.channels.splice(0,this.channels.length),this._cancelResizeTimer(),this)g.call(this,f)&&delete this[f]}},{key:"reset",value:function(){var f=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("reset");var d=this,v=d.danmu,E=v.container,S=v.bulletBtn;function R(){if(d.danmu&&d.danmu.container){var L=d.danmu.container.getBoundingClientRect();d.width=L.width,d.height=L.height,d.resetId&&(cancelAnimationFrame(d.resetId),d.resetId=null);var I=d._initChannels(),B=I.channelSize,M=I.channelCount,ue=I.channels;d.channelCount=M,d.channels=ue,d.direction==="b2t"?d.channelWidth=B:d.channelHeight=B}}d.container=E,S&&S.main&&S.main.queue.forEach(function(L){L.remove()}),d.channels&&d.channels.length>0&&["scroll","top","bottom"].forEach(function(L){for(var I=0;I<d.channels.length;I++)d.channels[I].queue[L].forEach(function(B){B.remove()})}),S&&S.main&&S.main.data&&S.main.data.forEach(function(L){L.attached_=!1}),f?this.resetId=requestAnimationFrame(R):R()}},{key:"getRealOccupyArea",value:function(){return{width:this.width,height:this.height}}},{key:"updatePos",value:function(){var f=this.container.getBoundingClientRect();this.containerPos=f,this.containerWidth=f.width,this.containerHeight=f.height,this.containerTop=f.top,this.containerBottom=f.bottom,this.containerLeft=f.left,this.containerRight=f.right}},{key:"addBullet",value:function(f){var d=this,v=this.danmu,E=this.channels;if(d.direction==="b2t"?(R=this.channelWidth,L=Math.ceil(f.width/R)):(S=this.channelHeight,L=Math.ceil(f.height/S)),L>E.length)return{result:!1,message:"exceed channels.length, occupy=".concat(L,",channelsSize=").concat(E.length)};for(var S,R,L,I,B=!0,M=-1,ue=0,ae=E.length;ue<ae;ue++)if(E[ue].queue[f.mode].some(function(ce){return ce.id===f.id}))return{result:!1,message:"exited, channelOrder=".concat(ue,",danmu_id=").concat(f.id)};if(f.mode==="scroll")for(var pe=0,ne=E.length-L;pe<=ne;pe+=L){B=!0;for(var re=pe;re<pe+L;re++){if((I=E[re]).operating.scroll||I.bookId.scroll&&I.bookId.scroll!==f.id){B=!1;break}I.operating.scroll=!0;var ee=I.queue.scroll[0];if(ee){var Te=ee.el.getBoundingClientRect();if(d.direction==="b2t"){if(Te.bottom>=d.containerPos.bottom){B=!1,I.operating.scroll=!1;break}}else if(Te.right>=d.containerPos.right){B=!1,I.operating.scroll=!1;break}var ke=void 0,Be=ee.moveV,Me=void 0,be=f.moveV,me=void 0;if(d.direction==="b2t"?(Me=(ke=Te.bottom-d.containerTop)/Be,me=d.containerHeight+f.random-ke):(Me=(ke=Te.right-d.containerLeft)/Be,me=d.containerWidth+f.random-ke),be>Be){var qe=me/(be-Be);if(v.config.bOffset||(v.config.bOffset=0),Me+v.config.bOffset>=qe){var ye=Me*be-d.containerPos.width;ye>0&&f.updateOffset(ye+(1+Math.ceil(5*Math.random())))}}}I.operating.scroll=!1}if(B){M=pe;break}}else if(f.mode==="top")for(var Ze=0,Ot=E.length-L;Ze<=Ot;Ze++){B=!0;for(var Lt=Ze;Lt<Ze+L;Lt++){if(Lt>Math.floor(E.length/2)||(I=E[Lt]).operating[f.mode]||(I.bookId[f.mode]||f.prior)&&I.bookId[f.mode]!==f.id){B=!1;break}if(I.operating[f.mode]=!0,I.queue[f.mode].length>0){B=!1,I.operating[f.mode]=!1;break}I.operating[f.mode]=!1}if(B){M=Ze;break}}else if(f.mode==="bottom")for(var Et=E.length-L;Et>=0;Et--){B=!0;for(var Ft=Et;Ft<Et+L;Ft++){if(Ft<=Math.floor(E.length/2)||(I=E[Ft]).operating[f.mode]||(I.bookId[f.mode]||f.prior)&&I.bookId[f.mode]!==f.id){B=!1;break}if(I.operating[f.mode]=!0,I.queue[f.mode].length>0){B=!1,I.operating[f.mode]=!1;break}I.operating[f.mode]=!1}if(B){M=Et;break}}if(M!==-1){for(var Nt=M,Wr=M+L;Nt<Wr;Nt++)(I=E[Nt]).operating[f.mode]=!0,I.queue[f.mode].unshift(f),f.prior&&(delete I.bookId[f.mode],d.logger&&d.logger.info(Nt+"")),I.operating[f.mode]=!1;return f.prior&&(d.logger&&d.logger.info(f.id+""),delete f.bookChannelId,v.player&&v.bulletBtn.main.data.some(function(ce){return ce.id===f.id&&(delete ce.bookChannelId,!0)})),f.channel_id=[M,L],f.el.setAttribute("data-line-index",M+1),d.direction==="b2t"?(f.top=M*R,d.danmu.config.area&&d.danmu.config.area.start&&(f.top+=d.containerWidth*d.danmu.config.area.start)):(f.top=M*S,d.danmu.config.area&&d.danmu.config.area.start&&(f.top+=d.containerHeight*d.danmu.config.area.start)),{result:f,message:"success"}}if(f.options.realTime){var an=0,on=-1,we=null;if(d.danmu.bulletBtn.main.queue.forEach(function(ce,Yr){!ce.prior&&!ce.options.realTime&&ce.el&&ce.el.getBoundingClientRect().left>d.containerPos.right&&ce.start>=an&&(an=ce.start,on=Yr,we=ce)}),we){we.remove(),d.removeBullet(we),d.danmu.bulletBtn.main.queue.splice(on,1),f.channel_id=we.channel_id;for(var ui=we.channel_id[0],Gr=we.channel_id[0]+we.channel_id[1];ui<Gr;ui++)(I=E[ui]).operating[f.mode]=!0,I.queue[f.mode].unshift(f),f.prior&&delete I.bookId[f.mode],I.operating[f.mode]=!1;return f.top=we.top,d.danmu.config.area&&d.danmu.config.area.start&&(f.top+=d.containerHeight*d.danmu.config.area.start),{result:f,message:"success"}}}if(f.prior)if(f.bookChannelId||d.danmu.live)v.player&&v.bulletBtn.main.data.some(function(ce){return ce.id===f.id&&(d.logger&&d.logger.info(f.id+"2"),ce.start+=2e3,!0)});else{M=-1;for(var _t=0,Kr=E.length-L;_t<=Kr;_t++){B=!0;for(var li=_t;li<_t+L;li++)if(E[li].bookId[f.mode]){B=!1;break}if(B){M=_t;break}}if(M!==-1){for(var Bt=M;Bt<M+L;Bt++)E[Bt].bookId[f.mode]=f.id,d.logger&&d.logger.info(Bt+""+f.id+"");v.player&&v.bulletBtn.main.data.some(function(ce){return ce.id===f.id&&(d.logger&&d.logger.info(f.id+"2"),ce.start+=2e3,ce.bookChannelId=[M,L],d.logger&&d.logger.info("".concat(f.id,"").concat(M,"~").concat(M+L-1,"")),!0)})}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(f){this.logger&&this.logger.info("removeBullet ".concat(f.options.txt||"[DOM Element]"));for(var d,v=this.channels,E=f.channel_id,S=E[0],R=E[0]+E[1];S<R;S++)(function(L,I){if(d=v[L]){d.operating[f.mode]=!0;var B=-1;d.queue[f.mode].some(function(M,ue){return M.id===f.id&&(B=ue,!0)}),B>-1&&d.queue[f.mode].splice(B,1),d.operating[f.mode]=!1}})(S);f.options.loop&&this.danmu.bulletBtn.main.playedData.push(f.options)}},{key:"resizeSync",value:function(){this.resize(!0)}},{key:"_initChannels",value:function(){if(this.danmu&&this.danmu.config){var f=this.danmu.config,d=f.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);if(f.area){var v,E=f.area,S=E.lines,R=E.start,L=E.end;if(typeof S=="number"&&S>=0&&Number.isInteger(S))v=S,this.direction==="b2t"?this.width=v*d:this.height=v*d;else if(R>=0&&L>=R){var I=L-R;this.direction==="b2t"?this.width=Math.floor(this.width*I):this.height=Math.floor(this.height*I)}}D(v)||(v=this.direction==="b2t"?Math.floor(this.width/d):Math.floor(this.height/d));for(var B=[],M=0;M<v;M++)B[M]={id:M,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};return{channelSize:d,channelCount:v,channels:B}}}},{key:"resize",value:function(){var f=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("resize");var d=this;function v(S,R){S[R]={id:R,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}}}function E(){var S=d.danmu,R=S.container,L=S.bulletBtn;d.container=R,d.updatePos(),d._cancelResizeTimer(),L.main.data&&L.main.data.forEach(function(ne){ne.bookChannelId&&(delete ne.bookChannelId,d.logger&&d.logger.info("resize"+ne.id+""))}),d.logger&&d.logger.info("resize"),d.width=d.containerWidth,d.height=d.containerHeight;var I=d._initChannels(),B=I.channelSize,M=I.channels;if(d.channels)if(d.channels.length<=M.length){for(var ue=function(ne){["scroll","top","bottom"].forEach(function(re){M[ne].queue[re].forEach(function(ee){ee.resized=!1})})},ae=0;ae<d.channels.length;ae++)v(M,ae),function(ne){["scroll","top"].forEach(function(re){d.channels[ne].queue[re].forEach(function(ee){ee.el&&M[ne].queue[re].push(ee)})})}(ae),function(ne){d.channels[ne].queue.bottom.forEach(function(re){if(re.el&&(M[ne+M.length-d.channels.length].queue.bottom.push(re),re.channel_id[0]+re.channel_id[1]-1===ne)){var ee=[].concat(re.channel_id);re.channel_id=[ee[0]-d.channels.length+M.length,ee[1]],re.top=re.channel_id[0]*B,d.danmu.config.area&&d.danmu.config.area.start&&(re.top+=d.containerHeight*d.danmu.config.area.start),re.topInit()}})}(ae);for(var pe=0;pe<M.length;pe++)ue(pe);d.channels=M,d.direction==="b2t"?d.channelWidth=B:d.channelHeight=B}else(function(ne,re){for(var ee=function(be){v(ne,be),ke.forEach(function(me){if(!(me==="top"&&be>Math.floor(ne.length/2))){if(!(me==="bottom"&&be<=Math.floor(ne.length/2))){var qe=me==="bottom"?be-ne.length+d.channels.length:be;d.channels[qe].queue[me].forEach(function(ye,Ze){if(ye.el){if(ne[be].queue[me].push(ye),me==="bottom"&&ye.channel_id[0]+ye.channel_id[1]-1===qe){var Ot=[].concat(ye.channel_id);ye.channel_id=[Ot[0]-d.channels.length+ne.length,Ot[1]],ye.top=ye.channel_id[0]*re,d.danmu.config.area&&d.danmu.config.area.start&&(ye.top+=d.containerHeight*d.danmu.config.area.start),ye.topInit()}d.channels[qe].queue[me].splice(Ze,1)}})}}})},Te=function(be){ke.forEach(function(me){ne[be].queue[me].forEach(function(qe){qe.resized=!1})})},ke=["scroll","top","bottom"],Be=0;Be<ne.length;Be++)ee(Be);for(var Me=0;Me<ne.length;Me++)Te(Me);d.channels=ne,d.direction==="b2t"?d.channelWidth=re:d.channelHeight=re})(M,B);d.resizing=!1}d.resizing||(d.resizing=!0,f?E():(this._cancelResizeTimer(),this.resizeId=requestAnimationFrame(E)))}},{key:"_cancelResizeTimer",value:function(){this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=null)}}],function(f,d){for(var v=0;v<d.length;v++){var E=d[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}(k.prototype,P),k}(h);function J(x){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(x)}function le(x,P){return(le=Object.setPrototypeOf||function(k,f){return k.__proto__=f,k})(x,P)}function oe(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oe=function(){return!!x})()}var he=function(x){var P;if(typeof x!="function"&&x!==null)throw TypeError("Super expression must either be null or a function");function k(f){var d,v;if(!(this instanceof k))throw TypeError("Cannot call a class as a function");return v=J(v=k),(d=function(E,S){var R;if(S&&(((R=S)&&typeof Symbol<"u"&&R.constructor===Symbol?"symbol":typeof R)=="object"||typeof S=="function"))return S;if(E===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return E}(this,oe()?Reflect.construct(v,[],J(this).constructor):v.apply(this,void 0))).setLogger("main"),d.danmu=f,d.container=f.container,d.channel=new $(f),d.data=[].concat(f.config.comments),d.playedData=[],d.queue=[],d.timer=null,d.playRate=1,d.retryStatus="normal",d.interval=f.config.interval,d._status="idle",d._events=[],d._bindEvents(),d}return k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&le(k,x),P=[{key:"status",get:function(){return this._status}},{key:"destroy",value:function(){for(var f in this.logger&&this.logger.info("destroy"),this._unbindEvents(),this._cancelTick(),this.channel&&this.channel.destroy(),this.data=[],this)delete this[f]}},{key:"_bindEvents",value:function(){var f=this,d=this.danmu,v=this.container;this._unbindEvents(),this._events.push([d,"bullet_remove",function(E){var S=E.bullet,R=f.data,L=f.queue;L.some(function(I,B){return I.id===S.id&&(L.splice(B,1),!0)}),R.some(function(I){return I.id===S.id&&(I.attached_=!1,!0)})}]),this._events.push([v,"transitionend",function(E){var S=f._getBulletByEvt(E);S&&(S.status="end",S.remove(!1))}]),(d.config.mouseControl||d.config.mouseEnterControl)&&this._events.push([v,"mouseover",function(E){var S,R=f.danmu;R&&(!R.mouseControl||!R.config.mouseControlPause)&&(S=f._getBulletByEvt(E))&&S.status!=="waiting"&&S.status!=="end"&&R.emit("bullet_hover",{bullet:S,event:E})}]),this._events.forEach(function(E){E[0].addEventListener?E[0].addEventListener(E[1],E[2],!1):E[0].on&&E[0].on(E[1],E[2])})}},{key:"_unbindEvents",value:function(){this._events.length&&(this._events.forEach(function(f){f[0].removeEventListener?f[0].removeEventListener(f[1],f[2],!1):f[0].off&&f[0].off(f[1],f[2])}),this._events=[])}},{key:"_cancelTick",value:function(){this.handleTimer&&(clearTimeout(this.handleTimer),this.handleTimer=null)}},{key:"_startTick",value:function(){var f=this;f.retryStatus="normal",f._cancelTick(),f.sortData(),function d(){f._status==="closed"&&f.retryStatus==="stop"?f._cancelTick():(f._status==="playing"&&(f.readData(),f.dataHandle()),(f.retryStatus!=="stop"||f._status==="paused")&&(f.handleTimer=setTimeout(d,250)))}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this._status!=="playing"&&(this._status="playing",this.queue=[],this.container.innerHTML="",this.channel.reset(),this._startTick())}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this._status!=="closed"&&(this._status="closed",this.retryStatus="stop",this.queue=[],this.container&&(this.container.innerHTML=""),this.channel&&this.channel.reset(),this._cancelTick())}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel&&this.channel.reset(),this.data=[],this.queue=[],this.container&&(this.container.innerHTML="")}},{key:"play",value:function(){var f=this;if(this._status==="closed"){this.logger&&this.logger.info("play ignored");return}this.logger&&this.logger.info("play"),this._status="playing";var d=this.channel.channels;d&&d.length>0&&["scroll","top","bottom"].forEach(function(v){f.queue.forEach(function(S){S.startMove(),S.resized=!0});for(var E=0;E<d.length;E++)d[E].queue[v].forEach(function(S){S.resized=!1})}),this._startTick()}},{key:"pause",value:function(){if(this._status==="closed"){this.logger&&this.logger.info("pause ignored");return}this.logger&&this.logger.info("pause"),this._status="paused",this._cancelTick();var f=this.channel.channels;f&&f.length>0&&this.queue.forEach(function(d){d.pauseMove()})}},{key:"dataHandle",value:function(){this._status!=="paused"&&this._status!=="closed"&&this.queue.length&&this.queue.forEach(function(f){f.status==="waiting"&&f.startMove()})}},{key:"readData",value:function(){var f=this.danmu,d=this.interval,v=this.channel,E=f.player;if(f.isReady&&f.main){if(E){var S=E.currentTime?Math.floor(1e3*E.currentTime):0;L=this.data.filter(function(ae){return!ae.start&&0>f.hideArr.indexOf(ae.mode)&&(!ae.color||0>f.hideArr.indexOf("color"))&&(ae.start=S),!ae.attached_&&0>f.hideArr.indexOf(ae.mode)&&(!ae.color||0>f.hideArr.indexOf("color"))&&ae.start-d<=S&&S<=ae.start+d}),f.config.highScorePriority&&L.sort(function(ae,pe){return pe.prior&&!ae.prior||(pe.score||-1)-(ae.score||-1)}),f.live&&(this.data=[])}else(L=this.data.splice(0,1)).length===0&&(L=this.playedData.splice(0,1));if(L.length>0&&v.checkAvailableTrack(L[0].mode)){v.updatePos();for(var R,L,I,B=0,M=0;M<L.length;M++)if(I=L[M],this.forceDuration&&this.forceDuration!==I.duration&&(I.duration=this.forceDuration),(R=new Y(f,I)).bulletCreateFail){if(B===0)break;B--}else if(R.attach(),I.attached_=!0,v.addBullet(R).result)this.queue.push(R),R.topInit(),B=0;else{for(var ue in R.detach(),R)g.call(R,ue)&&delete R[ue];if(R=null,I.attached_=!1,I.noDiscard&&(I.prior?this.data.unshift(I):this.data.push(I)),B===0)break;B--}}}}},{key:"sortData",value:function(){this.data.sort(function(f,d){return(f.start||-1)-(d.start||-1)})}},{key:"keepPoolWatermark",value:function(){var f=this.danmu,d=f.config,v=f.player,E=this.data,S=[],R=0;if(typeof d.maxCommentsLength=="number"&&E.length>d.maxCommentsLength){R=E.length-d.maxCommentsLength;for(var L,I=0;I<R;I++)(L=E[I]).prior&&!L.attached_&&S.push(E[I])}else if(d.dropStaleComments&&v&&v.currentTime){var B=Math.floor(1e3*v.currentTime)-d.interval;if(B>0){for(var M,ue=0;ue<E.length;ue++)if((M=E[ue]).prior&&!M.attached_&&S.push(E[ue]),M.start>B){R=ue;break}}}R>0&&(E.splice(0,R),this.data=S.concat(E))}},{key:"_getBulletByEvt",value:function(f){for(var d,v,E=f.target||f.srcElement,S=this.queue,R=0;R<S.length;R++)if((v=S[R])&&v.el&&(v.el===E||v.el.contains(E))){d=v;break}return d}}],function(f,d){for(var v=0;v<d.length;v++){var E=d[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}(k.prototype,P),k}(h);function ai(x){return(ai=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(x)}function Ji(x,P){return(Ji=Object.setPrototypeOf||function(k,f){return k.__proto__=f,k})(x,P)}function Qi(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qi=function(){return!!x})()}var Pr=function(x){var P;if(typeof x!="function"&&x!==null)throw TypeError("Super expression must either be null or a function");function k(f){var d,v;if(!(this instanceof k))throw TypeError("Cannot call a class as a function");return v=ai(v=k),(d=function(E,S){var R;if(S&&(((R=S)&&typeof Symbol<"u"&&R.constructor===Symbol?"symbol":typeof R)=="object"||typeof S=="function"))return S;if(E===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return E}(this,Qi()?Reflect.construct(v,[],ai(this).constructor):v.apply(this,void 0))).setLogger("control"),d.danmu=f,d.main=new he(f),f.config.defaultOff||d.main.start(),d}return k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&Ji(k,x),P=[{key:"createSwitch",value:function(){var f=!(arguments.length>0)||arguments[0]===void 0||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",R=document.createElement(d);return R.className=S,R.innerHTML=v,Object.keys(E).forEach(function(L){var I=E[L];d==="video"||d==="audio"?I&&R.setAttribute(L,I):R.setAttribute(L,I)}),R}("dk-switch",'<span class="txt"></span>',{},"danmu-switch ".concat(f?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var f in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)g.call(this,f)&&delete this[f]}}],function(f,d){for(var v=0;v<d.length;v++){var E=d[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}(k.prototype,P),k}(h),wr=function(){var x;function P(k){if(!(this instanceof P))throw TypeError("Cannot call a class as a function");k={initDOM:function(){return document.createElement("div")},initSize:10},this.init(k)}return x=[{key:"init",value:function(k){this.idleList=[],this.usingList=[],this._id=0,this.options=k,this._expand(k.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var k=this.idleList.shift();return this.usingList.push(k),k}},{key:"unused",value:function(k){var f=this.usingList.indexOf(k);f<0||(this.usingList.splice(f,1),k.style.opacity=0,this.idleList.push(k))}},{key:"_expand",value:function(k){for(var f=0;f<k;f++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var k=0;k<this.idleList.length;k++)this.idleList[k].innerHTML="",this.idleList[k].textcontent="",this.clearElementStyle(this.idleList[k]);for(var f=0;f<this.usingList.length;f++)this.usingList[f].innerHTML="",this.usingList[f].textcontent="",this.clearElementStyle(this.usingList[f]);for(var d in this)g.call(this,d)&&delete this[d]}},{key:"clearElementStyle",value:function(k){var f=typeof window<"u"?window.navigator.userAgent:null;f&&(f.indexOf("MSIE ")>-1||f.indexOf("Trident/")>-1?C(k,"transform","none"):k.setAttribute("style",""))}}],function(k,f){for(var d=0;d<f.length;d++){var v=f[d];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}(P.prototype,x),P}(),en=new(function(){var x;function P(){var k=this;if(!(this instanceof P))throw TypeError("Cannot call a class as a function");if(this.__handlers=[],typeof ResizeObserver<"u")try{this.observer=new ResizeObserver(function(f,d){var v=this,E=0;return function(){for(var S=arguments.length,R=Array(S),L=0;L<S;L++)R[L]=arguments[L];clearTimeout(E),E=setTimeout(function(){return f.apply(v,R)},d)}}(function(f){k.__trigger(f)},100))}catch{}}return x=[{key:"addObserver",value:function(k,f){if(this.observer&&k){this.observer&&this.observer.observe(k);for(var d=this.__handlers,v=-1,E=0;E<d.length;E++)d[E]&&k===d[E].target&&(v=E);v>-1?this.__handlers[v].handler.push(f):this.__handlers.push({target:k,handler:[f]})}}},{key:"unObserver",value:function(k){if(k){var f=-1;this.__handlers.map(function(d,v){k===d.target&&(f=v)}),this.observer&&this.observer.unobserve(k),f>-1&&this.__handlers.splice(f,1)}}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(k){for(var f=this.__handlers,d=0;d<f.length;d++)if(f[d]&&k===f[d].target){f[d].handler&&f[d].handler.map(function(v){try{v()}catch(E){console.error(E)}});break}}},{key:"__trigger",value:function(k){var f=this;k.map(function(d){f.__runHandler(d.target)})}}],function(k,f){for(var d=0;d<f.length;d++){var v=f[d];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(k,v.key,v)}}(P.prototype,x),P}());function oi(x){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(x)}function tn(x,P){var k;if(P&&(((k=P)&&typeof Symbol<"u"&&k.constructor===Symbol?"symbol":typeof k)=="object"||typeof P=="function"))return P;if(x===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function nn(x,P){return(nn=Object.setPrototypeOf||function(k,f){return k.__proto__=f,k})(x,P)}function rn(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rn=function(){return!!x})()}var sn=function(x){var P;if(typeof x!="function"&&x!==null)throw TypeError("Super expression must either be null or a function");function k(f){if(!(this instanceof k))throw TypeError("Cannot call a class as a function");d=oi(d=k),(v=tn(this,rn()?Reflect.construct(d,[],oi(this).constructor):d.apply(this,void 0))).setLogger("danmu"),v.logger&&v.logger.info("danmu.js version: ".concat("1.2.1"));var d,v,E=v.config={overlap:!1,area:{start:0,end:1,lines:void 0},hooks:void 0,live:!1,comments:[],direction:"r2l",needResizeObserver:!1,dropStaleComments:!1,channelSize:void 0,maxCommentsLength:void 0,bulletOffset:void 0,interval:2e3,highScorePriority:!0,chaseEffect:!0};if(y(E,f),r()(v),v.globalHooks={},E.hooks&&v.hooks(E.hooks),v.hideArr=[],v.recycler=new wr,v.freezeId=null,E.comments.forEach(function(I){I.duration=I.duration?I.duration:5e3,I.mode||(I.mode="scroll")}),v.container=E.container&&E.container.nodeType===1?E.container:null,!v.container)return v.emit("error","container id can't be empty"),tn(v,!1);if(E.containerStyle){var S=E.containerStyle;Object.keys(S).forEach(function(I){v.container.style[I]=S[I]})}var R=v.container,L="danmu";return R.classList?L.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(I){I&&R.classList.add(I)}):(R.classList?Array.prototype.some.call(R.classList,function(I){return I===L}):R.className.match(RegExp("(\\s|^)"+L+"(\\s|$)")))||(R.className+=" "+L),v.live=E.live,v.player=E.player,v.direction=E.direction,v.bulletBtn=new Pr(v),v.main=v.bulletBtn.main,v.isReady=!0,v.emit("ready"),v.logger&&v.logger.info("ready"),v.addResizeObserver(),v}return k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&nn(k,x),P=[{key:"status",get:function(){return this.main.status}},{key:"state",get:function(){var f=this.main;return{status:f.status,comments:f.data,bullets:f.queue,displayArea:f.channel.getRealOccupyArea()}}},{key:"containerPos",get:function(){return this.main.channel.containerPos}},{key:"hooks",value:function(f){y(this.globalHooks,f)}},{key:"addResizeObserver",value:function(){var f,d=this;this.config.needResizeObserver&&this.container&&(f=this.container,en.addObserver(f,function(){d.logger&&d.logger.info("needResizeObserver"),d.resize()}))}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.main&&this.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.main&&this.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.main&&this.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.main&&this.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.main&&this.main.clear()}},{key:"destroy",value:function(){var f;for(var d in f=this.container,en.unObserver(f,void 0),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn&&this.bulletBtn.destroy(),this.recycler&&this.recycler.destroy(),this)delete this[d];this.emit("destroy")}},{key:"sendComment",value:function(f){var d=this.main,v=this.logger;v&&v.info("sendComment: ".concat(f.txt||"[DOM Element]")),d&&(f.duration||(f.duration=15e3),f&&f.id&&f.duration&&(f.el||f.elLazyInit||f.txt)&&(f.duration=f.duration?f.duration:5e3,f.style||(f.style={opacity:void 0,fontSize:void 0}),f.style&&(this.opacity&&this.opacity!==f.style.opacity&&(f.style.opacity=this.opacity),this.fontSize&&this.fontSize!==f.style.fontSize&&(f.style.fontSize=this.fontSize)),f.prior||f.realTime?(d.data.unshift(f),f.realTime&&(d.readData(),d.dataHandle())):d.data.push(f),d.sortData(),d.keepPoolWatermark()))}},{key:"setCommentID",value:function(f,d){var v=this;this.logger&&this.logger.info("setCommentID: oldID ".concat(f," newID ").concat(d)),f&&d&&(this.main.data.some(function(E){return E.id===f&&(E.id=d,!0)}),this.main.queue.some(function(E){return E.id===f&&(E.id=d,E.pauseMove(),v.main.status!=="paused"&&E.startMove(),!0)}))}},{key:"setCommentDuration",value:function(f,d){var v=this;this.logger&&this.logger.info("setCommentDuration: id ".concat(f," duration ").concat(d)),f&&d&&(d=d||5e3,this.main.data.some(function(E){return E.id===f&&(E.duration=d,!0)}),this.main.queue.some(function(E){return E.id===f&&(E.duration=d,E.pauseMove(),v.main.status!=="paused"&&E.startMove(),!0)}))}},{key:"setCommentLike",value:function(f,d){this.logger&&this.logger.info("setCommentLike: id ".concat(f," like ").concat(d)),f&&d&&(this.main.data.some(function(v){return v.id===f&&(v.like=d,!0)}),this.main.queue.some(function(v){return v.id===f&&(v.pauseMove(),v.setLikeDom(d.el,d.style),v.danmu.main.status!=="paused"&&v.startMove(),!0)}))}},{key:"restartComment",value:function(f){if(this.logger&&this.logger.info("restartComment: id ".concat(f)),f){var d=this.main;this._releaseCtrl(f),d.status!=="closed"&&d.queue.some(function(v){return v.id===f&&(d.status!=="paused"?v.startMove(!0):v.status="paused",!0)})}}},{key:"_releaseCtrl",value:function(f){this.freezeId&&f===this.freezeId&&(this.mouseControl=!1,this.freezeId=null)}},{key:"_freezeCtrl",value:function(f){this.mouseControl=!0,this.freezeId=f}},{key:"freezeComment",value:function(f){this.logger&&this.logger.info("freezeComment: id ".concat(f)),f&&(this._freezeCtrl(f),this.main.queue.some(function(d){return d.id===f&&(d.status="forcedPause",d.pauseMove(),d.el&&d.el.style&&C(d.el,"zIndex",10),!0)}))}},{key:"removeComment",value:function(f){if(this.logger&&this.logger.info("removeComment: id ".concat(f)),f){var d=this.main;this._releaseCtrl(f),d.queue=d.queue.filter(function(v){return v.id!==f||(v.remove(),!1)}),d.data=d.data.filter(function(v){return v.id!==f})}}},{key:"updateComments",value:function(f){var d=!(arguments.length>1)||arguments[1]===void 0||arguments[1];this.logger&&this.logger.info("updateComments: ".concat(f.length,", isClear ").concat(d));var v=this.main;typeof d=="boolean"&&d&&(v.data=[]),v.data=v.data.concat(f),v.sortData(),v.keepPoolWatermark()}},{key:"setAllDuration",value:function(){var f=this,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",v=arguments.length>1?arguments[1]:void 0,E=!(arguments.length>2)||arguments[2]===void 0||arguments[2];this.logger&&this.logger.info("setAllDuration: mode ".concat(d," duration ").concat(v," force ").concat(E)),v&&(v=v||5e3,E&&(this.main.forceDuration=v),this.main.data.forEach(function(S){d===S.mode&&(S.duration=v)}),this.main.queue.forEach(function(S){d===S.mode&&(S.duration=v,S.pauseMove(),f.main.status!=="paused"&&S.startMove())}))}},{key:"setPlayRate",value:function(){var f=this,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",v=arguments.length>1?arguments[1]:void 0;this.logger&&this.logger.info("setPlayRate: ".concat(v)),D(v)&&v>0&&(this.main.playRate=v,this.main.queue.forEach(function(E){d===E.mode&&(E.pauseMove(),f.main.status!=="paused"&&E.startMove())}))}},{key:"setOpacity",value:function(f){this.logger&&this.logger.info("setOpacity: opacity ".concat(f)),this.container&&(this.container.style.opacity=f)}},{key:"setFontSize",value:function(f,d){var v=this,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{reflow:!0};this.logger&&this.logger.info("setFontSize: size ".concat(f," channelSize ").concat(d)),this.fontSize="".concat(f,"px"),f&&(this.main.data.forEach(function(S){S.style&&(S.style.fontSize=v.fontSize)}),this.main.queue.forEach(function(S){S.options.style||(S.options.style={}),S.options.style.fontSize=v.fontSize,S.setFontSize(v.fontSize),d&&(S.top=S.channel_id[0]*d,S.topInit())})),d&&(this.config.channelSize=d,E.reflow&&this.main.channel.resizeSync())}},{key:"setArea",value:function(f){this.logger&&this.logger.info("setArea: area ".concat(f)),this.config.area=f,f.reflow!==!1&&this.main.channel.resizeSync()}},{key:"hide",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode ".concat(f)),0>this.hideArr.indexOf(f)&&this.hideArr.push(f),this.main.queue.filter(function(d){return f===d.mode||f==="color"&&d.color}).forEach(function(d){return d.remove()})}},{key:"show",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode ".concat(f));var d=this.hideArr.indexOf(f);d>-1&&this.hideArr.splice(d,1)}},{key:"setDirection",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction ".concat(f)),this.direction=f,this.emit("changeDirection",f)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}}],function(f,d){for(var v=0;v<d.length;v++){var E=d[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}(k.prototype,P),k}(h),Rr=e("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),Or=e.n(Rr),Lr=e("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),Fr=e.n(Lr),Nr=e("./node_modules/style-loader/dist/runtime/insertBySelector.js"),Br=e.n(Nr),Mr=e("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),Hr=e.n(Mr),Ur=e("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),jr=e.n(Ur),Vr=e("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),zr=e.n(Vr),Rt=e("./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/style/index.scss"),it={};it.styleTagTransform=zr(),it.setAttributes=Hr(),it.insert=Br().bind(null,"head"),it.domAPI=Fr(),it.insertStyleElement=jr(),Or()(Rt.A,it),Rt.A&&Rt.A.locals&&Rt.A.locals}(),t}()})})(Sr);var Da=Sr.exports;const Ia=Oi(Da);function Pa(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-5 -11 40 40" width="40" height="40">
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>
</svg>
`,"image/svg+xml").firstChild}var Mn=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.set={speed:1,area:{},opacity:1,fonSize:"middle"},e}return N(s,[{key:"afterCreate",value:function(){X.device==="mobile"?this.activeEvent="click":this.activeEvent="mouseenter",this.onStateChange=this.onStateChange.bind(this),this.onToggle=this.onToggle.bind(this),this.bind(this.activeEvent,this.onToggle),this.bind("mouseleave",this.onToggle),this.appendChild(".xgplayer-panel-icon",Pa())}},{key:"onStateChange",value:function(e){this.config.onChangeSet&&this.config.onChangeSet(this.set)}},{key:"onToggle",value:function(e){e.preventDefault(),e.stopPropagation(),p.hasClass(this.root,"slider-show")?p.removeClass(this.root,"slider-show"):p.addClass(this.root,"slider-show")}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.onStateChange)}},{key:"render",value:function(){return`
      <xg-icon class="xgplayer-panel">
          <xg-panel-icon class="xgplayer-panel-icon">
          </xg-panel-icon>
          <xg-panel-slider class="xgplayer-panel-slider">
            <xg-hidemode class="xgplayer-hidemode">
              <p class="xgplayer-hidemode-font"></p>
              <ul class="xgplayer-hidemode-radio">
                <li class="xgplayer-hidemode-scroll" id="false"></li><li class="xgplayer-hidemode-top" id="false"></li><li class="xgplayer-hidemode-bottom" id="false"></li><li class="xgplayer-hidemode-color" id="false"></li>
              </ul>
            </xg-hidemode>
            <xg-transparency class="xgplayer-transparency">
              <span></span>
              <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>
            </xg-transparency>
            <xg-showarea class="xgplayer-showarea">
              <div class="xgplayer-showarea-name"></div>
              <div class="xgplayer-showarea-control">
                <div class="xgplayer-showarea-control-up">
                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>
                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>
                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>
                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>
                </div>
                <div class="xgplayer-showarea-control-down">
                  <div class="xgplayer-showarea-control-down-dots">
                    <span class="xgplayer-showarea-onequarters-dot"></span>
                    <span class="xgplayer-showarea-twoquarters-dot"></span>
                    <span class="xgplayer-showarea-threequarters-dot"></span>
                    <span class="xgplayer-showarea-full-dot"></span>
                  </div>
                  <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">
                </div>
              </div>
            </xg-showarea>
            <xg-danmuspeed class="xgplayer-danmuspeed">
              <div class="xgplayer-danmuspeed-name"></div>
              <div class="xgplayer-danmuspeed-control">
                <div class="xgplayer-danmuspeed-control-up">
                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small"></span>
                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color"></span>
                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large"></span>
                </div>
                <div class="xgplayer-danmuspeed-control-down">
                  <div class="xgplayer-danmuspeed-control-down-dots">
                    <span class="xgplayer-danmuspeed-small-dot"></span>
                    <span class="xgplayer-danmuspeed-middle-dot"></span>
                    <span class="xgplayer-danmuspeed-large-dot"></span>
                  </div>
                  <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">
                </div>
              </div>
            </xg-danmuspeed>
            <xg-danmufont class="xgplayer-danmufont">
              <div class="xgplayer-danmufont-name"></div>
              <div class="xgplayer-danmufont-control">
                <div class="xgplayer-danmufont-control-up">
                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small"></span>
                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle"></span>
                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color"></span>
                </div>
                <div class="xgplayer-danmufont-control-down">
                  <div class="xgplayer-danmufont-control-down-dots">
                    <span class="xgplayer-danmufont-small-dot"></span>
                    <span class="xgplayer-danmufont-middle-dot"></span>
                    <span class="xgplayer-danmufont-large-dot"></span>
                  </div>
                  <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">
                </div>
              </div>
            </xg-danmufont>
          </xg-panel-slider>
      </xg-icon>`}}],[{key:"pluginName",get:function(){return"danmuPanel"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:11,onChangeSet:function(t){console.log("DanmuPanel:".concat(t))},speed:1,area:{},opacity:1,fonSize:"middle"}}}]),s}(q),Hn=`<dk-switch class="danmu-switch">
<span class="txt"></span>
</dk-switch>`,Un=function(l){U(s,l);var u=j(s);function s(){return F(this,s),u.apply(this,arguments)}return N(s,[{key:"afterCreate",value:function(){this.initIcons(),this.onStateChange=this.onStateChange.bind(this),this.bind(["click","touchend"],this.onStateChange)}},{key:"registerIcons",value:function(){return{openDanmu:{icon:Hn,class:"danmu-switch-open"},closeDanmu:{icon:Hn,class:"danmu-switch-closed"}}}},{key:"switchState",value:function(e){e?this.setAttr("data-state","active"):this.setAttr("data-state","normal"),this.switchTips(e)}},{key:"initIcons",value:function(){var e=this.icons,t=this.find(".xgplayer-icon");t.appendChild(e.openDanmu),t.appendChild(e.closeDanmu)}},{key:"switchTips",value:function(e){var t=this.find(".xg-tips");t&&this.changeLangTextKey(t,e?"OFF":"OPEN")}},{key:"onStateChange",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.root.getAttribute("data-state"),n=t==="active";this.switchState(!n),this.config.onSwitch&&this.config.onSwitch(e,!n)}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="OPEN";return`
    <xg-icon class="danmu-icon">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ne(this,e,this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"danmuIcon"}},{key:"defaultConfig",get:function(){return{position:te.CONTROLS_RIGHT,index:11,onSwitch:function(t,n){}}}}]),s}(q),jn=300,Eo=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.danmujs=null,e.danmuPanel=null,e.isOpen=!1,e.seekCost=0,e.intervalId=0,e.isUseClose=!1,e}return N(s,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.isLive&&(this.config.isLive=!0),this.initDanmu(),this.registerExtIcons(),this.once(_e,function(){e.config.defaultOpen&&!e.isUseClose&&e.start()}),this.on(vt,function(){e.isOpen&&e.danmujs&&e.danmujs.pause()}),this.on(Ce,function(){e.isOpen&&e.danmujs&&e.danmujs.play()}),this.on(Yt,function(){e.seekCost=window.performance.now(),!e.config.isLive&&e.danmujs&&e.danmujs.stop()}),this.on(Le,function(){e.resize()}),this.on(Oe,function(){if(!(!e.danmujs||!e.isOpen)){e.intervalId&&(p.clearTimeout(e,e.intervalId),e.intervalId=null);var t=window.performance.now(),n=t-e.seekCost>jn?100:jn;e.intervalId=p.setTimeout(e,function(){e.danmujs.start(),e.intervalId=null,e.player.paused&&e.danmujs.pause()},n)}})}},{key:"onPluginsReady",value:function(){var e=this.player.plugins.pc;e&&(e.onVideoDblClick&&this.bind("dblclick",e.onVideoDblClick),e.onVideoClick&&this.bind("click",e.onVideoClick))}},{key:"initDanmu",value:function(){var e=this.player,t=this.config,n=this.config,r=n.channelSize,a=n.fontSize,o=n.opacity,c=n.mouseControl,h=n.mouseControlPause,g=n.area,y=n.defaultOff,m={container:this.root,player:e.media,comments:this.config.comments,live:t.isLive,defaultOff:y,area:g,mouseControl:c,mouseControlPause:h};t.ext&&Object.keys(t.ext).map(function(C){m[C]=t.ext[C]});var _=new Ia(m);this.danmujs=_,e.danmu=_,this.setFontSize(a,r),this.setArea(g),this.resize(),o!==1&&this.setOpacity(o)}},{key:"registerExtIcons",value:function(){var e=this,t=this.player,n=this.config;if(n.panel&&t.controls){var r={config:{onChangeset:function(h){e.changeSet(h)}}};this.danmuPanel=t.controls.registerPlugin(Mn,r,Mn.pluginName)}var a=n.switchConfig;if(!n.closeDefaultBtn&&t.controls){var o={config:{onSwitch:function(h,g){e.onSwitch(h,g)}}};Object.keys(a).map(function(c){o.config[c]=a[c]}),this.danmuButton=t.controls.registerPlugin(Un,o,Un.pluginName),this.config.defaultOpen&&this.danmuButton.switchState(!0)}}},{key:"changeSet",value:function(e){}},{key:"onSwitch",value:function(e,t){this.emitUserAction(e,"switch_danmu",{prop:"isOpen",from:!t,to:t}),t?this.start():this.stop()}},{key:"start",value:function(){var e=this;this.isOpen||!this.danmujs||(this.isUseClose=!1,this.show(),this.resize(),p.setTimeout(this,function(){e.danmujs.start(),e.player.paused&&e.danmujs.pause(),e.isOpen=!0},0))}},{key:"stop",value:function(){this.isUseClose=!0,!(!this.isOpen||!this.danmujs)&&(this.danmujs.stop(),this.config.isLive&&this.clear(),this.isOpen=!1,this.hide())}},{key:"clear",value:function(){this.danmujs&&this.danmujs.clear()}},{key:"setCommentLike",value:function(e,t){this.danmujs&&this.danmujs.setCommentLike(e,t)}},{key:"setCommentDuration",value:function(e,t){this.danmujs&&this.danmujs.setCommentDuration(e,t)}},{key:"setAllDuration",value:function(e,t){this.danmujs&&this.danmujs.setAllDuration(e,t)}},{key:"setCommentID",value:function(e,t){this.danmujs&&this.danmujs.setCommentID(e,t)}},{key:"hideMode",value:function(e){this.danmujs&&this.danmujs.hide(e)}},{key:"showMode",value:function(e){this.danmujs&&this.danmujs.show(e)}},{key:"setArea",value:function(e){this.danmujs&&this.danmujs.setArea(e)}},{key:"setOpacity",value:function(e){this.danmujs&&this.danmujs.setOpacity(e)}},{key:"setFontSize",value:function(e,t){this.danmujs&&this.danmujs.setFontSize(e,t)}},{key:"resize",value:function(){this.danmujs&&this.danmujs.resize()}},{key:"sendComment",value:function(e){this.danmujs&&this.danmujs.sendComment(e)}},{key:"updateComments",value:function(e,t){this.danmujs&&this.danmujs.updateComments(e,t)}},{key:"hideIcon",value:function(){this.danmuButton&&this.danmuButton.hide()}},{key:"showIcon",value:function(){this.danmuButton&&this.danmuButton.show()}},{key:"destroy",value:function(){this.danmujs.stop(),this.danmujs.destroy(),this.danmujs=null,this.player.danmu=null;var e=this.danmuButton,t=this.danmuPanel;this.danmuButton&&this.danmuButton.root&&e.__destroy&&e.__destroy(),this.danmuPanel&&this.danmuPanel.root&&t.__destroy&&t.__destroy(),this.danmuButton=null,this.danmuPanel=null}},{key:"render",value:function(){return`<xg-danmu class="xgplayer-danmu">
    </xg-danmu>`}}],[{key:"pluginName",get:function(){return"danmu"}},{key:"defaultConfig",get:function(){return{comments:[],area:{start:0,end:1},closeDefaultBtn:!1,defaultOff:!1,panel:!1,panelConfig:{},switchConfig:{},defaultOpen:!0,isLive:!1,channelSize:24,fontSize:14,opacity:1,mouseControl:!1,mouseControlPause:!1,ext:{},style:{}}}}]),s}(q);function Vn(l,u){var s=Object.keys(l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(l);u&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})),s.push.apply(s,i)}return s}function ft(l){for(var u=1;u<arguments.length;u++){var s=arguments[u]!=null?arguments[u]:{};u%2?Vn(Object(s),!0).forEach(function(i){ze(l,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(s)):Vn(Object(s)).forEach(function(i){Object.defineProperty(l,i,Object.getOwnPropertyDescriptor(s,i))})}return l}function St(l){"@babel/helpers - typeof";return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},St(l)}function Pt(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function zn(l,u){for(var s=0;s<u.length;s++){var i=u[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(l,xr(i.key),i)}}function wt(l,u,s){return u&&zn(l.prototype,u),s&&zn(l,s),Object.defineProperty(l,"prototype",{writable:!1}),l}function ze(l,u,s){return u=xr(u),u in l?Object.defineProperty(l,u,{value:s,enumerable:!0,configurable:!0,writable:!0}):l[u]=s,l}function wa(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),u&&Pi(l,u)}function Ie(l){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Ie(l)}function Pi(l,u){return Pi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},Pi(l,u)}function Ra(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xe(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function Ar(l,u){if(u&&(typeof u=="object"||typeof u=="function"))return u;if(u!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xe(l)}function Oa(l){var u=Ra();return function(){var i=Ie(l),e;if(u){var t=Ie(this).constructor;e=Reflect.construct(i,arguments,t)}else e=i.apply(this,arguments);return Ar(this,e)}}function La(l,u){for(;!Object.prototype.hasOwnProperty.call(l,u)&&(l=Ie(l),l!==null););return l}function Ge(){return typeof Reflect<"u"&&Reflect.get?Ge=Reflect.get.bind():Ge=function(u,s,i){var e=La(u,s);if(e){var t=Object.getOwnPropertyDescriptor(e,s);return t.get?t.get.call(arguments.length<3?u:i):t.value}},Ge.apply(this,arguments)}function Fa(l,u){if(typeof l!="object"||l===null)return l;var s=l[Symbol.toPrimitive];if(s!==void 0){var i=s.call(l,u||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(l)}function xr(l){var u=Fa(l,"string");return typeof u=="symbol"?u:String(u)}var _i=/^WEBVTT/i,Na=/^STYLE+$/,Ba=/^\:\:cue/,Ma=/^}+$/,Wn=/^\[Script Info\].*/,Gn=[/[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,3}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}\.[0-9]{1,3}-->[0-9]{1,2}\.[0-9]{1,3}/],Ci=50,Kn=/^Format:\s/,Yn=/^Style:\s/,Xn=/^Dialogue:\s/;function Ti(l){var u=l.length;return u===3?((Number(l[0])*60+Number(l[1]))*60*1e3+Number(l[2])*1e3)/1e3:u===2?(Number(l[0])*60*1e3+Number(l[1])*1e3)/1e3:Number(l[0])}function Ha(l){return/^(\-|\+)?\d+(\.\d+)?$/.test(l)}function $n(l,u){return l>=0&&l<u.length?u[l]:""}var qn=function(){function l(){Pt(this,l)}return wt(l,null,[{key:"parseJson",value:function(s){for(var i=[],e=0,t=0;t<s.length;t++){if(e>=Ci&&(e=0),e===0){var n={start:s[t].start,list:[s[t]],end:s[t].end};i.push(n)}else i[i.length-1].list.push(s[t]),i[i.length-1].end=s[t].end;e++}return i}},{key:"parse",value:function(s,i){var e=l.checkFormat(s);e||i({format:e});try{var t=[];e==="ass"?t=l.parseASS(s):e==="vtt"&&(t=l.parseVTT(s)),i({format:e,list:t.list,styles:t.styles})}catch(n){console.error(n),i({format:e},n)}}},{key:"parseASSItem",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=s.split(","),t={},n="";try{var r=e.length-i.length;return r>0?n=e.splice(i.length-1,r+1).join(",")+"":n=e[e.length-1]+"",n=n.replace(/\\n+/g,""),n=n,e[i.length-1]=n,i.map(function(a,o){a==="end"||a==="start"?t[a]=Ti(e[o].split(":")):a==="text"?t[a]=[e[o]]:a==="layer"?(t[a]=[e[o]],t.textTag=[e[o]]):a==="style"?t[a]=[e[o]]:t[a]=Number(e[o])?Number(e[o]):e[o]}),t}catch(a){return console.error(a),{}}}},{key:"parseASS",value:function(s){for(var i=s.split(`
`),e=[],t=0,n=0,r=[],a=[],o=null;t<i.length;){if(Kn.test(i[t]))a=i[t].replace(Kn,"").replace(/\s+/g,"").split(","),a=a.map(function(C){return C.toLocaleLowerCase()});else if(Yn.test(i[t]))r.push(i[t].replace(Yn,"").replace(/\s+/g,""));else if(Xn.test(i[t])){var c=l.parseASSItem(i[t].replace(Xn,""),a);if(!o||!(c.start===o.start&&c.end===o.end)){o=c;var h=null;n%Ci===0?(h={start:o.start,end:o.end,list:[]},h.list.push(o),e.push(h)):(h=e[e.length-1],h.end=o.end,h.list.push(o)),n++}else try{var g=o,y=g.text,m=g.textTag,_=g.style;y.push(c.text[0]),m.push(c.textTag[0]),_.push(c.style[0])}catch(C){console.error(C)}}t++}return{list:e,style:{}}}},{key:"parseVTTStyle",value:function(s,i){var e=s.split(":");if(e.length>1){var t=e[0].trim().split("-"),n="";t.length>1?t.map(function(r,a){n+=a===0?r:r.charAt(0).toUpperCase()+r.slice(1)}):n=t[0],i[n]=e[1].trim().replace(/;$/,"")}return i}},{key:"parseVTT",value:function(s){s=s.replace(_i,"");for(var i=s.split(`
`),e=[],t=0,n=0,r=null,a=!1,o=!1,c=null,h=null,g=[];t<i.length;){var y=$n(t,i).trim();if(!y||a&&Ha(y))a=!y;else if(Ba.test(y)&&Na.test($n(t-1,i).trim())){o=!0;var m=/\((.+?)\)/g.exec(y);m?h=m[1]:h="",c=""}else if(o)Ma.test(y)?(g.push({key:h,style:c}),c=null,h=null,o=!1):c+=y;else if(y){a=!1;var _=this.checkIsTime(i[t]);if(_){var C=this.parseVttTime(_);if(!r||!(C.start===r.start&&C.end===r.end)){r=C,r.text=[],r.textTag=[];var D=null;n%Ci===0?(D={start:r.start,end:r.end,list:[]},D.list.push(r),e.push(D)):(D=e[e.length-1],D.end=r.end,D.list.push(r)),n++}}else if(r){var A=r,O=A.text,H=A.textTag,K=this.parseVttText(i[t]);O.push(K.text),H.push(K.tag)}a=!1}t++}return{list:e,styles:g}}},{key:"checkIsTime",value:function(s){s=s.replace(/\s+/g,"");for(var i=0,e=null;i<Gn.length&&(e=Gn[i].exec(s),!e);)i++;return e?e[0]:null}},{key:"parseVttText",value:function(s){var i=/^(<?.+?>)/g.exec(s),e="",t="default";if(i){t=i[0].replace(/\<|\>|\&/g,"");var n=RegExp("^<".concat(t,">(([\\s\\S])*?)</").concat(t,">$")),r=n.exec(s);r?e=r[1]:(e=s,t="")}else e=s;for(var a=/<(\w+).(\w+)>/g,o=a.exec(e);o&&o.length>2;)e=e.replace(o[0],"<".concat(o[1],' class="').concat(o[2],'">')),o=a.exec(e);return{tag:t,text:e.replace(/\\n+/g,"<br/>")}}},{key:"parseVttTime",value:function(s){var i=s.split("-->"),e,t=0;if(i.length===2){var n=i[0].split(":"),r=i[1].split(":");e=Ti(n),t=Ti(r)}return{start:e,end:t,time:s}}},{key:"isVTT",value:function(s){return _i.test(s)}},{key:"isASS",value:function(s){return Wn.test(s)}},{key:"checkFormat",value:function(s){return s?_i.test(s)?"vtt":Wn.test(s)?"ass":null:null}}]),l}(),Zn=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR"},{code:6,msg:"ABORT"},{code:7,msg:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null"},{code:9,msg:"DATA_ERROR:subtitle.url length is 0"}];function Se(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s={code:Zn[l].code,msg:Zn[l].msg};return Object.keys(u).map(function(i){s[i]=u[i]}),s}var Ua=wt(function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=u.url,i=u.method,e=i===void 0?"GET":i,t=u.type,n=t===void 0?"arraybuffer":t,r=u.timeout,a=r===void 0?1e4:r,o=u.data,c=o===void 0?{}:o,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Pt(this,l),new Promise(function(g,y){var m=new window.XMLHttpRequest,_=e.toUpperCase(),C=[];if(n&&(m.responseType=n),a&&(m.timeout=a),Object.keys(c).forEach(function(D){C.push("k=".concat(c[D]))}),m.onload=function(){m.status===200||m.status===206?g({context:h,res:m}):y(new Error({context:h,res:m,type:"error"}))},m.onerror=function(D){y(new Error({context:h,res:m,type:"error"}))},m.ontimeout=function(D){y(new Error({context:h,res:m,type:"error"}))},m.onabort=function(){y(new Error({context:h,res:m,type:"error"}))},_==="GET")m.open(_,"".concat(s)),m.send();else if(_==="post")m.open(_,s),m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),m.send(C.join("&"));else throw new Error("xhr ".concat(_," is not supported"))})}),Zi=function(){function l(){Pt(this,l);var u,s,i=new Promise(function(t,n){u=t,s=n}),e=i;return e.resolve=function(t){u(t),e.state="fulfilled"},e.reject=function(t){s(t),e.state="rejected",e.isBreak=t==="DESTROYED"},e.state="pending",e}return wt(l,[{key:"resolve",value:function(s){}},{key:"reject",value:function(s){}}]),l}();function Dr(l,u){if(!l)return!1;if(l.classList)return Array.prototype.some.call(l.classList,function(i){return i===u});var s=l.className&&St(l.className)==="object"?l.getAttribute("class"):l.className;return s&&!!s.match(new RegExp("(\\s|^)"+u+"(\\s|$)"))}function jt(l,u){l&&(l.classList?u.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(s){s&&l.classList.add(s)}):Dr(l,u)||(l.className&&St(l.className)==="object"?l.setAttribute("class",l.getAttribute("class")+" "+u):l.className+=" "+u))}function ja(l,u){l&&(l.classList?u.split(/\s+/g).forEach(function(s){l.classList.remove(s)}):Dr(l,u)&&u.split(/\s+/g).forEach(function(s){var i=new RegExp("(\\s|^)"+s+"(\\s|$)");l.className&&St(l.className)==="object"?l.setAttribute("class",l.getAttribute("class").replace(i," ")):l.className=l.className.replace(i," ")}))}function Jn(l,u,s){var i=u.length;if(i<1)return-1;if(s=s<0?0:s>=i?i-1:s,u[s].start<=l&&l<u[s].end)return s;for(var e=u[s].end<=l?s+1:0;e<i;e++){if(u[e].start<=l&&l<u[e].end)return e;if(l>u[e].end&&e+1<i&&l<u[e+1].start)return-1;if(l>u[e].end&&e+1>=i)return-1}return-1}function Qn(l,u,s){var i=u.length;if(i<1)return[];s=s<0?0:s>=i?i-1:s;var e=[];if(s<i)for(var t=u[s].end<=l?s:0;t<i&&(u[t].start<=l&&l<u[t].end&&e.push(t),!(l<u[t].start));t++);return e}function Va(l,u,s){if(l.length===0||u<0||u>l.length-1)return[];var i=l[u].list;if(s.length===0)return[];var e=i.splice(s[0],s.length);return u>0&&l.splice(0,u),i.length===0&&l.splice(0,1),e}function wi(l){return Object.prototype.toString.call(l).match(/([^\s.*]+)(?=]$)/g)[0]}function er(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",e=document.createElement(l);return e.className=i,e.innerHTML=u,Object.keys(s).forEach(function(t){var n=t,r=s[t];l==="video"||l==="audio"||l==="live-video"?r&&e.setAttribute(n,r):e.setAttribute(n,r)}),e}function za(){var l=navigator.userAgent,u=/(?:Windows Phone)/.test(l),s=/(?:SymbianOS)/.test(l)||u,i=/(?:Android)/.test(l),e=/(?:Firefox)/.test(l),t=/(?:iPad|PlayBook)/.test(l)||i&&!/(?:Mobile)/.test(l)||e&&/(?:Tablet)/.test(l),n=/(?:iPhone)/.test(l)&&!t;return n||i||s||t}function Wa(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s="";l.map(function(r){s+=" ".concat(u," ").concat(r.key," {").concat(r.style,"}")});var i=document.createElement("style"),e=document.head||document.getElementsByTagName("head")[0];if(i.type="text/css",i.id="ssss",i.styleSheet){var t=function(){try{i.styleSheet.cssText=s}catch{}};i.styleSheet.disabled?setTimeout(t,10):t()}else{var n=document.createTextNode(s);i.appendChild(n)}e.appendChild(i)}function Ir(l,u,s){if(s||(s=new Zi),u==="json"){var i=qn.parseJson(l);s.resolve({list:i,format:"json"})}else u==="string"&&qn.parse(l,function(e,t){if(t){var n=Se(2,t);s.reject(n,{format:e.format})}else if(e.format)s.resolve({styles:e.styles,list:e.list,format:e.format});else{var r=Se(3);s.reject(r)}});return s}function tr(l,u){return u||(u=new Zi),new Ua({url:l.url,type:"text"}).then(function(s){Ir(s.res.response,"string").then(function(i){u.resolve(ft(ft({},i),l))}).catch(function(i){u.reject(i)})}).catch(function(s){var i=Se(1,ft({statusText:s.statusText,status:s.status,type:s.type,message:"http load error",url:l.src},l));u.reject(i)}),u}function Qe(l,u){return!!(l.id&&u.id&&l.id===u.id||l.language&&u.language&&l.language===u.language)}function Ga(l){return l===null||l.trim()===""?!1:/^[a-zA-Z]+$/.test(l)}function Ka(l){var u=/[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]/;return!!u.test(l)}function Ya(l){var u=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return!!u.test(l)}function Xa(l){for(var u=l.split(""),s=[],i=!1,e=0;e<u.length;e++){var t=u[e];if(Ga(t))if(!i)s.push(t),i=!0;else{var n=s.length-1;s[n]="".concat(s[n]).concat(t)}else if(t.match(/^[ ]*$/)||Ka(t)||Ya(t)){i=!1;var r=s.length-1;s[r]="".concat(s[r]).concat(t)}else i=!1,s.push(t)}return s}var $a=function(){function l(){var u=this;Pt(this,l),this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver(function(s){u.__trigger(s)}))}return wt(l,[{key:"addObserver",value:function(s,i){if(this.observer){this.observer&&this.observer.observe(s);for(var e=this.__handlers,t=-1,n=0;n<e.length;n++)e[n]&&s===e[n].target&&(t=n);t>-1?this.__handlers[t].handler.push(i):this.__handlers.push({target:s,handler:[i]})}}},{key:"unObserver",value:function(s){var i=-1;this.__handlers.map(function(e,t){s===e.target&&(i=t)}),this.observer&&this.observer.unobserve(s),i>-1&&this.__handlers.splice(i,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(s,i){for(var e=this.__handlers,t=0;t<e.length;t++)if(e[t]&&s===e[t].target){e[t].handler&&e[t].handler.forEach(function(n){try{n(s,i)}catch(r){console.error(r)}});break}}},{key:"__trigger",value:function(s){var i=this;s.map(function(e){var t=e.contentRect;i.__runHandler(e.target,t)})}}]),l}(),kt=null;function qa(l,u){kt||(kt=new $a),kt.addObserver(l,u)}function Za(l,u){kt&&kt.unObserver(l,u)}var ki={RESIZE:"resize",CHANGE:"change",OFF:"off",UPDATE:"update"};function ir(l){var u=[];return l&&wi(l)==="String"?u.push({url:l,index:0,start:-1,end:-1}):wi(l)==="Array"&&l.forEach(function(s,i){u.push({url:s.url||s.src,index:i,start:s.start||-1,end:s.end||-1})}),u}var nr=!1,Ja=function(l){wa(s,l);var u=Oa(s);function s(i){var e;return Pt(this,s),e=u.call(this),ze(xe(e),"_onPause",function(){e.stopRender()}),ze(xe(e),"_onPlay",function(){e._curRenderTask.length>0&&e.startRender(-1)}),ze(xe(e),"_onTimeupdate",function(){if(e._isOpen){var t=e.player.video,n=t.videoWidth,r=t.videoHeight;!e._videoMeta.scale&&n&&r&&e._onResize(e.player.root);var a=e._getPlayerCurrentTime();Math.round(Math.abs(a*1e3-e._ctime))<200||(e._ctime=a*1e3,e.currentText&&e.currentText.list&&(e.config.updateMode==="live"?e._liveUpdate(a):e._update(a)))}}),ze(xe(e),"_onResize",function(t){var n=xe(e),r=n._videoMeta,a=n.config;if(a.domRender){if((!t||!(t instanceof window.Element))&&(t=e.player.root),e._iId&&(clearTimeout(e._iId),e._iId=null),!r.scale){if(!e.player.video)return;var o=e.player.video,c=o.videoWidth,h=o.videoHeight;if(c&&h)r.videoWidth=c,r.videoHeight=h,r.scale=parseInt(h/c*100,10);else return}e.__startResize(t)}}),ze(xe(e),"_onCoreEvents",function(t){try{switch(t.eventName){case"core.subtitlesegments":e._onSubtitleSegment(t.list||[]);break;case"core.subtitleplaylist":e._onSubtitlePlaylist(t.list||[]);break;case"core.seipayloadtime":e._onCoreSeiintime(t);break;default:}}catch(n){console.error(n)}}),ze(xe(e),"startRender",function(t){if(t>0&&e._renderIntervalId&&(window.cancelAnimationFrame(e._renderIntervalId),e._renderIntervalId=-1),!!e.textTrack){var n=xe(e),r=n._curRenderTask;e._lastTimeStamp=new Date().getTime();var a=[];r.forEach(function(o,c){var h=o.lastTime,g=o.wordList,y=o.interval,m=o.dom,_=o.ids;if(t<0||e._lastTimeStamp<0||e._lastTimeStamp-h>=y){var C=g.shift();C&&m.appendData(C),o.lastTime=e._lastTimeStamp}g.length<1&&a.push({index:c,ids:_})}),e._log(">>>>_renderByWords emptyArr",a.length,r.length),a.forEach(function(o){r.splice(o.index,1),e._log(">>>_renderByWords remove emptyArr",o.index,r.length)}),r.length>0&&(e._renderIntervalId=window.requestAnimationFrame(e.startRender))}}),ze(xe(e),"destroy",function(){e.detachPlayer(),e.removeAllListeners(),e.player=null,e.textTrack=null,e._curRenderTask=[],e.stopRender()}),nr=za(),e.currentText=null,e.currentExtText=null,e.textTrack=[],e._cid=-1,e._gid=-1,e._cids=[],e._iId=null,e._iC=0,e.player=null,e.root=null,e.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff",domRender:!0,updateMode:"vod",renderMode:"",debugger:!1},e._ctime=0,e._loadingTrack={},Object.keys(e.config).map(function(t){i[t]!==void 0&&i[t]!==null&&(e.config[t]=i[t])}),e._isOpen=e.config.defaultOpen||!1,e._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},!i.subTitles||wi(i.subTitles)!=="Array"?Ar(e):(i.player&&e.attachPlayer(i.player),e.seiTime=0,e.lastSeiTime=0,e._curTexts=[],e._curRenderTask=[],e._renderIntervalId=-1,e._lastTimeStamp=-1,e.setSubTitles(i.subTitles,e.config.defaultOpen),e)}return wt(s,[{key:"version",get:function(){return"3.0.23"}},{key:"setSubTitles",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=this._isOpen||n;r&&this.innerRoot&&this.switchOff(),this.currentText=null,this.textTrack=[],t.forEach(function(o){var c={};Object.keys(o).map(function(h){c[h]=o[h]}),c.url=ir(c.url),c.isDefault&&(e.currentText=c),e.textTrack.push(c)}),this._log("setSubTitles",a),a&&this.switch().catch(function(o){e._log("[switch]",o)}),this.currentText&&this._loadTrack(this.currentText).then(function(o){e.addStyles(o)}),this.emit("reset",{list:this.textTrack,isOpen:a})}},{key:"updateSubTitle",value:function(e){for(var t=this,n=-1,r=0;r<this.textTrack.length;r++)if(Qe(e,this.textTrack[r])){n=r;break}if(this._log("updateSubTitle",n,e),n>-1){var a=Qe(this.currentText,this.textTrack[n]);if(this._log("updateSubTitle","_isCurrent",a,"this.isOpen",this.isOpen,this.currentText),!a)return;var o=ir(e.url);this.isOpen?(o.forEach(function(c){t.textTrack[n].url.push(c)}),this._log("updateSubTitle _loadTrackUrls",this.textTrack[n]),this._loadTrackUrls(this.currentText,2)):this.textTrack[n].url=o}}},{key:"addStyles",value:function(e){var t=e.styles,n=e.format;t&&n==="vtt"&&(t.map(function(r){r.key||(r.key="xg-text-track-span")}),Wa(t,"xg-text-track"))}},{key:"attachPlayer",value:function(e){var t=this;if(this._log("attachPlayer"),!!e){this.player&&this.detachPlayer();var n=this.config,r=n.fontColor,a=n.mode,o=n.fitVideo,c=n.domRender;this.player=e,c&&(this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&jt(this.root,"text-track-hide"),!o&&jt(this.root,"text-track-no-fitvideo"),a&&jt(this.root,"text-track-".concat(a)),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),r&&(this.root.style.color=r),this.currentText&&["language","id","label"].map(function(h){t.root.setAttribute("data-".concat(h),t.currentText[h]||"")}),this.player.root.appendChild(this.root),qa(e.root,this._onResize)),this.player.on("destroy",this.destroy),this.player.on("timeupdate",this._onTimeupdate),this.player.on("pause",this._onPause),this.player.on("play",this._onPlay),this.player.on("core_event",this._onCoreEvents),this._isOpen&&this.switch().catch(function(h){t._log("[switch]",h)})}}},{key:"detachPlayer",value:function(){var e=this.player,t=this.config;e&&(e.off("destroy",this.destroy),e.off("timeupdate",this._onTimeupdate),e.off("pause",this._onPause),e.off("play",this._onPlay),e.off("core_event",this._onCoreEvents),t.domRender&&(e.root&&(Za(e.root,this._onResize),e.root.removeChild(this.root)),this.innerRoot=null,this.root=null),this.player=null)}},{key:"switch",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};return this._log("switch",t),this._loadingTrack=t,new Promise(function(n,r){if(!t.id&&!t.language)if(e.currentText){e._loadingTrack={},e._updateCurrent(e.currentText),e.switchOn();var a=Se(0,{message:"switch default subtitle success"});n(a);return}else{var o=Se(5,{message:"no default subtitle"});r(o);return}if(e.currentText&&Qe(t,e.currentText))e._loadingTrack={},e._updateCurrent(e.currentText),e.switchOn(),n(Se(0));else{var c=null;e.__removeByTime(e._curTexts,0);for(var h=0;h<e.textTrack.length;h++)if(Qe(t,e.textTrack[h])){c=e.textTrack[h];break}if(e._log("nextSubtitle",c),c)e._emitPlayerSwitch(e.currentText,c),c.list?(e._loadingTrack={},e._updateCurrent(c),e.switchOn(),n(Se(0))):(e._log("this._loadTrack",c),e._updateCurrent(c),e._loadTrack(c).then(function(y){if(e.addStyles(y),e._loadingTrack.id===c.id||e._loadingTrack.language===y.language)e._loadingTrack={},e._updateCurrent(y),e.switchOn(),n(Se(0));else{var m=Se(6,{message:"check _loadingTrack fail id: ".concat(e._loadingTrack.id,"  nextSubtitle:").concat(y.id)});r(m)}}).catch(function(y){r(y)}));else{var g=Se(4,new Error("The is no subtitle with id:[{".concat(t.id,"}] or language:[").concat(t.language,"]")));r(g)}}})}},{key:"switchExt",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};return new Promise(function(n,r){if(!t.id&&!t.language)e.currentExtText=null,n(Se(0));else{for(var a=null,o=0;o<e.textTrack.length;o++)if(Qe(t,e.textTrack[o])){a=e.textTrack[o];break}a&&!Qe(a,e.currentText)&&e._loadTrack(a).then(function(c){e.currentExtText=c,n(Se(0))})}})}},{key:"switchOn",value:function(){this._log("switchOn"),this._isOpen=!0,this.show(),this.emit(ki.CHANGE,this.currentText)}},{key:"switchOff",value:function(){this._isOpen=!1,this.hide(),this.emit(ki.OFF)}},{key:"isOpen",get:function(){return this._isOpen}},{key:"_log",value:function(){if(this.config.debugger){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,["[xgSubtitle]"].concat(n))}}},{key:"_loadTrack",value:function(e){var t=this;this._log("_loadTrack",e.language,e);var n=new Zi,r="",a="";if(e.json?(r="json",a=e.json):e.stringContent&&!e.url&&(r="string",a=e.stringContent),a)return Ir(a,r).then(function(h){e.format=h.format,e.styles=h.styles,e.list=h.list,n.resolve(e)}).catch(function(h){n.reject(h)}),n;var o=e.url;if(o.length===0)return n.resolve(e),n;var c=o.splice(0,1);return tr(c[0]).then(function(h){e.format=h.format,e.styles=h.styles,e.list||(e.list=[]),t._pushList(e.list,h.list),o.length>1&&t._loadTrackUrls(e,2),n.resolve(e)}).catch(function(h){n.reject(h)}),n}},{key:"_emitPlayerSwitch",value:function(e,t){e&&this.config.updateMode==="live"&&(e.list=[],e.url=[]);var n=ft({lang:t.language},t);this._log("emit subtile_switch ",t,n),this.player&&this.player.emit("switch_subtitle",n)}},{key:"_loadTrackUrls",value:function(e,t,n){var r=this,a=e.url.length,o=a>t?e.url.splice(0,t):e.url.splice(0,a),c=o.length;this._log("_loadTrackUrls",e.language,a,o.length,c),o.forEach(function(h,g){var y=ft(ft({},h),{},{index:g});tr(y).then(function(m){e.format=m.format,e.styles=m.format,e.list||(e.list=[]),r._pushList(e.list,m.list),c--}).catch(function(m){c--}).finally(function(m){c===0&&(n&&n.resolve(e),r._loadTrackUrls(e,2))})})}},{key:"_freshUrl",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{url:""},n=-1;e.url.forEach(function(r,a){r.url===t.url&&(n=a)}),n>-1&&e.url.splice(n,1)}},{key:"_pushList",value:function(e,t){var n=t[0].start,r=t[t.length-1].end;if(e.length===0||n>=e[e.length-1].end)t.forEach(function(c){e.push(c)});else{for(var a=-1,o=0;o<e.length;o++)if(e[o].start>r){a=o;break}a>-1&&t.forEach(function(c,h){e.splice(a+h,0,c)})}return e}},{key:"_updateCurrent",value:function(e){var t=this;this.currentText=e,this.config.domRender&&this.root&&(["language","id","label"].map(function(r){t.root.setAttribute("data-".concat(r),t.currentText[r]||"")}),this.__remove(this._cids)),this._cids=[],this._gid=-1,this._cid=-1,this._curTexts=[];var n=this._getPlayerCurrentTime();n&&(this.config.updateMode==="live"?this._liveUpdate(n):this._update(n))}},{key:"__loadAll",value:function(){var e=this;this.textTrack.forEach(function(t){e._loadTrack(t)})}},{key:"getDelCid",value:function(e,t){for(var n=[],r=0;r<e.length;r++)t.includes(e[r])||n.push(e[r]);return n}},{key:"getNewCid",value:function(e,t){for(var n=[],r=0;r<t.length;r++)e.includes(t[r])||n.push(t[r]);return n}},{key:"_liveUpdate",value:function(e){var t=this;if(!(!this.currentText||!this.currentText.list||!this.currentText.list.length)){var n=[],r=Jn(e,this.currentText.list,this._gid);if(r>-1&&(n=Qn(e,this.currentText.list[r].list,this._cid)),this.__removeByTime(this._curTexts,e),this._log("_liveUpdate",e,r,n,this.currentText.list[0].list[0].start,this.currentText.list[0].list[0].end),n.length>0){var a=Va(this.currentText.list,r,n),o=this._curTexts.length,c=o>0?this._curTexts[o-1].index:0;a.forEach(function(h,g){h.index=g+c,t._curTexts.push(h)}),this.__render(a)}this.emit("update",this._curTexts)}}},{key:"_update",value:function(e){var t=this;if(!(!this.currentText||!this.currentText.list||!this.currentText.list.length)){var n=Jn(e,this.currentText.list,this._gid),r=[];if(n>-1&&(r=Qn(e,this.currentText.list[n].list,this._cid)),r.length<1){this._cids.length>0&&this.config.domRender&&this.__remove(this._cids),this._cids=[];return}if(!(this._cids===r&&n===this._gid)){this._gid=n,this._cid=r[0];var a=this.getDelCid(this._cids,r),o=this.getNewCid(this._cids,r);this._cids=r,this.config.domRender&&this.__remove(a);var c=[];o.map(function(h){var g=t.currentText.list[n].list[h];g.index=h,c.push(g)}),this.currentExtText&&o.map(function(h){var g=t.currentText.list[n].list[h];g.index=h,c.push(g)}),this._log("update",c,e),this.emit("update",c),this.__render(c,e)}}}},{key:"_getPlayerCurrentTime",value:function(){if(!this.player)return 0;var e=this.player.currentTime,t=parseInt(e*1e3+this.seiTime*1e3-this.lastSeiTime*1e3,10)/1e3;return t}},{key:"_onSubtitlePlaylist",value:function(e){this._log("_onSubtitlePlaylist",e);var t=e.map(function(n){return{label:n.name,language:n.lang,id:n.id,isDefault:n.default,url:[],mUrl:n.url}});this.setSubTitles(t)}},{key:"_onSubtitleSegment",value:function(e){if(this._log("_onSubtitleSegment",e.length,e[0].lang,e[0].sn,e[e.length-1].sn,e[0].start,e[e.length-1].end),!(!e||e.length===0)){var t=e[0].lang,n=e.map(function(a){return{id:a.sn,url:a.url,duration:a.duration,start:a.start,end:a.end}}),r={language:t,url:n};Qe(r,this.currentText)&&this.updateSubTitle(r)}}},{key:"_onCoreSeiintime",value:function(e){try{var t=e.time/1e3;this._log("_onCoreSeiintime sei",t,this.seiTime,this.lastSeiTime),this.seiTime=t,this.lastSeiTime=this.player?this.player.currentTime:0}catch{}}},{key:"resize",value:function(e,t){var n=this,r=this.config,a=r.baseSizeX,o=r.baseSizeY,c=r.minMobileSize,h=r.minSize,g=r.fitVideo,y=r.offsetBottom,m=this._videoMeta.scale;this._videoMeta.lwidth=e,this._videoMeta.lheight=t;var _,C=0;t/e*100>=m?(C=parseInt(m*e,10)/100,_=e):(C=t,_=parseInt(t/m*100,10)),this._videoMeta.vWidth=_,this._videoMeta.vHeight=C;var D=0,A=0;m>120?(D=o,A=parseInt(D*C/1080,10)):(D=a,A=parseInt(D*_/1920,10));var O=nr?c:h;A=A<O?O:A>D?D:A;var H={fontSize:A},K=parseInt((t-C)/2,10),Y=parseInt((e-_)/2,10),V=parseInt(C*y,10)/100;this._videoMeta.vBottom=K,this._videoMeta.vLeft=Y,this._videoMeta.marginBottom=V,g&&(H.bottom=K+V,H.left=H.right=Y),Object.keys(H).map(function(Q){n.root.style[Q]="".concat(H[Q],"px")}),this.emit(ki.RESIZE,{vLeft:Y,vBottom:K,marginBottom:V,vWidth:_,vHeight:C,fontSize:A,scale:m})}},{key:"__startResize",value:function(e){var t=this,n=e.getBoundingClientRect(),r=this._videoMeta,a=n.width,o=n.height;if(this._iId&&(clearTimeout(this._iId),this._iId=null),a>0&&o>0&&(a!==r.lwidth||o!==r.lheight))this._iC=0,this.resize(a,o);else{if(this._iC>=5){this._iC=0;return}this._iC++,this._iId=setTimeout(function(){t.__startResize(e)},50)}}},{key:"__removeByTime",value:function(e,t){for(var n=[],r=0;r<e.length;r++)(!t||e[r].end<t)&&n.push(r);n.length!==0&&(e.splice(n[0],n.length),this.config.domRender&&this.__remove(n))}},{key:"__remove",value:function(e){var t=this;if(!(!e||e.length<1)){this._log(">>>>_renderByWords__remove",e);for(var n=this.innerRoot.children,r=[],a=0;a<n.length;a++){var o=Number(n[a].getAttribute("data-index"));e.includes(o)&&r.push(n[a])}r.map(function(c){t.innerRoot.removeChild(c)})}}},{key:"__render",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this._log("__render",t.length,this.config.domRender);var n=this.config,r=n.renderMode,a=n.domRender;t.length>0&&a&&t.forEach(function(o){var c="text-track-".concat(e.config.line);o.text.forEach(function(h,g){g>0&&(c+=" text-track-deputy");var y={"data-start":o.start,"data-end":o.end,"data-index":o.index},m=er("xg-text-track-span","",y,c);if(e.innerRoot.appendChild(m),r==="step"){var _=er("xg-text-track-span","",y,"".concat(c," text-track-space"));e.innerRoot.appendChild(_),_.innerHTML=h,setTimeout(function(){e._renderByWords(m,g,o.start,o.end,h)},600)}else m.innerHTML=h})})}},{key:"_renderByWords",value:function(e,t,n,r,a){var o=document.createTextNode("");e.appendChild(o);var c=Xa(a),h=this._getPlayerCurrentTime(),g=parseInt((r-h)*1e3,10);if(!(h>=r)){n>=h&&(h=n),g>300&&(g-=50);var y=c.length,m={dom:o,ids:t,wordList:c,interval:g/y,start:h,end:r,duration:g,lastTime:0};this._log(">>>>_renderByWords",g,m);for(var _=this._curRenderTask,C=-1,D=0;D<_.length;D++)if(_[D].ids===t){C=D;break}C>-1&&_.slice(C,1),_.push(m),this.startRender(-1)}}},{key:"stopRender",value:function(){this._renderIntervalId&&window.cancelAnimationFrame(this._renderIntervalId)}},{key:"show",value:function(){this.config.domRender&&ja(this.root,"text-track-hide")}},{key:"hide",value:function(){this.config.domRender&&(jt(this.root,"text-track-hide"),this.innerRoot.innerHTML="")}},{key:"emit",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=Ge(Ie(s.prototype),"emit",this)).call.apply(n,[this,e,t].concat(a))}},{key:"on",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=Ge(Ie(s.prototype),"on",this)).call.apply(n,[this,e,t].concat(a))}},{key:"once",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=Ge(Ie(s.prototype),"once",this)).call.apply(n,[this,e,t].concat(a))}},{key:"off",value:function(e,t){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=Ge(Ie(s.prototype),"off",this)).call.apply(n,[this,e,t].concat(a))}},{key:"offAll",value:function(){Ge(Ie(s.prototype),"removeAllListeners",this).call(this)}},{key:"marginBottom",get:function(){var e=this._videoMeta,t=e.bottom,n=e.marginBottom;return this.config.fitVideo?t+n:n}}]),s}(Gt),Qa=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this),b(T(e),"_onChange",function(t){var n=e._media.textTracks;if(!(!n||n.length===0)){for(var r=[],a=[],o=-1,c=0;c<n.length;c++){var h=n[c];h.kind==="subtitles"&&(r.push({id:h.id||h.language,language:h.language,text:h.label,isDefault:h.mode==="showing"}),o===-1&&h.mode==="showing"&&(o=c),a.push(h.language))}a.join("|")!==e._languages?(e._languages=a.join("|"),e.emit("reset",{list:r,isOpen:o>-1})):o===-1?e.emit("off"):e.curIndex!==o&&e.emit("change",r[o]),e.curIndex=o}}),e._media=i,e._list=[],e._languages="",e.curIndex=-1,e._init(),e}return N(s,[{key:"_init",value:function(){var e=this._media.textTracks;e.addEventListener("change",this._onChange)}},{key:"switch",value:function(e){for(var t=this._media.textTracks,n=0;n<t.length;n++){var r=t[n];r.language===e.language?r.mode="showing":r.mode==="showing"&&(r.mode="disabled")}}},{key:"switchOff",value:function(){for(var e=this._media.textTracks,t=0;t<e.length;t++)e[t].mode="disabled";this.curIndex=-1}},{key:"destroy",value:function(){var e=this._media.textTracks;e.removeEventListener("change",this._onChange),this._media=null,this._list=[],this._languages="",this.curIndex=-1}}]),s}(Gt),bi={CLOSE:"close",OPEN:"open",TEXT_CLOSE:"text-close"};function rr(l){var u=-1;return l.forEach(function(s,i){!s.id&&!s.language&&(s.id=i),s.id=String(s.id),!s.url&&(s.url=s.src),!s.text&&(s.text=s.label),!s.language&&(s.language=s.srclang),s.isDefault===void 0&&(s.isDefault=s.default||!1),(s.isDefault||s.default)&&(u<0?u=i:s.isDefault=s.default=!1)}),u}function eo(l,u){var s=p.isNotNull(l.id)&&p.isNotNull(u.id)&&l.id===u.id,i=p.isNotNull(l.language)&&p.isNotNull(u.language)&&l.language===u.language;return s||i}var _o=function(l){U(s,l);var u=j(s);function s(){var i;F(this,s);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=u.call.apply(u,[this].concat(t)),b(T(i),"_onOff",function(){i.switchOffSubtitle()}),b(T(i),"_onChange",function(r){var a=i.getSubTitleIndex(i.config.list,r);a<0||i.updateCurItem(a,r)}),b(T(i),"_onListReset",function(r){i.updateList(r)}),b(T(i),"clickSwitch",function(r,a){var o=a.type===bi.CLOSE||a.type===bi.TEXT_CLOSE;i.subTitles&&(o?i.subTitles.switchOff():i.switchSubTitle({language:a.language,id:a.id}))}),b(T(i),"onIconClick",function(r){i.curItem?i.subTitles.switchOff():i.switchOnSubtitle(r)}),b(T(i),"onPlayerFocus",function(r){!i.subTitles||!i.config.style.follow||i.rePosition()}),b(T(i),"onPlayerBlur",function(r){!i.subTitles||!i.config.style.follow||i.playerConfig.marginControls||i.subTitles.root&&(i.subTitles.root.style.transform="translate(0, 0)")}),i}return N(s,[{key:"beforeCreate",value:function(e){var t=e.player.config.texttrack||e.player.config.textTrack;p.typeOf(t)==="Array"&&(e.config.list=t)}},{key:"afterCreate",value:function(){var e=this.config,t=e.list,n=e.mode,r=rr(t);W(G(s.prototype),"afterCreate",this).call(this),this.curIndex=-1,this.lastIndex=-1,this.curItem=null,this._nativeTracks=null,this.handlerClickSwitch=this.hook("subtitle_change",this.clickSwitch),n==="native"?this._initNativeSubtitle():this._initExtSubTitle(r)}},{key:"_initNativeSubtitle",value:function(){var e=this.player;e._subTitles||(e._subTitles=new Qa(e.media)),this.subTitles=e._subTitles,this.subTitles.on("off",this._onOff),this.subTitles.on("change",this._onChange),this.subTitles.on("reset",this._onListReset)}},{key:"_initExtSubTitle",value:function(e){var t=this.config,n=t.list,r=t.style,a=t.isDefaultOpen,o=t.updateMode,c=t.renderMode;a&&e<0&&n.length>0&&(e=0,n[0].isDefault=!0);var h={subTitles:n,defaultOpen:a,updateMode:o,renderMode:c,debugger:this.config.debugger};Object.keys(r).map(function(m){h[m]=r[m]});var g=!this.playerConfig.marginControls&&this.player.controls.root;g&&(this.on(Ni,this.onPlayerFocus),this.on(cr,this.onPlayerBlur));var y=this.player;y._subTitles?y._subTitles._isOpen&&(e=this.getSubTitleIndex(this.config.list,y._subTitles.currentText)):(y._subTitles=new Ja(h),y._subTitles.attachPlayer(this.player)),this.subTitles=y._subTitles,this.subTitles.on("off",this._onOff),this.subTitles.on("change",this._onChange),this.subTitles.on("reset",this._onListReset),r.follow&&this.subTitles.root&&p.addClass(this.subTitles.root,"follow-control"),this._renderList(n,a,e)}},{key:"_renderList",value:function(e,t,n){!e||e.length===0||(t?(n=n<0?0:n,e[n].isDefault=!0,this.curIndex=n,this.curItem=e[n],this.switchIconState(!0)):this.switchIconState(!1),this.player.isCanplay&&e.length>0&&(this.renderItemList(e),this.show()))}},{key:"registerIcons",value:function(){return{textTrackOpen:{icon:"",class:"xg-texttrak-open"},textTrackClose:{icon:"",class:"xg-texttrak-close"}}}},{key:"show",value:function(e){!this.config.list||this.config.list.length<1||p.addClass(this.root,"show")}},{key:"getSubTitleIndex",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"",language:""},n=-1;return!t||!t.id&&!t.language||e.forEach(function(r,a){eo(r,t)&&(n=a)}),n}},{key:"updateSubtitles",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e&&(this.updateList({list:e}),this.subTitles&&this.subTitles.setSubTitles(this.config.list,this.curIndex>-1,t))}},{key:"updateList",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(e.list){var t=[];e.list.forEach(function(r){t.push(r)});var n=rr(t);e.isOpen?(this.curIndex=n,this.curItem=n>-1?t[n]:null):(this.curIndex=-1,this.curItem=null),this.config.list=t,t.length>0?this.show():(this.switchOffSubtitle(),this.hide()),this.renderItemList()}}},{key:"switchSubTitle",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};this.switchIconState(!0);var t=this.getSubTitleIndex(this.config.list,e);t<0||this.subTitles.switch(e).catch(function(n){})}},{key:"switchOffSubtitle",value:function(e){this.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]}),this.lastIndex=this.curIndex,this.curIndex=-1,this.curItem=null,this.switchIconState(!1),this.renderItemList()}},{key:"switchOnSubtitle",value:function(){var e=this.config.list,t=this.lastIndex>-1?this.lastIndex:0,n=e[t];this.switchIconState(!0),this.switchSubTitle(n)}},{key:"switchIconState",value:function(e){this.setAttr("data-state",e?"open":"close")}},{key:"onItemClick",value:function(e,t){var n=e.delegateTarget,r=n.getAttribute("language"),a=n.getAttribute("data-id"),o=n.getAttribute("data-type");W(G(s.prototype),"onItemClick",this).apply(this,arguments),this.handlerClickSwitch(e,{language:r,id:a,type:o})}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config,t=e.list,n=e.closeText,r=this.curIndex;if(r-1<0)this.find(".icon-text").innerHTML=this.getTextByLang(n,"iconText");else if(r-1<t.length){var a=t[r-1];if(!a)return;this.find(".icon-text").innerHTML=this.getTextByLang(a,"iconText")}}}},{key:"updateCurItem",value:function(e,t){this.curIndex=e,this.curItem=this.config.list[e-1],this.renderItemList(),this.emit("subtitle_change",se({off:!1,isListUpdate:!1,list:[]},t))}},{key:"renderItemList",value:function(){var e=this,t=this.config,n=t.list,r=t.closeText,a=t.needCloseText,o=[],c=this.curIndex,h=this.curIndex;a&&(o.push({showText:this.getTextByLang(r),"data-type":bi.TEXT_CLOSE,selected:this.curIndex===-1}),c++),n.map(function(g,y){var m={language:g.language||g.srclang||"","data-id":g.id||""};m.selected=e.curIndex===y,m.showText=e.getTextByLang(g),o.push(m)}),W(G(s.prototype),"renderItemList",this).call(this,o,c),this.curIndex=h,this.curItem=n[h]}},{key:"rePosition",value:function(){var e=this.config.style.fitVideo,t=this.player.controls.root.getBoundingClientRect(),n=0-t.height;if(!e){this.subTitles.root.style.transform="translate(0, ".concat(n,"px)");return}var r=this.player,a=r.video,o=r.root,c=o.getBoundingClientRect(),h=c.height,g=c.width,y=a.videoHeight,m=a.videoWidth,_=parseInt(y/m*100,10),C=_*g/100;C>h&&(C=h);var D=(h-C)/2-n;D<0&&(this.subTitles.root.style.transform="translate(0, ".concat(D,"px)"))}},{key:"destroy",value:function(){this.subTitles&&(this.subTitles.destroy(),this.subTitles=null),W(G(s.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"texttrack"}},{key:"defaultConfig",get:function(){return se(se({},pt.defaultConfig),{},{position:te.CONTROLS_RIGHT,index:6,list:[],isDefaultOpen:!0,style:{follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},closeText:{text:"",iconText:""},needCloseText:!0,className:"xgplayer-texttrack",hidePortrait:!1,isShowIcon:!0,renderMode:"normal",mode:"external",debugger:!1})}}]),s}(pt),Co=function(l){U(s,l);var u=j(s);function s(i){var e;return F(this,s),e=u.call(this,i),e.canvasHeight=0,e.canvasWidth=0,e.width=0,e.height=0,e.dataFloatLen=2,e.xData=[],e.yData=[],e.yMax=0,e._duration=0,e.curData=[],e}return N(s,[{key:"afterPlayerInit",value:function(){this.root||(this.createRoot(),this.reset())}},{key:"afterCreate",value:function(){var e=this;this.on(Le,function(){e.resize()}),this.on(Fe,function(){e._duration=e.player.duration,e.reset()})}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(n){t.config[n]=e[n]}),this.reset()}},{key:"reset",value:function(){var e=this.config.data;this.setData(e),this.resize()}},{key:"createRoot",value:function(){if(!this.root){var e=this.config.mode,t=this.player.plugins.progress,n=t.root,r=e==="activeShow"?"xg-heatmap-active-show":"xg-heatmap-normal",a=p.createDom("div","",{},"xg-heatmap ".concat(r)),o=n.children.length>0?n.children[0]:null;n.insertBefore(a,o),this.root=a;var c=p.createDom("canvas","",{},"xg-heatmap-canvas");this.root.appendChild(c),this.root.style.height="".concat(this.config.height,"px"),this.canvas=c}}},{key:"resize",value:function(){var e=this.config.dpi,t=this.root.getBoundingClientRect(),n=t.width,r=t.height;n===this.width&&r*e===this.height||(this.width=n,this.height=r,this.canvas.width=this.canvasWidth=n*e,this.canvas.height=this.canvasHeight=r*e,this.yMax=0,this.curData.length&&(this.setData(),this.drawLinePath()))}},{key:"formatData",value:function(e,t,n){var r=[];if(e.length<1)return r;var a=parseInt(t*1e3,10);if(p.typeOf(e[0])==="Object"&&e[0].time!==void 0){if(!a)return r;var o=1,c=0;e.forEach(function(m){var _=parseInt(m.time*1e3,10);c&&(o<0||m.time-c<o)&&(o=m.time-c),c=m.time,r.push(se(se({},m),{},{percent:_/a}))});var h=r[0].time;if(h>0){var g=h-o>0?[h-o,0]:[0];g.forEach(function(m){var _=parseInt(m*1e3,10);r.unshift({time:m,score:n,percent:_/a})})}var y=r[r.length-1];t-y.time>o&&[y.time+o,t].forEach(function(m){var _=parseInt(m*1e3,10);r.push({time:m,score:n,percent:_/a})})}else e.forEach(function(m){r.push(m)});return r}},{key:"_getX",value:function(e,t,n,r){return n.percent!==void 0?this.fixFloat(r*n.percent,this.dataFloatLen):this.fixFloat((e-1)*t,this.dataFloatLen)}},{key:"_getY",value:function(e,t,n){var r=this.config,a=r.maxValue,o=r.minValue,c=o;return c=e.score!==void 0?e.score:e,c=Math.min(c,a),c=Math.max(c,o),c=c/t,c=1-c,c=this.fixFloat(c*n,this.dataFloatLen),c}},{key:"setData",value:function(e){var t=this.config,n=t.maxValue,r=t.minValue,a=t.maxLength;if(e&&e.length&&(this.curData=this.formatData(e,this._duration,r)),e=this.curData,!(e.length<1)){this.xData=[],this.yData=[],this.yMax=0;var o=n,c=r,h=o-c,g=this.canvasHeight,y=e.length,m=y>a?this.fixFloat(y/a,this.dataFloatLen):1;y=parseInt(y/m);var _=this.canvasWidth/(y-1);if(_=this.fixFloat(_,this.dataFloatLen),!Number.isNaN(_))for(var C=parseInt(this.fixFloat(m-1,0)),D=0;D<y;){var A=this._getX(D,_,e[C],this.canvasWidth);this.xData.push(A);var O=this._getY(e[C],h,g);this.yMax=Math.max(this.yMax,g-O),this.yData.push(O),D++,C=parseInt(this.fixFloat(D*m,0))}}}},{key:"_getFillStyle",value:function(e){var t=this.config,n=t.gradient,r=t.gradientColors,a=t.fillStyle,o=a;if(n&&n.length===4){var c=e.createLinearGradient(n[0],n[1],n[2],n[3]);r.length<2?console.warn(this.pluginName,"gradientColors"):(r.forEach(function(h){c.addColorStop(h.start,h.color)}),o=c)}return o}},{key:"drawLinePath",value:function(){this.clearCanvas();var e=this.canvas.getContext("2d"),t=this.xData,n=this.yData,r,a,o=0,c=this.config,h=c.lineWidth,g=c.alpha,y=c.strokeStyle,m=this._getFillStyle(e);for(e.beginPath(),e.lineWidth=h,e.globalAlpha=g,e.strokeStyle=y||m,e.fillStyle=m,e.moveTo(0,this.canvasHeight),r=t[o],a=n[o];r!==void 0&&a!==void 0;)e.lineTo(r,a),o++,r=t[o],a=n[o];e.lineTo(this.canvasWidth,this.canvasHeight),e.closePath(),e.stroke(),e.fill()}},{key:"clearCanvas",value:function(){this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight}},{key:"fixFloat",value:function(e,t){return typeof e=="number"?parseFloat(e.toFixed(t)):NaN}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"heatmap"}},{key:"defaultConfig",get:function(){return{lineWidth:0,dpi:2,alpha:.7,gradient:[],gradientColors:[],strokeStyle:"",fillColor:"#FA1F41",height:20,data:[],maxValue:100,minValue:0,maxLength:400,mode:"activeShow"}}}]),s}(q);export{Xe as BasePlugin,dt as CssFullscreenIcon,Eo as Danmu,Un as DanmuIcon,Mn as DanmuPanel,xa as DefaultPreset,io as DefaultPresetEn,zt as Errors,ys as Events,At as FullscreenIcon,Co as HeatMap,ct as I18N,gr as InstManager,no as LivePreset,ei as Loading,ro as MobilePreset,xt as PlayIcon,q as Plugin,$t as Progress,Z as STATES,w as STATE_CLASS,Xt as SimplePlayer,X as Sniffer,Zt as Start,_o as TextTrack,Dt as TimeIcon,p as Util,It as VolumeIcon,de as default,oo as langBr,uo as langDe,Us as langEn,lo as langEs,co as langFr,ho as langId,fo as langIt,ao as langJp,go as langKr,po as langMsMy,vo as langRu,mo as langTh,yo as langVn,$i as langZhCn,so as langZhHk};
